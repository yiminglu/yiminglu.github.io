<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Comparisons | Yiming @ SeasonsRoad</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="We’ve gone over conditionals, but if statements aren’t very useful if we can’t compare things.  Of course Vim lets us compare values, but it’s not as straightforward as it may seem.
Run the following">
<meta property="og:type" content="website">
<meta property="og:title" content="Comparisons">
<meta property="og:url" content="http://yiminglu.github.io/LearnVimScriptTheHardWay/22.html">
<meta property="og:site_name" content="Yiming @ SeasonsRoad">
<meta property="og:description" content="We’ve gone over conditionals, but if statements aren’t very useful if we can’t compare things.  Of course Vim lets us compare values, but it’s not as straightforward as it may seem.
Run the following">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Comparisons">
<meta name="twitter:description" content="We’ve gone over conditionals, but if statements aren’t very useful if we can’t compare things.  Of course Vim lets us compare values, but it’s not as straightforward as it may seem.
Run the following">
  
    <link rel="alternative" href="/atom.xml" title="Yiming @ SeasonsRoad" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  

</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-nav" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Good Morning!</a>
      </h1>
      <nav id="main-nav">
        <ul class="mod-head__ul">
        
          <li class="main-nav-link"><a href="/">Home</a></li>
        
          <li class="main-nav-link"><a href="/links.html">Links</a></li>
        
          <li class="main-nav-link"><a href="https://github.com/yiminglu">Github</a></li>
        
          <li class="main-nav-link"><a href="/about.html">About</a></li>
        
        </ul>
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
      </nav>
    </div>
  </div>
</header>
      <div class="inner">
        <section id="main"><article id="page-undefined" class="article article-type-page" itemscope itemprop="blogPost">
  
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      <a href="/LearnVimScriptTheHardWay/22.html">
        Comparisons
      </a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>We’ve gone over conditionals, but <code>if</code> statements aren’t very useful if we can’t compare things.  Of course Vim lets us compare values, but it’s not as straightforward as it may seem.</p>
<p>Run the following commands:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">:if 10 &gt; 1</span><br><span class="line"></span><br><span class="line">:    echom "foo"</span><br><span class="line"></span><br><span class="line">:endif</span><br></pre></td></tr></table></figure>
<p>Vim will, of course, display <code>foo</code>.  Now run these commands:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">:if 10 &gt; 2001</span><br><span class="line"></span><br><span class="line">:    echom "bar"</span><br><span class="line"></span><br><span class="line">:endif</span><br></pre></td></tr></table></figure>
<p>Vim displays nothing, because <code>10</code> is not greater than <code>2001</code>.  So far everything works as expected.  Run these commands:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">:if 10 == 11</span><br><span class="line"></span><br><span class="line">:    echom "first"</span><br><span class="line"></span><br><span class="line">:elseif 10 == 10</span><br><span class="line"></span><br><span class="line">:    echom "second"</span><br><span class="line"></span><br><span class="line">:endif</span><br></pre></td></tr></table></figure>
<p>Vim displays <code>second</code>.  Nothing surprising here.  Let’s try comparing strings. Run these commands:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">:if "foo" == "bar"</span><br><span class="line"></span><br><span class="line">:    echom "one"</span><br><span class="line"></span><br><span class="line">:elseif "foo" == "foo"</span><br><span class="line"></span><br><span class="line">:    echom "two"</span><br><span class="line"></span><br><span class="line">:endif</span><br></pre></td></tr></table></figure>
<p>Vim echoes <code>two</code>.  There’s still nothing surprising, so what was I going on about at the beginning of the chapter?</p>
<h2 id="Case_Sensitivity">Case Sensitivity</h2><p>Run the following commands:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">:set noignorecase</span><br><span class="line"></span><br><span class="line">:if "foo" == "FOO"</span><br><span class="line"></span><br><span class="line">:    echom "vim is case insensitive"</span><br><span class="line"></span><br><span class="line">:elseif "foo" == "foo"</span><br><span class="line"></span><br><span class="line">:    echom "vim is case sensitive"</span><br><span class="line"></span><br><span class="line">:endif</span><br></pre></td></tr></table></figure>
<p>Vim evaluates the <code>elseif</code>, so apparently Vimscript is case sensitive.  Good to know, but nothing earth-shattering.  Now run these commands:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">:set ignorecase</span><br><span class="line"></span><br><span class="line">:if "foo" == "FOO"</span><br><span class="line"></span><br><span class="line">:    echom "no, it couldn't be"</span><br><span class="line"></span><br><span class="line">:elseif "foo" == "foo"</span><br><span class="line"></span><br><span class="line">:    echom "this must be the one"</span><br><span class="line"></span><br><span class="line">:endif</span><br></pre></td></tr></table></figure>
<p><strong>Whoa</strong>.  Stop right there.  Yes, you saw that right.</p>
<p><strong>The behavior of <code>==</code> depends on a user’s settings.</strong></p>
<p>I promise I’m not messing with you.  Try it again and see.  I’m not kidding, I can’t make this stuff up.</p>
<h2 id="Code_Defensively">Code Defensively</h2><p>What does this mean?  It means that you can <em>never</em> trust the <code>==</code> comparison when writing a plugin for other people to use.  A bare <code>==</code> should <em>never</em> appear in your plugins’ code.</p>
<p>This idea is the same as the “<code>nmap</code> versus <code>nnoremap</code>“ one.  <em>Never</em> trust your users’ settings.  Vim is old, vast, and complicated.  When writing a plugin you <em>have</em> to assume that users will have every variation of every setting.</p>
<p>So how can you get around this ridiculousness?  It turns out that Vim has <em>two extra sets</em> of comparison operators to deal with this.</p>
<p>Run the following commands:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">:set noignorecase</span><br><span class="line"></span><br><span class="line">:if "foo" ==? "FOO"</span><br><span class="line"></span><br><span class="line">:    echom "first"</span><br><span class="line"></span><br><span class="line">:elseif "foo" ==? "foo"</span><br><span class="line"></span><br><span class="line">:    echom "second"</span><br><span class="line"></span><br><span class="line">:endif</span><br></pre></td></tr></table></figure>
<p>Vim displays <code>first</code> because <code>==?</code> is the “case-insensitive no matter what the user has set” comparison operator.  Now run the following commands:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">:set ignorecase</span><br><span class="line"></span><br><span class="line">:if "foo" ==# "FOO"</span><br><span class="line"></span><br><span class="line">:    echom "one"</span><br><span class="line"></span><br><span class="line">:elseif "foo" ==# "foo"</span><br><span class="line"></span><br><span class="line">:    echom "two"</span><br><span class="line"></span><br><span class="line">:endif</span><br></pre></td></tr></table></figure>
<p>Vim displays <code>two</code> because <code>==#</code> is the “case-sensitive no matter what the user has set” comparison operator.</p>
<p>The moral of this story is that you should <em>always</em> use explicit case sensitive or insensitive comparisons.  Using the normal forms is <em>wrong</em> and it <em>will</em> break at some point.  Save yourself the trouble and type the extra character.</p>
<p>When you’re comparing integers this distinction obviously doesn’t matter. Still, I feel that it’s better to use the case-sensitive comparisons everywhere (even where they’re not strictly needed), than to forget them in a place that they <em>are</em> needed.</p>
<p>Using <code>==#</code> and <code>==?</code> with integers will work just fine, and if you change them to strings in the future it will work correctly.  If you’d rather use <code>==</code> for integers that’s fine, just remember that you’ll need to change the comparison if you change them to strings in the future.</p>
<h2 id="Exercises">Exercises</h2><p>Play around with <code>:set ignorecase</code> and <code>:set noignorecase</code> and see how various comparisons act.</p>
<p>Read <code>:help ignorecase</code> to see why someone might set that option.</p>
<p>Read <code>:help expr4</code> to see all the available comparison operators.</p>
<p><a href="21.html">« Previous</a><a style="float:right" href="23.html">Next »</a></p>

      
    </div>
    
  </div>
  
</article>


</section>
      </div>
      <footer id="footer">
  
  <div class="outer">
	<div id="footer-info" class="inner">
	&copy; 2016 Yiming LU<br>
	Hosted on <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>.
	Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>.
	</div>
  </div>
</footer>
    </div>
    
<script>
  var disqus_shortname = 'ymlu';
  
  var disqus_url = 'http://yiminglu.github.io/LearnVimScriptTheHardWay/22.html';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

  </div>
</body>
</html>
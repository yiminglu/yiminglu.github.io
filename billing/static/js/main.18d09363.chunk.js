(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1005:function(e,t,a){},1055:function(e,t,a){},1401:function(e,t,a){},1402:function(e,t,a){},1403:function(e,t,a){},1404:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a.n(s),c=a(47),l=a.n(c),r=(a(487),a(123),a(38)),o=(a(489),a(13)),i=a.n(o),m=a(455);const d="yiming";const{Provider:u,useContainer:p}=Object(m.a)(function(){const[e,t]=Object(s.useState)({success:!1,isAdmin:!1});return{loginState:e,loginSuccess:e=>t({success:!0,userName:e,isAdmin:e===d})}});var g=a(9);const E=[{type:"Ming",categories:["\u6708\u5de5\u8d44","\u5e74\u7ec8\u5956","\u80a1\u6743\u6fc0\u52b1","\u533b\u4fdd\u5b58\u6298","\u4f4f\u623f\u516c\u79ef\u91d1","\u5de5\u4f5c\u9910\u8865","\u5176\u4ed6\u85aa\u8d44"]},{type:"Hehe",categories:["\u6708\u5de5\u8d44","\u5e74\u7ec8\u5956","\u5e74\u4e2d\u5956","\u5b63\u5ea6\u5956","\u5e74\u5047\u5956\u91d1","\u533b\u4fdd\u5b58\u6298","\u4f4f\u623f\u516c\u79ef\u91d1","\u589e\u53d1\u7ee9\u6548\u5956","\u62a5\u9500\u4ea4\u901a\u8d39","\u62a5\u9500\u798f\u5229\u8d39","\u62a5\u9500\u901a\u4fe1\u8d39","\u5de5\u4f5c\u9910\u8865","\u7ffc\u652f\u4ed8\u9910\u8d39","\u9632\u6691\u964d\u6e29\u8d39","\u62a5\u9500\u7269\u4e1a\u8d39","\u62a5\u9500\u53d6\u6696\u8d39","\u8282\u5047\u65e5\u8865\u52a9","\u751f\u80b2\u6d25\u8d34","\u5176\u4ed6\u85aa\u8d44"]},{type:"Invest",categories:["\u8d27\u5e01\u57fa\u91d1","\u6307\u6570\u57fa\u91d1","\u51fa\u501f\u5229\u606f","\u6570\u5b57\u8d27\u5e01","\u80a1\u7968","P2P"]},{type:"Others",categories:["\u8f6c\u5356\u4e8c\u624b","ME\u7238\u5988","ME\u4eb2\u53cb","HJ\u7238\u5988","HJ\u4eb2\u53cb","\u6d3b\u52a8\u8fd4\u73b0","\u5176\u4ed6\u6536\u5165"]}],h=["Exclude","Special","Qinghuan","Gift"],y={},b=Object(g.map)(E,e=>(y[e.type]=e.categories,e.type)),O=b[0],N=[{type:"\u9910\u996e",categories:["\u5916\u51fa\u996e\u98df","\u95e8\u5e97\u5feb\u9910","\u96f6\u98df\u996e\u6599","\u679c\u852c\u98df\u6750","\u70df\u9152\u8336","\u9910\u996e\u5176\u4ed6"]},{type:"\u4ea4\u901a",categories:["\u6253\u8f66","\u516c\u5171\u4ea4\u901a","\u8f66\u65c5\u8d39\u7528","\u81ea\u9a7e\u52a0\u6cb9","\u81ea\u9a7e\u9ad8\u901f\u8d39","\u81ea\u9a7e\u505c\u8f66","\u81ea\u9a7e\u6d17\u8f66","\u8fdd\u7ae0\u7f5a\u6b3e","\u6c7d\u8f66\u4fdd\u517b","\u6c7d\u8f66\u4fdd\u9669","\u6c7d\u8f66\u7ef4\u4fee","\u6c7d\u8f66\u914d\u4ef6","\u4ea4\u901a\u5176\u4ed6"]},{type:"\u6e05\u6b22",categories:["\u5a03\u513f\u996e\u98df","\u5a03\u513f\u73a9\u5177","\u5a03\u513f\u56fe\u4e66","\u5a03\u513f\u6587\u5177","\u5a03\u513f\u978b\u670d","\u5a03\u513f\u914d\u9970","\u5a03\u513f\u6e38\u4e50\u573a","\u5a03\u513f\u7528\u54c1","\u5a03\u513f\u5b55\u671f","\u5a03\u513f\u5b66\u6742\u8d39","\u5a03\u513f\u5174\u8da3\u73ed","\u5a03\u513f\u8f85\u5bfc\u73ed","\u5a03\u513f\u533b\u836f","\u5a03\u513f\u4fdd\u9669","\u5a03\u513f\u7167\u770b","\u5a03\u513f\u6587\u5a31","\u5a03\u513f\u4f53\u80b2","\u5a03\u513f\u96f6\u82b1\u94b1","\u5a03\u513f\u5176\u4ed6"]},{type:"\u4eb2\u53cb",categories:["\u5bb6\u4eba\u652f\u51fa","\u53cb\u4eba\u652f\u51fa","\u4eb2\u53cb\u793c\u94b1","\u4eba\u60c5\u5f80\u6765"]},{type:"\u65e5\u5e38",categories:["\u533b\u7597\u836f\u7269","\u4fdd\u5065\u6309\u6469","\u624b\u673a\u8bdd\u8d39","\u8fd0\u52a8\u5065\u8eab","\u7f8e\u5bb9\u7f8e\u53d1","\u515a\u8d39","\u5de5\u4f5c\u6742\u8d39","\u4fe1\u7528\u5361\u76f8\u5173","\u4fdd\u9669\u8d39\u7528","\u65e5\u5e38\u5176\u4ed6"]},{type:"\u4f4f\u5bbf",categories:["\u6c34\u8d39","\u7535\u8d39","\u71c3\u6c14\u8d39","\u7269\u4e1a\u8d39","\u5bb6\u7535\u5bb6\u5177","\u7f51\u8d39","\u6709\u7ebf\u7535\u89c6\u8d39","\u5bb6\u88c5\u914d\u9970","\u5bb6\u5c45\u7528\u54c1","\u5bb6\u653f\u670d\u52a1","\u623f\u79df","\u4f4f\u5bbf\u5176\u4ed6"]},{type:"\u501f\u8d37",categories:["\u6d66\u53d1\u94f6\u884c\u623f\u8d37","\u6d66\u53d1\u94f6\u884c\u6d88\u8d39\u8d37","\u519c\u4e1a\u94f6\u884c\u623f\u8d37","\u5357\u4eac\u94f6\u884c\u8d37\u6b3e","\u62db\u5546\u94f6\u884c\u95ea\u7535\u8d37","\u5de5\u5546\u94f6\u884c\u8f66\u8d37","\u7406\u8d22\u5e08\u8ba1\u5212"]},{type:"\u8d2d\u7269",categories:["\u4e66\u7c4d\u8d44\u6599","\u7535\u5b503C","\u6e38\u620f\u5145\u503c","\u5e94\u7528\u670d\u52a1","\u5316\u5986\u62a4\u80a4","\u670d\u88c5\u8863\u9970","\u914d\u4ef6\u9970\u54c1","\u5305\u5305\u624b\u8868","\u6536\u85cf","\u8d2d\u7269\u5176\u4ed6"]},{type:"\u5a31\u4e50",categories:["\u6f14\u5531\u4f1a","\u8bdd\u5267","\u7535\u5f71","\u5531\u6b4c","\u5468\u8fb9\u5916\u51fa","\u65c5\u884c\u5f00\u9500","\u5a31\u4e50\u5176\u4ed6"]}],S=["Exclude","Special","ME\u7238\u5988","ME\u4eb2\u621a","ME\u53cb\u4eba","HJ\u7238\u5988","HJ\u4eb2\u621a","HJ\u53cb\u4eba","LJY","LSY","VPS","DNS","APP","MUSIC","JD","TB88","DRIVE","100x"],Y={},f=Object(g.map)(N,e=>(Y[e.type]=e.categories,e.type)),T=f[0];a(492);i.a.tz.setDefault("Asia/Shanghai");var A=()=>{const[e,t]=Object(s.useState)("MAIN_PAGE"),{loginState:{success:a,userName:c}}=p();return n.a.createElement("div",{className:"App"},n.a.createElement(D,{goBack:a&&"MAIN_PAGE"!==e?()=>{t("MAIN_PAGE")}:void 0,userName:c}),n.a.createElement("div",{className:"content-wrapper"},!a&&n.a.createElement(x,null),a&&"MAIN_PAGE"===e&&n.a.createElement("div",{className:"page-select-area"},n.a.createElement("div",{className:"main-title"},"Welcome!"),n.a.createElement(r.a,{className:"button incomes",type:"primary",onClick:()=>{t("INCOMES_PAGE")}},"Incomes"),n.a.createElement(r.a,{className:"button expenses",type:"primary",onClick:()=>{t("EXPENSES_PAGE")}},"Expenses"),n.a.createElement(r.a,{className:"button report",type:"primary",onClick:()=>{t("REPORT_PAGE")}},"Reports"),n.a.createElement(r.a,{className:"button data-import",type:"primary",onClick:()=>{t("DATA_IMPORT_PAGE")}},"Data Import"),n.a.createElement(r.a,{className:"button logout",onClick:()=>{document.location.reload()}},"Log Out")),a&&"INCOMES_PAGE"===e&&n.a.createElement(ce,{billingType:"BILLING_TYPE_INCOMES",goBack:()=>{t("MAIN_PAGE")}}),a&&"EXPENSES_PAGE"===e&&n.a.createElement(ce,{billingType:"BILLING_TYPE_EXPENSES",goBack:()=>{t("MAIN_PAGE")}}),a&&"REPORT_PAGE"===e&&n.a.createElement(ue,{goBack:()=>{t("MAIN_PAGE")}}),a&&"DATA_IMPORT_PAGE"===e&&n.a.createElement(be,{goBack:()=>{t("MAIN_PAGE")}})),n.a.createElement(C,null))};a(509);var D=e=>{const{userName:t,goBack:a}=e;return n.a.createElement("header",{id:"header"},n.a.createElement("a",{className:"site-logo",onClick:()=>a?a():document.location.replace("/")},n.a.createElement("img",{src:"/images/logo/SR-oneline.png",alt:"SeasonsRoad"})),t&&n.a.createElement("span",{className:"site-user"},t))};a(510);var C=()=>n.a.createElement("footer",{id:"footer"},n.a.createElement("div",{className:"wrapper"},n.a.createElement("div",{className:"left"},n.a.createElement("span",{className:"item"},n.a.createElement("a",{href:"https://github.com/yiminglu"},n.a.createElement("span",{className:"icon icon--github","aria-hidden":"true"},n.a.createElement("svg",{viewBox:"0 0 16 16"},n.a.createElement("path",{fill:"#828282",d:"M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"}))),n.a.createElement("span",{className:"username"},"yiminglu")))),n.a.createElement("div",{className:"right"},n.a.createElement("span",{className:"item"},"\xa9 SeasonsRoad")))),v=(a(230),a(77)),j=(a(183),a(51)),M=a(157),I=a(179),L=a.n(I);a(1005);let w,R;const _=()=>R;M.b.configure({Auth:{identityPoolId:"us-west-2:70fc8736-5e86-47f3-ab1b-f05b0d93fa2e",region:"us-west-2",userPoolId:"us-west-2_ErwhI1bKS",userPoolWebClientId:"sq9tv2htpaluv4buido7l9eiu",mandatorySignIn:!1,authenticationFlowType:"USER_PASSWORD_AUTH"}});var x=()=>{const[e,t]=Object(s.useState)({username:"",password:"",status:"NOT_READY"}),[a,c]=Object(s.useState)({newPassword:"",newPasswordConfirm:"",rstatus:"NOT_READY"}),{username:l,password:o,status:i}=e,{newPassword:m,newPasswordConfirm:d,rstatus:u}=a,{loginSuccess:g}=p(),E=()=>{M.a.currentCredentials().then(e=>{L.a.config.update({region:"us-west-2"}),R=new L.a.DynamoDB({apiVersion:"2012-08-10",credentials:M.a.essentialCredentials(e)}),g(l)})},h=()=>{"READY"===i&&(t({...e,status:"LOADING"}),M.a.signIn({username:l,password:o}).then(a=>{w=a,"NEW_PASSWORD_REQUIRED"===a.challengeName?(j.a.warning({message:"New Password Required!",description:"Welcome, ".concat(a.username,"! You need to set up your new password so that we could begin.")}),t({...e,status:"RESET"})):"SMS_MFA"!==a.challengeName&&"SOFTWARE_TOKEN_MFA"!==a.challengeName&&"MFA_SETUP"!==a.challengeName?(j.a.success({message:"Login Success!",description:"Welcome back, ".concat(a.username,"!"),duration:3}),E(),t({...e,status:"READY"})):j.a.warning({message:"Unhandled User status!",description:"Please contact your admin."})}).catch(a=>{j.a.error({message:"Login Failed!",description:"".concat(a.message||a)}),t({...e,status:"FAILED"})}))},y=()=>{w&&"NEW_PASSWORD_REQUIRED"===w.challengeName&&M.a.completeNewPassword(w,m,{}).then(a=>{w=a,"SMS_MFA"!==a.challengeName&&"SOFTWARE_TOKEN_MFA"!==a.challengeName&&"MFA_SETUP"!==a.challengeName?(j.a.success({message:"Login Success!",description:"Welcome back, ".concat(a.username,"!"),duration:3}),E(),t({...e,status:"READY"})):j.a.warning({message:"Unhandled User status!",description:"Please contact your admin."})}).catch(e=>{j.a.error({message:"Reset Failed!",description:"".concat(e.message||e)}),c({...a,rstatus:"FAILED"})})};return n.a.createElement("div",{className:"login-container"},n.a.createElement("div",{className:"login-title"},"RESET"!==i?"Billing System":"Reset Password"),"RESET"!==i&&n.a.createElement(v.a,{className:"username-input".concat("FAILED"===i?" error":""),size:"large",onChange:a=>{const s=a.target.value;t(""!==s&&""!==o?{...e,username:s,status:"READY"}:{...e,username:s,status:"NOT_READY"})},onPressEnter:h,placeholder:"Input User Name"}),"RESET"!==i&&n.a.createElement(v.a.Password,{className:"password-input".concat("FAILED"===i?" error":""),size:"large",onChange:a=>{const s=a.target.value;t(""!==l&&""!==s?{...e,password:s,status:"READY"}:{...e,password:s,status:"NOT_READY"})},onPressEnter:h,placeholder:"Input Password"}),"RESET"!==i&&n.a.createElement(r.a,{className:"login-button",size:"large",type:"primary",disabled:"NOT_READY"===i,loading:"LOADING"===i,onClick:h},"Login"),"RESET"===i&&n.a.createElement(v.a.Password,{className:"password-reset-input",size:"large",onChange:e=>{const t=e.target.value;c(t===d?{...a,newPassword:t,rstatus:"READY"}:{...a,newPassword:t,rstatus:"NOT_READY"})},onPressEnter:y,placeholder:"Input New Password"}),"RESET"===i&&n.a.createElement(v.a.Password,{className:"password-reset-confirm-input",size:"large",onChange:e=>{const t=e.target.value;c(m===t?{...a,newPasswordConfirm:t,rstatus:"READY"}:{...a,newPasswordConfirm:t,rstatus:"NOT_READY"})},onPressEnter:y,placeholder:"Confirm New Password"}),"RESET"===i&&n.a.createElement(r.a,{className:"reset-button",size:"large",type:"primary",disabled:"NOT_READY"===u,loading:"LOADING"===u,onClick:y},"Reset"))},k=(a(1406),a(227)),P=(a(1034),a(299)),H=(a(1036),a(297)),B=(a(1038),a(228)),F=(a(364),a(96)),U=(a(1041),a(478)),G=(a(1043),a(300)),z=(a(283),a(153)),V=(a(247),a(85)),W=(a(248),a(95)),Q=(a(1053),a(226)),q=a(1410),J=a(1411),K=a(1412),X=a(1413);a(1055);const{RangePicker:Z}=Q.a,{CheckableTag:$}=W.a,{Option:ee}=V.a,te=i()().subtract(1,"months").startOf("month"),ae=i()().endOf("month"),se=["Special","Fixed","Exclude"],ne=e=>Boolean(e&&e>i()().endOf("month"));var ce=e=>{const{billingType:t,goBack:a}=e,{loginState:{isAdmin:c}}=p(),l="BILLING_TYPE_INCOMES"===t,o=l?"Incomes":"Expenses",m=l?O:T,d=l?"Incomes":"Expenses",u=l?b:f,A=l?h:S,D=l?y:Y,C=l?[1/0,0,1e3,1e4]:[1/0,0,100,300,1e3],[M,I]=Object(s.useState)(!1),[L,w]=Object(s.useState)({start:te,end:ae,types:{},selectedTypes:u,categories:[],selectedCategories:[],selectedTags:[],selectMultipleTags:!1,specialTags:[],selectedSpecialTags:["Normal",...se],thresholdType:"THRESHOLD_DISABLED",thresholdValue:1/0,sortByAmount:!1,showNumbers:!0,search:""}),[R,x]=Object(s.useState)({status:"START",list:[]}),[ce,le]=Object(s.useState)({type:m,timestamp:-1,creating:!1,updating:!1,deleting:!1,tagsSearch:"",tagsAdding:!1,data:{type:"",timestamp:0,amount:0,category:"",details:"",tags:[]}}),[re,oe]=Object(s.useState)(i()().unix()),{start:ie,end:me,types:de,selectedTypes:ue,categories:pe,selectedCategories:ge,selectedTags:Ee,selectMultipleTags:he,specialTags:ye,selectedSpecialTags:be,thresholdType:Oe,thresholdValue:Ne,sortByAmount:Se,showNumbers:Ye,search:fe}=L;Object(s.useEffect)(()=>{x({...R,status:"LOADING"});const e=ie.unix(),t=me.unix(),a=(t-e)/3456e4+1,s=Object(g.times)(a,s=>1===a?[e,t]:0===s?[e,e+3456e4]:s===a-1?[e+3456e4*s+1,t]:[e+3456e4*s+1,e+3456e4*(s+1)]);Promise.all(Object(g.map)(s,e=>new Promise((t,a)=>{const s={ExpressionAttributeNames:{"#P":"partition","#TS":"timestamp"},ExpressionAttributeValues:{":partition":{S:d},":t1":{N:"".concat(e[0])},":t2":{N:"".concat(e[1])}},KeyConditionExpression:"#P = :partition AND #TS BETWEEN :t1 AND :t2",TableName:"BillingV3"};_().query(s,(e,s)=>{if(e)return void a(e);const n=Object(g.map)(s.Items,e=>l?{timestamp:parseInt(e.timestamp.N,10),type:e.type.S,amount:parseFloat(e.amount.N),category:e.category.S,details:e.details?e.details.S:"",tags:Object(g.filter)(e.tags?e.tags.SS:[],e=>""!==e&&" "!==e)}:{timestamp:parseInt(e.timestamp.N,10),type:e.type.S,amount:parseFloat(e.amount.N),category:e.category.S,merchant:e.merchant.S,merchandise:e.merchandise.S,tags:Object(g.filter)(e.tags?e.tags.SS:[],e=>""!==e&&" "!==e)});t(n)})}))).then(e=>{const t=Object(g.reduce)(e,(e,t)=>Object(g.concat)(e,t),[]);Object(g.each)(t,e=>{e.tags.includes("100x")&&(c?e.amount*=100:Object(g.remove)(e.tags,e=>"100x"===e))});const a=Object(g.filter)(t,e=>ue.includes(e.type)),s=Object(g.filter)(a,e=>"THRESHOLD_DISABLED"===Oe||"THRESHOLD_LARGER_THAN"===Oe&&e.amount>=Ne||"THRESHOLD_SMALLER_THAN"===Oe&&e.amount<=Ne||"THRESHOLD_EQUALS_TO"===Oe&&e.amount===Ne),n=Object(g.filter)(s,e=>""===fe||Boolean(e.type.toUpperCase().includes(fe.toUpperCase()))||Boolean(e.category.toUpperCase().includes(fe.toUpperCase()))||Boolean(e.merchant&&e.merchant.toUpperCase().includes(fe.toUpperCase()))||Boolean(e.merchandise&&e.merchandise.toUpperCase().includes(fe.toUpperCase()))||Boolean(e.details&&e.details.toUpperCase().includes(fe.toUpperCase()))||Boolean(e.tags.length>0&&Object(g.find)(e.tags,e=>e.toUpperCase().includes(fe.toUpperCase())))),l={};Object(g.each)(u,e=>{l[e]=0});const r={Normal:0,Special:0,Fixed:0,Exclude:0};Object(g.each)(n,e=>{const t=Object(g.intersection)(e.tags,se)[0]||"Normal";r[t]++,l[e.type]++});const o=Object(g.filter)(n,e=>Object(g.intersection)(e.tags,se,be).length>0||0===Object(g.intersection)(e.tags,se).length&&be.includes("Normal")),i={};let m=["! NO TAGs"];Object(g.each)(o,e=>{i[e.category]||(i[e.category]={count:0,amount:0}),i[e.category].count++,i[e.category].amount+=e.amount,m=Object(g.union)(m,Object(g.difference)(e.tags,se))});const d=Object(g.sortBy)(Object(g.map)(i,(e,t)=>({category:t,count:e.count,amount:e.amount})),Se?"amount":"count").reverse();x({status:"SUCCESS",list:t}),w({...L,types:l,categories:d,selectedCategories:Object(g.map)(d,e=>e.category),selectedTags:he?m:[],specialTags:Object(g.map)(r,(e,t)=>({tag:t,count:e}))}),I(!1)}).catch(e=>{console.log(e,e.stack),j.a.error({message:"Query Failed!",description:"".concat(e.message||e),duration:0}),x({...R,status:"FAILED"})})},[ie,me,re]),Object(s.useEffect)(()=>{const e=Object(g.filter)(R.list,e=>ue.includes(e.type)),t=Object(g.filter)(e,e=>"THRESHOLD_DISABLED"===Oe||"THRESHOLD_LARGER_THAN"===Oe&&e.amount>=Ne||"THRESHOLD_SMALLER_THAN"===Oe&&e.amount<=Ne||"THRESHOLD_EQUALS_TO"===Oe&&e.amount===Ne),a=Object(g.filter)(t,e=>""===fe||Boolean(e.type.toUpperCase().includes(fe.toUpperCase()))||Boolean(e.category.toUpperCase().includes(fe.toUpperCase()))||Boolean(e.merchant&&e.merchant.toUpperCase().includes(fe.toUpperCase()))||Boolean(e.merchandise&&e.merchandise.toUpperCase().includes(fe.toUpperCase()))||Boolean(e.details&&e.details.toUpperCase().includes(fe.toUpperCase()))||Boolean(e.tags.length>0&&Object(g.find)(e.tags,e=>e.toUpperCase().includes(fe.toUpperCase())))),s={Normal:0,Special:0,Fixed:0,Exclude:0};Object(g.each)(a,e=>{const t=Object(g.intersection)(e.tags,se)[0]||"Normal";s[t]++});const n=Object(g.filter)(a,e=>Object(g.intersection)(e.tags,se,be).length>0||0===Object(g.intersection)(e.tags,se).length&&be.includes("Normal")),c={};let l=["! NO TAGs"];Object(g.each)(n,e=>{c[e.category]||(c[e.category]={count:0,amount:0}),c[e.category].count++,c[e.category].amount+=e.amount,l=Object(g.union)(l,Object(g.difference)(e.tags,se))});const r=Object(g.sortBy)(Object(g.map)(c,(e,t)=>({category:t,count:e.count,amount:e.amount})),Se?"amount":"count").reverse();w({...L,categories:r,selectedCategories:Object(g.map)(r,e=>e.category),selectedTags:he?l:[],specialTags:Object(g.map)(s,(e,t)=>({tag:t,count:e}))}),I(!1)},[ue.join(","),Oe,Ne,Se,fe,be.join(",")]);const Te=Object(g.filter)(R.list,e=>ue.includes(e.type)),Ae=Object(g.filter)(Te,e=>"THRESHOLD_DISABLED"===Oe||"THRESHOLD_LARGER_THAN"===Oe&&e.amount>=Ne||"THRESHOLD_SMALLER_THAN"===Oe&&e.amount<=Ne||"THRESHOLD_EQUALS_TO"===Oe&&e.amount===Ne),De=Object(g.filter)(Ae,e=>""===fe||Boolean(e.type.toUpperCase().includes(fe.toUpperCase()))||Boolean(e.category.toUpperCase().includes(fe.toUpperCase()))||Boolean(e.merchant&&e.merchant.toUpperCase().includes(fe.toUpperCase()))||Boolean(e.merchandise&&e.merchandise.toUpperCase().includes(fe.toUpperCase()))||Boolean(e.details&&e.details.toUpperCase().includes(fe.toUpperCase()))||Boolean(Object(g.difference)(e.tags,se).length>0&&Object(g.find)(Object(g.difference)(e.tags,se),e=>e.toUpperCase().includes(fe.toUpperCase())))),Ce=Object(g.filter)(De,e=>Object(g.intersection)(e.tags,se,be).length>0||0===Object(g.intersection)(e.tags,se).length&&be.includes("Normal")),ve=Object(g.filter)(Ce,e=>ge.includes(e.category));let je=["! NO TAGs"];const Me=Ee.includes("! NO TAGs"),Ie=Object(g.filter)(ve,e=>(je=Object(g.union)(je,Object(g.difference)(e.tags,se)),!he&&0===Ee.length||Me&&Boolean(!e.tags||!Object(g.difference)(e.tags,se).length)||Object(g.intersection)(e.tags,Ee).length>0)),Le=Ie.length;let we=0;Object(g.each)(Ie,e=>{we+=e.amount});const Re={};let _e=0,xe=0;Object(g.each)(ve,e=>{e.tags&&Object(g.difference)(e.tags,se).length>0?Object(g.each)(Object(g.difference)(e.tags,se),t=>{Re[t]||(Re[t]={count:0,amount:0}),Re[t].count++,Re[t].amount+=e.amount}):(_e++,xe+=e.amount)});const ke=Object(g.sortBy)(Object(g.map)(Re,(e,t)=>({tag:t,count:e.count,amount:e.amount})),Se?"amount":"count").reverse(),Pe=Object(g.filter)(ke,e=>"Fixed"!==e.tag&&"Special"!==e.tag&&"Exclude"!==e.tag);let He;return Object(s.useEffect)(()=>{ce.tagsAdding&&He.focus()},[ce.tagsAdding]),n.a.createElement("div",{className:"billing-container ".concat(l?"incomes":"expenses").concat("LOADING"===R.status?" loading":"")},n.a.createElement(z.a,{onBack:()=>a&&a(),title:o}),n.a.createElement("div",{className:"touch-breaker"}),n.a.createElement(G.a,{checkedChildren:"\u603b\u91cf\u6392\u5e8f",unCheckedChildren:"\u6b21\u6570\u6392\u5e8f",checked:Se,onChange:e=>w({...L,sortByAmount:e}),className:"sort-by-selector"}),n.a.createElement(U.a,{checked:Ye,onChange:e=>w({...L,showNumbers:e.target.checked}),className:"show-number-checkbox"}),n.a.createElement("div",{className:"types-selector multiple-selector-primary"},n.a.createElement("span",null,Object(g.map)(u,e=>n.a.createElement($,{className:"near-by",key:e,checked:ue.includes(e),onChange:()=>{w({...L,selectedTypes:Object(g.xor)(ue,[e])})}},e,n.a.createElement("span",{className:"sp-tag-count"},Ye&&Boolean(de[e])&&" ".concat(de[e]))))),n.a.createElement(r.a,{type:"primary",size:"small",onClick:()=>{w({...L,selectedTypes:0===ue.length?u:[]})}},0===ue.length?n.a.createElement(q.a,null):n.a.createElement(J.a,null))),n.a.createElement("div",{className:"date-range-picker"},n.a.createElement(Z,{ranges:{ALL:[i()("20150501","YYYYMMDD"),i()("".concat(i()().year()+(i()().month()<4?0:1)).concat(i()().month()<4?"12":"04","01"),"YYYYMMDD").endOf("month")],FY24:[i()("20230501","YYYYMMDD"),i()("20240401","YYYYMMDD").endOf("month")],FY23:[i()("20220501","YYYYMMDD"),i()("20230401","YYYYMMDD").endOf("month")],FY22:[i()("20210501","YYYYMMDD"),i()("20220401","YYYYMMDD").endOf("month")],FY21:[i()("20200501","YYYYMMDD"),i()("20210401","YYYYMMDD").endOf("month")],FY20:[i()("20190501","YYYYMMDD"),i()("20200401","YYYYMMDD").endOf("month")],FY19:[i()("20180501","YYYYMMDD"),i()("20190401","YYYYMMDD").endOf("month")],FY18:[i()("20170501","YYYYMMDD"),i()("20180401","YYYYMMDD").endOf("month")],FY17:[i()("20160501","YYYYMMDD"),i()("20170401","YYYYMMDD").endOf("month")],FY16:[i()("20150501","YYYYMMDD"),i()("20160401","YYYYMMDD").endOf("month")],Y24:[i()("20240101","YYYYMMDD"),i()("20240101","YYYYMMDD").endOf("year")],Y23:[i()("20230101","YYYYMMDD"),i()("20230101","YYYYMMDD").endOf("year")],Y22:[i()("20220101","YYYYMMDD"),i()("20220101","YYYYMMDD").endOf("year")],Y21:[i()("20210101","YYYYMMDD"),i()("20210101","YYYYMMDD").endOf("year")],Y20:[i()("20200101","YYYYMMDD"),i()("20200101","YYYYMMDD").endOf("year")],Y19:[i()("20190101","YYYYMMDD"),i()("20190101","YYYYMMDD").endOf("year")],Y18:[i()("20180101","YYYYMMDD"),i()("20180101","YYYYMMDD").endOf("year")],"-12M":[i()().subtract(1,"years").startOf("month"),i()().subtract(1,"month").endOf("month")],"-24M":[i()().subtract(2,"years").startOf("month"),i()().subtract(1,"month").endOf("month")],"-24M ~ -12M":[i()().subtract(2,"years").startOf("month"),i()().subtract(1,"years").subtract(1,"month").endOf("month")]},defaultValue:[te,ae],disabledDate:ne,onChange:e=>{w({...L,start:Object(g.get)(e,"0")||i()(),end:Object(g.get)(e,"1")||i()()})},allowClear:!1,size:"large"})),n.a.createElement("div",{className:"special-tags-selector multiple-selector-primary"},n.a.createElement("span",null,Object(g.map)(ye,e=>n.a.createElement($,{className:"near-by",key:e.tag,checked:be.includes(e.tag),onChange:()=>{w({...L,selectedSpecialTags:Object(g.xor)(be,[e.tag])})}},e.tag,n.a.createElement("span",{className:"sp-tag-count"},Ye&&" ".concat(e.count))))),n.a.createElement(r.a,{type:"primary",size:"small",onClick:()=>{w({...L,selectedSpecialTags:0===be.length?["Normal",...se]:[]})}},0===be.length?n.a.createElement(q.a,null):n.a.createElement(J.a,null))),n.a.createElement("div",{className:"search-container"},n.a.createElement(v.a,{value:fe,onChange:e=>w({...L,search:e.target.value}),placeholder:"\u641c\u7d22"})),n.a.createElement("div",{className:"threshold-selector"},n.a.createElement(F.a.Group,{onChange:e=>w({...L,thresholdType:e.target.value===1/0?"THRESHOLD_DISABLED":"THRESHOLD_DISABLED"===Oe?"THRESHOLD_LARGER_THAN":Oe,thresholdValue:e.target.value}),value:Ne,className:"threshold-quick-selector"},Object(g.map)(C,e=>n.a.createElement(F.a.Button,{key:e,value:e},e===1/0?n.a.createElement(J.a,null):e))),n.a.createElement("span",{className:"threshold-type-value-container"},"THRESHOLD_DISABLED"!==Oe&&n.a.createElement(r.a,{className:"threshold-type",onClick:()=>{w({...L,thresholdType:"THRESHOLD_LARGER_THAN"===Oe?"THRESHOLD_SMALLER_THAN":"THRESHOLD_SMALLER_THAN"===Oe?"THRESHOLD_EQUALS_TO":"THRESHOLD_LARGER_THAN"})}},"THRESHOLD_LARGER_THAN"===Oe&&"\u2265","THRESHOLD_SMALLER_THAN"===Oe&&"\u2264","THRESHOLD_EQUALS_TO"===Oe&&"="),"THRESHOLD_DISABLED"!==Oe&&n.a.createElement(B.a,{className:"threshold-value",value:Ne,onChange:e=>{let t=0;"number"===typeof e?t=e:"string"===typeof e&&(t=parseInt(e,10)),w({...L,thresholdValue:t})},step:l?1e3:100,precision:0,style:{width:80}}))),n.a.createElement("div",{className:"categories-selector"},Object(g.map)(pe,e=>n.a.createElement($,{key:e.category,checked:Object(g.includes)(ge,e.category),onChange:t=>{w(t?{...L,selectedCategories:[...ge,e.category]}:{...L,selectedCategories:Object(g.filter)(ge,t=>t!==e.category)})}},e.category,n.a.createElement("span",{className:"count"},Ye&&"".concat(Se?e.amount.toFixed(2):e.count)))),pe.length>0&&0===ge.length&&n.a.createElement(r.a,{type:"primary",size:"small",onClick:()=>{w({...L,selectedCategories:Object(g.map)(pe,e=>e.category)})}},n.a.createElement(q.a,null)),pe.length>0&&0!==ge.length&&n.a.createElement(r.a,{type:"primary",size:"small",onClick:()=>{w({...L,selectedCategories:[]})}},n.a.createElement(J.a,null))),n.a.createElement("div",{className:"tags-selector"},Object(g.map)(Pe,e=>n.a.createElement($,{key:e.tag,checked:Ee.includes(e.tag),onChange:t=>{w(t?{...L,selectedTags:he?Object(g.union)(Ee,[e.tag]):[e.tag]}:{...L,selectedTags:he?Object(g.xor)(Ee,[e.tag]):[]})}},e.tag,n.a.createElement("span",{className:"count"},Ye&&"".concat(Se?e.amount.toFixed(2):e.count)))),_e>0&&n.a.createElement($,{className:"no-tags-tag",checked:Ee.includes("! NO TAGs"),onChange:e=>{w(e?{...L,selectedTags:he?Object(g.union)(Ee,["! NO TAGs"]):["! NO TAGs"]}:{...L,selectedTags:he?Object(g.xor)(Ee,["! NO TAGs"]):[]})}},"! NO TAGs",n.a.createElement("span",{className:"count"},Ye&&"".concat(Se?xe.toFixed(2):_e))),he&&Pe.length>0&&n.a.createElement(r.a,{type:"primary",size:"small",onClick:()=>{w({...L,selectedTags:0===Ee.length?je:[]})}},0===Ee.length?n.a.createElement(q.a,null):n.a.createElement(J.a,null)),(Pe.length>0||_e>0)&&n.a.createElement(G.a,{checkedChildren:"\u591a\u9009",unCheckedChildren:"\u5355\u9009",checked:he,onChange:e=>w({...L,selectedTags:e?je:[],selectMultipleTags:e}),className:"multiple-selector-selector"})),n.a.createElement(k.b,{className:"billing-list",header:n.a.createElement("div",{className:"item header"},n.a.createElement("span",{className:"date"},"Date"),n.a.createElement("span",{className:"type"},"Type"),n.a.createElement("span",{className:"category"},"Category"),n.a.createElement("span",{className:"amount"},"Amount"),l&&n.a.createElement("span",{className:"details"},"Details"),l||n.a.createElement("span",{className:"merchant"},"Merchant"),l||n.a.createElement("span",{className:"merchandise"},"Merchandise"),n.a.createElement("span",{className:"tags"},"Tags")),footer:n.a.createElement("div",{className:"billing-list-footer"},n.a.createElement(K.a,{className:"add-new",onClick:()=>{le({...ce,timestamp:-1/0,data:l?{type:E[0].type,timestamp:i()().startOf("day").unix(),amount:0,category:E[0].categories[0],details:"",tags:[]}:{type:N[0].type,timestamp:i()().startOf("day").unix(),amount:0,category:N[0].categories[0],merchant:"",merchandise:"",tags:[]}})}}),n.a.createElement("div",null,Le>0&&n.a.createElement("div",null,"Count:"," ",n.a.createElement("span",{className:"number"},Le)),Le>0&&n.a.createElement("div",null,"Average:"," ",n.a.createElement("span",{className:"number"},"\uffe5",(we/Le).toFixed(2))),n.a.createElement("div",null,"Total:"," ",n.a.createElement("span",{className:"number"},"\uffe5",we.toFixed(2)))),n.a.createElement(P.a,{title:"Create ".concat(o," Item"),placement:"right",closable:!0,destroyOnClose:!0,width:300,className:"billing-create-drawer",onClose:()=>le({...ce,timestamp:-1}),visible:ce.timestamp===-1/0},n.a.createElement("div",{className:"DateTime column"},n.a.createElement("span",null,"DateTime"),n.a.createElement("div",null,n.a.createElement(Q.a,{allowClear:!1,showTime:!0,value:i.a.unix(ce.data.timestamp),onChange:e=>le({...ce,data:{...ce.data,timestamp:e?e.unix():i()().startOf("day").unix()}}),style:{width:"100%"}}))),n.a.createElement("div",{className:"Type column"},n.a.createElement("span",null,"Type"),n.a.createElement("div",null,n.a.createElement(F.a.Group,{value:ce.data.type,onChange:e=>le({...ce,data:{...ce.data,type:e.target.value,category:D[e.target.value][0]}}),buttonStyle:"solid",className:"type-selector"},Object(g.map)(u,e=>n.a.createElement(F.a.Button,{key:e,value:e},e))))),n.a.createElement("div",{className:"Category column"},n.a.createElement("span",null,"Category"),n.a.createElement("div",null,n.a.createElement(V.a,{value:ce.data.category,onChange:e=>le({...ce,data:{...ce.data,category:e}}),style:{width:"100%"}},Object(g.map)(D[ce.data.type],e=>n.a.createElement(ee,{key:e,value:e},e))))),n.a.createElement("div",{className:"Amount column"},n.a.createElement("span",null,"Amount"),n.a.createElement("div",null,n.a.createElement(B.a,{value:ce.data.amount,onChange:e=>{let t=0;"number"===typeof e?t=e:"string"===typeof e&&(t=parseInt(e,10)),le({...ce,data:{...ce.data,amount:t}})},step:l?1e3:100,precision:2,style:{width:"100%"}}))),l&&n.a.createElement("div",{className:"Details column"},n.a.createElement("span",null,"Details"),n.a.createElement("div",null,n.a.createElement(v.a,{value:ce.data.details,onChange:e=>le({...ce,data:{...ce.data,details:e.target.value}}),style:{width:"100%"}}))),l||n.a.createElement("div",{className:"Merchant column"},n.a.createElement("span",null,"Merchant"),n.a.createElement("div",null,n.a.createElement(v.a,{value:ce.data.merchant,onChange:e=>le({...ce,data:{...ce.data,merchant:e.target.value}}),style:{width:"100%"}}))),l||n.a.createElement("div",{className:"Merchandise column"},n.a.createElement("span",null,"Merchandise"),n.a.createElement("div",null,n.a.createElement(v.a,{value:ce.data.merchandise,onChange:e=>le({...ce,data:{...ce.data,merchandise:e.target.value}}),style:{width:"100%"}}))),n.a.createElement("div",{className:"Tags column"},n.a.createElement("span",null,"Tags"),n.a.createElement("div",null,Object(g.map)(ce.data.tags,e=>n.a.createElement(W.a,{key:e,closable:!0,onClose:()=>le({...ce,data:{...ce.data,tags:Object(g.filter)(ce.data.tags,t=>t!==e)}}),visible:!0}," ",e," ")),ce.tagsAdding||n.a.createElement(W.a,{onClick:()=>le({...ce,tagsSearch:"",tagsAdding:!0}),style:{background:"#fff",borderStyle:"dashed"}},n.a.createElement(X.a,null)),ce.tagsAdding&&n.a.createElement(H.a,{size:"small",ref:e=>{He=e},dataSource:[...""===ce.tagsSearch?[]:[ce.tagsSearch],...A],style:{width:250},onSelect:e=>le({...ce,data:{...ce.data,tags:[...ce.data.tags,...""!==e&&-1===ce.data.tags.indexOf(e)?[e]:[]]},tagsAdding:!1}),onSearch:e=>le({...ce,tagsSearch:e}),onBlur:()=>le({...ce,tagsSearch:"",tagsAdding:!1}),defaultOpen:!0}))),n.a.createElement("div",{className:"buttons"},n.a.createElement(r.a,{type:"primary",style:{width:"100%"},loading:ce.creating,onClick:()=>{le({...ce,creating:!0});const e={ExpressionAttributeNames:{"#TS":"timestamp"},Item:{partition:{S:d},timestamp:{N:"".concat(ce.data.timestamp)},type:{S:ce.data.type},category:{S:ce.data.category},amount:{N:"".concat(ce.data.amount)},tags:{S:"".concat(ce.data.tags.join(" ")," ")}},ReturnConsumedCapacity:"TOTAL",TableName:"BillingV3",ConditionExpression:"attribute_not_exists(#TS)"};l?e.Item.details={S:""===ce.data.details?" ":ce.data.details}:(e.Item.merchant={S:""===ce.data.merchant?" ":ce.data.merchant},e.Item.merchandise={S:""===ce.data.merchandise?" ":ce.data.merchandise}),_().putItem(e,e=>{e?(console.log(e,e.stack),j.a.error({message:"Creation Failed!",description:"".concat(e.message||e).concat("The conditional request failed"===e.message?"! We should not override exising items. Try a new timestamp.":"!"),duration:0}),le({...ce,creating:!1})):(j.a.success({message:"Item Created!"}),le({...ce,timestamp:-1,creating:!1}),oe(i()().unix()))})}},"Create Item")))),bordered:!0,dataSource:M||Le<=50?Ie:[...Object(g.slice)(Ie,0,50),{timestamp:0,type:"BILLING_ITEMS_TOGGLE_ALL_TYPE",category:"",amount:0,tags:[]}],renderItem:e=>"BILLING_ITEMS_TOGGLE_ALL_TYPE"===e.type?n.a.createElement(k.b.Item,{key:"BILLING_ITEMS_TOGGLE_ALL_TYPE"},n.a.createElement(r.a,{type:"link",style:{width:"100%"},onClick:()=>I(!0)},"Toggle All")):n.a.createElement(k.b.Item,{key:e.timestamp},n.a.createElement("div",{className:"item",onClick:()=>le({type:e.type,timestamp:e.timestamp,creating:!1,updating:!1,deleting:!1,tagsSearch:"",tagsAdding:!1,data:{...e,details:" "===e.details?"":e.details}})},n.a.createElement("span",{className:"date"},i.a.unix(e.timestamp).format("YYYY-MM-DD")),n.a.createElement("span",{className:"type"},e.type),n.a.createElement("span",{className:"category"},e.category),n.a.createElement("span",{className:"amount"},"\uffe5".concat(e.amount.toFixed(2))),l&&n.a.createElement("span",{className:"details"}," "===e.details?"":e.details),l||n.a.createElement("span",{className:"merchant"}," "===e.merchant?"":e.merchant),l||n.a.createElement("span",{className:"merchandise"}," "===e.merchandise?"":e.merchandise),n.a.createElement("span",{className:"tags"},Object(g.map)(e.tags,e=>n.a.createElement(W.a,{key:e,closable:!1,visible:!0}," ",e," ")))),n.a.createElement(P.a,{title:"Edit ".concat(o," Item"),placement:"right",closable:!0,destroyOnClose:!0,width:300,className:"billing-edit-drawer",onClose:()=>le({...ce,timestamp:-1}),visible:ce.timestamp===e.timestamp},n.a.createElement("div",{className:"DateTime column"},n.a.createElement("span",null,"DateTime"),n.a.createElement("div",null,n.a.createElement(Q.a,{showTime:!0,value:i.a.unix(ce.data.timestamp),disabled:!0,style:{width:"100%"}}))),n.a.createElement("div",{className:"Type column"},n.a.createElement("span",null,"Type"),n.a.createElement("div",null,n.a.createElement(F.a.Group,{value:ce.data.type,onChange:e=>le({...ce,data:{...ce.data,type:e.target.value,category:u[e.target.value][0]}}),buttonStyle:"solid",className:"type-selector"},Object(g.map)(u,e=>n.a.createElement(F.a.Button,{key:e,value:e},e))))),n.a.createElement("div",{className:"Category column"},n.a.createElement("span",null,"Category"),n.a.createElement("div",null,n.a.createElement(V.a,{value:ce.data.category,onChange:e=>le({...ce,data:{...ce.data,category:e}}),style:{width:"100%"}},Object(g.map)(D[ce.data.type],e=>n.a.createElement(ee,{key:e,value:e},e))))),n.a.createElement("div",{className:"Amount column"},n.a.createElement("span",null,"Amount"),n.a.createElement("div",null,n.a.createElement(B.a,{value:ce.data.amount,onChange:e=>{let t=0;"number"===typeof e?t=e:"string"===typeof e&&(t=parseInt(e,10)),le({...ce,data:{...ce.data,amount:t}})},step:1e3,precision:2,style:{width:"100%"}}))),l&&n.a.createElement("div",{className:"Details column"},n.a.createElement("span",null,"Details"),n.a.createElement("div",null,n.a.createElement(v.a,{value:ce.data.details,onChange:e=>le({...ce,data:{...ce.data,details:e.target.value}}),style:{width:"100%"}}))),l||n.a.createElement("div",{className:"Merchant column"},n.a.createElement("span",null,"Merchant"),n.a.createElement("div",null,n.a.createElement(v.a,{value:ce.data.merchant,onChange:e=>le({...ce,data:{...ce.data,merchant:e.target.value}}),style:{width:"100%"}}))),l||n.a.createElement("div",{className:"Merchandise column"},n.a.createElement("span",null,"Merchandise"),n.a.createElement("div",null,n.a.createElement(v.a,{value:ce.data.merchandise,onChange:e=>le({...ce,data:{...ce.data,merchandise:e.target.value}}),style:{width:"100%"}}))),n.a.createElement("div",{className:"Tags column"},n.a.createElement("span",null,"Tags"),n.a.createElement("div",null,Object(g.map)(ce.data.tags,e=>n.a.createElement(W.a,{key:e,closable:!0,onClose:()=>le({...ce,data:{...ce.data,tags:Object(g.filter)(ce.data.tags,t=>t!==e)}}),visible:!0}," ",e," ")),ce.tagsAdding||n.a.createElement(W.a,{onClick:()=>le({...ce,tagsSearch:"",tagsAdding:!0}),style:{background:"#fff",borderStyle:"dashed"}},n.a.createElement(X.a,null)),ce.tagsAdding&&n.a.createElement(H.a,{size:"small",ref:e=>{He=e},dataSource:[...""===ce.tagsSearch?[]:[ce.tagsSearch],...A],style:{width:250},onSelect:e=>le({...ce,data:{...ce.data,tags:[...ce.data.tags,...""!==e&&-1===ce.data.tags.indexOf(e)?[e]:[]]},tagsAdding:!1}),onSearch:e=>le({...ce,tagsSearch:e}),onBlur:()=>le({...ce,tagsSearch:"",tagsAdding:!1}),defaultOpen:!0}))),n.a.createElement("div",{className:"buttons"},n.a.createElement(r.a,{type:"primary",style:{width:"100%"},disabled:ce.deleting,loading:ce.updating,onClick:()=>{le({...ce,updating:!0});const e={ExpressionAttributeNames:{"#TP":"type","#CA":"category","#AM":"amount","#TG":"tags"},ExpressionAttributeValues:{":type":{S:ce.data.type},":category":{S:ce.data.category},":amount":{N:"".concat(ce.data.amount)},":tags":{SS:[...ce.data.tags," "]}},Key:{partition:{S:d},timestamp:{N:"".concat(ce.timestamp)}},ReturnValues:"ALL_NEW",TableName:"BillingV3",UpdateExpression:"SET #TP = :type, #CA = :category, #AM = :amount, #DE = :details, #TG = :tags"};l?(e.ExpressionAttributeNames["#DE"]="details",e.ExpressionAttributeValues[":details"]={S:""===ce.data.details?" ":ce.data.details}):(e.ExpressionAttributeNames["#MCT"]="merchant",e.ExpressionAttributeNames["#MCD"]="merchandise",e.ExpressionAttributeValues[":merchant"]={S:""===ce.data.merchant?" ":ce.data.merchant},e.ExpressionAttributeValues[":merchandise"]={S:""===ce.data.merchandise?" ":ce.data.merchandise},e.UpdateExpression="SET #TP = :type, #CA = :category, #AM = :amount, #MCT = :merchant, #MCD = :merchandise, #TG = :tags"),_().updateItem(e,e=>{e?(console.log(e,e.stack),j.a.error({message:"Update Failed!",description:"".concat(e.message||e),duration:0}),le({...ce,updating:!1})):(j.a.success({message:"Item Updated!"}),le({...ce,timestamp:-1,updating:!1}),oe(i()().unix()))})}},"Update Item"),n.a.createElement(r.a,{danger:!0,style:{width:"100%"},disabled:ce.updating,loading:ce.deleting,onClick:()=>{le({...ce,deleting:!0});const e={Key:{partition:{S:d},timestamp:{N:"".concat(ce.timestamp)}},TableName:"BillingV3"};_().deleteItem(e,e=>{e?(console.log(e,e.stack),j.a.error({message:"Delete Failed!",description:"".concat(e.message||e),duration:0}),le({...ce,deleting:!1})):(j.a.success({message:"Item Deleted!"}),le({...ce,timestamp:-1,deleting:!1}),oe(i()().unix()))})}},"Delete Item"))))}))},le=a(298),re=a.n(le);a(1401);const{CheckableTag:oe}=W.a,ie=i()("20150501","YYYYMMDD"),me=["Special","Fixed","Exclude"],de=["Normal",...me];var ue=e=>{const[t,a]=Object(s.useState)(window.innerWidth),[c,l]=Object(s.useState)({status:"START",list:[]}),[r,o]=Object(s.useState)({status:"START",list:[]}),[m,d]=Object(s.useState)(de),{loginState:{isAdmin:u}}=p(),{goBack:E}=e,h=ie,y=i()(),O=[],N=[];let S;for(S=i()(1e3*h.unix());S<y.endOf("month");S=S.add(1,"month"))O.push(i()(1e3*S.unix())),N.push(S.format("YYYY-MM"));Object(s.useEffect)(()=>{Object(g.each)([!0,!1],e=>{const t=e?"Incomes":"Expenses",a=e?l:o,s=e?c:r;a({...s,status:"LOADING"});const n=h.unix(),i=y.unix(),m=(i-n)/3456e4+1,d=Object(g.times)(m,e=>1===m?[n,i]:0===e?[n,n+3456e4]:e===m-1?[n+3456e4*e+1,i]:[n+3456e4*e+1,n+3456e4*(e+1)]);Promise.all(Object(g.map)(d,a=>new Promise((s,n)=>{const c={ExpressionAttributeNames:{"#P":"partition","#TS":"timestamp"},ExpressionAttributeValues:{":partition":{S:t},":t1":{N:"".concat(a[0])},":t2":{N:"".concat(a[1])}},KeyConditionExpression:"#P = :partition AND #TS BETWEEN :t1 AND :t2",TableName:"BillingV3"};_().query(c,(t,a)=>{if(t)return void n(t);const c=Object(g.map)(a.Items,t=>e?{timestamp:parseInt(t.timestamp.N,10),type:t.type.S,amount:parseFloat(t.amount.N),category:t.category.S,details:t.details?t.details.S:"",tags:Object(g.filter)(t.tags?t.tags.SS:[],e=>""!==e&&" "!==e)}:{timestamp:parseInt(t.timestamp.N,10),type:t.type.S,amount:parseFloat(t.amount.N),category:t.category.S,merchant:t.merchant.S,merchandise:t.merchandise.S,tags:Object(g.filter)(t.tags?t.tags.SS:[],e=>""!==e&&" "!==e)});Object(g.each)(c,e=>{e.tags.includes("100x")&&u&&(e.amount*=100)}),s(c)})}))).then(e=>{const t=Object(g.reduce)(e,(e,t)=>Object(g.concat)(e,t),[]);a({status:"SUCCESS",list:t})}).catch(e=>{console.log(e,e.stack),j.a.error({message:"Query Failed!",description:"".concat(e.message||e),duration:0}),a({...s,status:"FAILED"})})})},[]);const Y=[];if(c.list.length>0){const e={};Object(g.each)(b,t=>{e[t]={}}),Object(g.each)(c.list,t=>{const a=i()(1e3*t.timestamp).format("YYYY-MM");e[t.type][a]=e[t.type][a]?e[t.type][a]+t.amount:t.amount}),Object(g.each)(b,t=>{Y[t]=Object(g.map)(O,a=>e[t][a.format("YYYY-MM")]||0)})}const T=[];if(r.list.length>0){const e={};Object(g.each)(f,t=>{e[t]={}}),Object(g.each)(r.list,t=>{const a=i()(1e3*t.timestamp).format("YYYY-MM");(Object(g.intersection)(m,me,t.tags).length>0||0===Object(g.intersection)(me,t.tags).length&&m.includes("Normal"))&&(e[t.type][a]=e[t.type][a]?e[t.type][a]+t.amount:t.amount)}),Object(g.each)(f,t=>{T[t]=Object(g.map)(O,a=>e[t][a.format("YYYY-MM")]||0)})}const A=Object(g.throttle)(()=>{a(window.innerWidth)},500,{leading:!1});Object(s.useEffect)(()=>(window.addEventListener("resize",A),()=>{window.removeEventListener("resize",A)}),[]);const D=(e,t)=>'<span style="width:150px;display:inline-block;"> <span>'.concat(e,':</span><span style="float:right;">').concat(t.toFixed(2),"</span></span>"),C=t<768,v=(e,a,s)=>({title:{text:e?"Incomes":"Expenses",textStyle:{fontFamily:'"Open Sans", Helvetica, Arial, sans-serif',fontSize:20,color:"#FFF"}},textStyle:{color:"#FFF"},color:["#ef5350","#ec407a","#ab47bc","#5c6bc0","#03a9f4","#26a69a","#8bc34a","#ffca28","#ff5722","#6e7074"],tooltip:{trigger:"axis",formatter:e=>{let t=0;const a=Object(g.join)(Object(g.map)(e,e=>(t+=e.data,D(e.seriesName,e.data))),"<br />");return"".concat(!!e[0]&&e[0].axisValueLabel,"<br />").concat(a,"<br />").concat(D("\u5171\u8ba1",t))},axisPointer:{type:"shadow"},position:(e,t,a,s,n)=>{const c={top:120};return c[["left","right"][+(e[0]<n.viewSize[0]/2)]]=5,c},padding:[10,15],backgroundColor:"rgba(50,50,50,0.9)",textStyle:{fontFamily:'Menlo, Monaco, "Courier New", monospace, "Open Sans", Helvetica, Arial, sans-serif'}},legend:{bottom:0,itemGap:20,itemWidth:30,itemHeight:16,textStyle:{color:"#FFF",fontSize:16},selected:{"\u501f\u8d37":!1,"\u5a31\u4e50":!1,Invest:!1,Others:!1},data:a},grid:{top:50,left:10,right:10,bottom:C?e?50:110:50,containLabel:!0},dataZoom:[{type:"inside",start:C?100-t/30/O.length*100:0,end:100}],xAxis:[{type:"category",axisLine:{lineStyle:{color:"#ccc"}},data:N}],yAxis:[{type:"value",minInterval:1e3,axisLabel:{formatter:e=>"".concat(e/1e3,"k")},axisLine:{lineStyle:{color:"#ccc"}},splitLine:{lineStyle:{color:"#444"}}}],series:Object(g.map)(a,e=>({name:e,type:"bar",barMaxWidth:50,data:s[e],stack:"ALL"}))});return n.a.createElement("div",{className:"reports-container"},n.a.createElement(z.a,{onBack:()=>E&&E(),title:"Reports"}),n.a.createElement(re.a,{className:"reports incomes",option:v(!0,b,Y),style:{height:400}}),n.a.createElement(re.a,{className:"reports expenses",option:v(!1,f,T),style:{height:400}}),n.a.createElement("div",{className:"special-tags-selector multiple-selector-primary"},n.a.createElement("span",null,Object(g.map)(de,e=>n.a.createElement(oe,{key:e,checked:m.includes(e),onChange:()=>{d(Object(g.xor)(m,[e]))}},e)))))};a(1402);const{TextArea:pe}=v.a,ge="NOT_STARTED",Ee="RUNNING",he="COMPLETED",ye="FAILED";var be=e=>{const[t,a]=Object(s.useState)({partition:"Incomes",data:""}),[c,l]=Object(s.useState)({status:ge,total:0,processed:0}),{goBack:o}=e,{partition:i,data:m}=t,{status:d,total:u,processed:p}=c;return n.a.createElement("div",{className:"data-import-container"},n.a.createElement(z.a,{onBack:()=>o&&o(),title:"Data Import"}),n.a.createElement(F.a.Group,{onChange:e=>{a({...t,partition:e.target.value})},value:i,buttonStyle:"solid",size:"large",className:"partition-selector"},n.a.createElement(F.a.Button,{value:"Incomes"},"Incomes"),n.a.createElement(F.a.Button,{value:"Expenses"},"Expenses")),n.a.createElement("div",{className:"input-message"},"Incomes"===i&&"timestamp \\t type \\t category \\t amount \\t details \\t tag1 tag2...","Expenses"===i&&"timestamp \\t type \\t category \\t amount \\t merchant \\t merchandise \\t tag1 tag2..."),n.a.createElement(pe,{autoSize:{minRows:5,maxRows:12},value:t.data,className:"data-input",onChange:e=>{a({...t,data:e.target.value})}}),n.a.createElement("div",{className:"buttons"},n.a.createElement(r.a,{type:"primary",style:{width:"100%"},loading:d===Ee,size:"large",onClick:()=>{const e=Object(g.filter)(m.split("\n"),e=>""!==e);let t=!1,a=0;const s=Object(g.filter)(Object(g.map)(e,e=>{if(t)return;const[s,n,c,l,r,o,m,d]=Object(g.map)(e.split("\t"),e=>e.trim()),u=r,p=r,E=o;let h=o,b=m,O=y;"Expenses"===i&&(h=m,b=d,O=Y);const N=!!b||""===b;if(N||!h&&""!==h)return j.a.error({message:"Import Failed (".concat(N?"more":"less"," fields in the input)!"),description:"It seems there are ".concat(N?"more":"less"," fields in the input. Please select corect partition to import data."),duration:0}),void(t=!0);if(""===s&&""===n&&""===c&&""===l)return void a++;const S=parseFloat(l);if(0===S)return void a++;if(isNaN(S))return j.a.error({message:"Import Failed (0 or NaN of amount in the input)!",description:"It seems there is NaN of amount in the input(timestamp: ".concat(s,", amount: ").concat(l,"). Please fix that before doing another import."),duration:0}),void(t=!0);if(!O[n]||!O[n].includes(c))return j.a.error({message:"Import Failed (Wrong type/category in the input)!",description:"It seems there is wrong type(".concat(n,")/category(").concat(c,") in the input. Please fix that before doing another import."),duration:0}),void(t=!0);const f=Object(g.filter)(h.split(" "),e=>""!==e);return"Incomes"===i?[s,n,c,l,u,f]:[s,n,c,l,p,E,f]}),e=>!!e);if(t)return void l({status:ye,total:e.length,processed:0});a>0&&j.a.info({message:"Item(s) removed!",description:"There are ".concat(a," item(s) of total(").concat(e.length,") removed from the input due to 0.00 of amount or empty line."),duration:0});const n=[],c={};if(Object(g.each)(s,e=>{c[e[0]]?n.push(e[0]):c[e[0]]=!0}),n.length>0&&(j.a.error({message:"Import Failed (Duplicated Timestamps in the input)!",description:"It seems there are duplicated timestamps in the input: ".concat(n.join(", "),"). Please fix that before doing another import."),duration:0}),t=!0),t)return void l({status:ye,total:s.length,processed:0});const r=s.length;if(0===r)return void l({status:he,total:s.length,processed:0});l({status:Ee,total:s.length,processed:0});let o=0;const d=()=>{const e=o+25>r?r:o+25,a={RequestItems:{BillingV3:"Incomes"===i?Object(g.map)(Object(g.slice)(s,o,e),e=>{const[t,a,s,n,c,l]=e;return{PutRequest:{Item:{partition:{S:"Incomes"},timestamp:{N:t},type:{S:a},category:{S:s},amount:{N:n},details:{S:""===c?" ":c},tags:{SS:[...l," "]}}}}}):Object(g.map)(Object(g.slice)(s,o,e),e=>{const[t,a,s,n,c,l,r]=e;return{PutRequest:{Item:{partition:{S:"Expenses"},timestamp:{N:t},type:{S:a},category:{S:s},amount:{N:n},merchant:{S:""===c?" ":c},merchandise:{S:""===l?" ":l},tags:{SS:[...r," "]}}}}})},ReturnConsumedCapacity:"TOTAL"};t?l({status:ye,total:s.length,processed:e}):_().batchWriteItem(a,t=>{if(t)console.log(t,t.stack),j.a.error({message:"Import Failed (".concat(o," -> ").concat(e,")!"),description:"".concat(t.message||t),duration:0}),l({status:ye,total:s.length,processed:e});else{if(e===r)return void l({status:he,total:s.length,processed:e});l({status:Ee,total:s.length,processed:e}),o=e,d()}})};d()}},"Import Items"),n.a.createElement("div",{className:"status-message"},d===Ee&&"Processing: ".concat(p," of ").concat(u,"..."),d===he&&"Completed!",d===ye&&"Failed!")))};a(1403);var Oe=()=>n.a.createElement(u,null,n.a.createElement(A,null));l.a.render(n.a.createElement(Oe,null),document.getElementById("root"))},237:function(e,t){},245:function(e,t){},482:function(e,t,a){e.exports=a(1404)},487:function(e,t,a){},492:function(e,t,a){},509:function(e,t,a){},510:function(e,t,a){}},[[482,1,2]]]);
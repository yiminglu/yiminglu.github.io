(this["webpackJsonpbilling-web-ts"]=this["webpackJsonpbilling-web-ts"]||[]).push([[0],{134:function(e,a){},232:function(e,a,t){e.exports=t(741)},237:function(e,a,t){},242:function(e,a,t){},289:function(e,a,t){},290:function(e,a,t){},686:function(e,a,t){},711:function(e,a,t){},738:function(e,a,t){},739:function(e,a,t){},740:function(e,a,t){},741:function(e,a,t){"use strict";t.r(a);var n=t(0),c=t.n(n),s=t(15),r=t.n(s),l=(t(237),t(64),t(27)),i=t(26),o=(t(239),t(6)),m=t.n(o),u=t(218);var d=Object(u.a)((function(){var e=Object(n.useState)({success:!1}),a=Object(i.a)(e,2),t=a[0],c=a[1];return{loginState:t,loginSuccess:function(){return c({success:!0})}}})),g=d.Provider,p=d.useContainer;t(242);m.a.tz.setDefault("Asia/Shanghai");var E,b,y=function(){var e=Object(n.useState)("MAIN_PAGE"),a=Object(i.a)(e,2),t=a[0],s=a[1],r=p().loginState.success;return c.a.createElement("div",{className:"App"},c.a.createElement(O,null),c.a.createElement("div",{className:"content-wrapper"},!r&&c.a.createElement(T,null),r&&"MAIN_PAGE"===t&&c.a.createElement("div",{className:"page-select-area"},c.a.createElement("div",{className:"main-title"},"Welcome!"),c.a.createElement(l.a,{className:"button incomes",type:"primary",onClick:function(){s("INCOMES_PAGE")}},"Incomes"),c.a.createElement(l.a,{className:"button expenses",type:"primary",onClick:function(){s("EXPENSES_PAGE")}},"Expenses"),c.a.createElement(l.a,{className:"button investment",type:"primary",onClick:function(){s("INVESTMENT_PAGE")},disabled:!0},"Investment (TBD)"),c.a.createElement(l.a,{className:"button data-import",type:"primary",onClick:function(){s("DATA_IMPORT_PAGE")}},"Data Import"),c.a.createElement(l.a,{className:"button logout",onClick:function(){document.location.reload()}},"Log Out")),r&&"INCOMES_PAGE"===t&&c.a.createElement(H,{goBack:function(){s("MAIN_PAGE")}}),r&&"EXPENSES_PAGE"===t&&c.a.createElement(se,{goBack:function(){s("MAIN_PAGE")}}),r&&"INVESTMENT_PAGE"===t&&c.a.createElement("div",null,"TBD"),r&&"DATA_IMPORT_PAGE"===t&&c.a.createElement(de,{goBack:function(){s("MAIN_PAGE")}})),c.a.createElement(f,null))},O=(t(289),function(){return c.a.createElement("header",{id:"header"},c.a.createElement("a",{className:"site-logo",href:"/"},c.a.createElement("img",{src:"/images/logo/SR-oneline.png",alt:"SeasonsRoad"})))}),f=(t(290),function(){return c.a.createElement("footer",{id:"footer"},c.a.createElement("div",{className:"wrapper"},c.a.createElement("div",{className:"left"},c.a.createElement("span",{className:"item"},c.a.createElement("a",{href:"https://github.com/yiminglu"},c.a.createElement("span",{className:"icon icon--github","aria-hidden":"true"},c.a.createElement("svg",{viewBox:"0 0 16 16"},c.a.createElement("path",{fill:"#828282",d:"M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"}))),c.a.createElement("span",{className:"username"},"yiminglu")))),c.a.createElement("div",{className:"right"},c.a.createElement("span",{className:"item"},"\xa9 SeasonsRoad"))))}),h=(t(75),t(32)),j=(t(98),t(22)),N=t(5),v=t(86),S=t(92),C=t.n(S),A=(t(686),function(){return b});v.b.configure({Auth:{identityPoolId:"us-west-2:70fc8736-5e86-47f3-ab1b-f05b0d93fa2e",region:"us-west-2",userPoolId:"us-west-2_ErwhI1bKS",userPoolWebClientId:"sq9tv2htpaluv4buido7l9eiu",mandatorySignIn:!1,authenticationFlowType:"USER_PASSWORD_AUTH"}});var T=function(){var e=Object(n.useState)({username:"",password:"",status:"NOT_READY"}),a=Object(i.a)(e,2),t=a[0],s=a[1],r=Object(n.useState)({newPassword:"",newPasswordConfirm:"",rstatus:"NOT_READY"}),o=Object(i.a)(r,2),m=o[0],u=o[1],d=t.username,g=t.password,y=t.status,O=m.newPassword,f=m.newPasswordConfirm,S=m.rstatus,A=p().loginSuccess,T=function(){v.a.currentCredentials().then((function(e){C.a.config.update({region:"us-west-2"}),b=new C.a.DynamoDB({apiVersion:"2012-08-10",credentials:v.a.essentialCredentials(e)}),A()}))},w=function(){"READY"===y&&(s(Object(N.a)({},t,{status:"LOADING"})),v.a.signIn({username:d,password:g}).then((function(e){E=e,"NEW_PASSWORD_REQUIRED"===e.challengeName?(j.a.warning({message:"New Password Required!",description:"Welcome, ".concat(e.username,"! You need to set up your new password so that we could begin.")}),s(Object(N.a)({},t,{status:"RESET"}))):"SMS_MFA"!==e.challengeName&&"SOFTWARE_TOKEN_MFA"!==e.challengeName&&"MFA_SETUP"!==e.challengeName?(j.a.success({message:"Login Success!",description:"Welcome back, ".concat(e.username,"!"),duration:3}),T(),s(Object(N.a)({},t,{status:"READY"}))):j.a.warning({message:"Unhandled User status!",description:"Please contact your admin."})})).catch((function(e){j.a.error({message:"Login Failed!",description:""+(e.message||e)}),s(Object(N.a)({},t,{status:"FAILED"}))})))},D=function(){E&&"NEW_PASSWORD_REQUIRED"===E.challengeName&&v.a.completeNewPassword(E,O,{}).then((function(e){E=e,"SMS_MFA"!==e.challengeName&&"SOFTWARE_TOKEN_MFA"!==e.challengeName&&"MFA_SETUP"!==e.challengeName?(j.a.success({message:"Login Success!",description:"Welcome back, ".concat(e.username,"!"),duration:3}),T(),s(Object(N.a)({},t,{status:"READY"}))):j.a.warning({message:"Unhandled User status!",description:"Please contact your admin."})})).catch((function(e){j.a.error({message:"Reset Failed!",description:""+(e.message||e)}),u(Object(N.a)({},m,{rstatus:"FAILED"}))}))};return c.a.createElement("div",{className:"login-container"},c.a.createElement("div",{className:"login-title"},"RESET"!==y?"Billing System":"Reset Password"),"RESET"!==y&&c.a.createElement(h.a,{className:"username-input".concat("FAILED"===y?" error":""),size:"large",onChange:function(e){var a=e.target.value;s(""!==a&&""!==g?Object(N.a)({},t,{username:a,status:"READY"}):Object(N.a)({},t,{username:a,status:"NOT_READY"}))},onPressEnter:w,placeholder:"Input User Name"}),"RESET"!==y&&c.a.createElement(h.a.Password,{className:"password-input".concat("FAILED"===y?" error":""),size:"large",onChange:function(e){var a=e.target.value;s(""!==d&&""!==a?Object(N.a)({},t,{password:a,status:"READY"}):Object(N.a)({},t,{password:a,status:"NOT_READY"}))},onPressEnter:w,placeholder:"Input Password"}),"RESET"!==y&&c.a.createElement(l.a,{className:"login-button",size:"large",type:"primary",disabled:"NOT_READY"===y,loading:"LOADING"===y,onClick:w},"Login"),"RESET"===y&&c.a.createElement(h.a.Password,{className:"password-reset-input",size:"large",onChange:function(e){var a=e.target.value;u(a===f?Object(N.a)({},m,{newPassword:a,rstatus:"READY"}):Object(N.a)({},m,{newPassword:a,rstatus:"NOT_READY"}))},onPressEnter:D,placeholder:"Input New Password"}),"RESET"===y&&c.a.createElement(h.a.Password,{className:"password-reset-confirm-input",size:"large",onChange:function(e){var a=e.target.value;u(O===a?Object(N.a)({},m,{newPasswordConfirm:a,rstatus:"READY"}):Object(N.a)({},m,{newPasswordConfirm:a,rstatus:"NOT_READY"}))},onPressEnter:D,placeholder:"Confirm New Password"}),"RESET"===y&&c.a.createElement(l.a,{className:"reset-button",size:"large",type:"primary",disabled:"NOT_READY"===S,loading:"LOADING"===S,onClick:D},"Reset"))},w=(t(216),t(82)),D=(t(205),t(83)),I=(t(206),t(85)),x=(t(207),t(84)),k=(t(208),t(14)),M=t(29),Y=(t(137),t(30)),P=(t(140),t(80)),R=(t(101),t(35)),_=(t(138),t(36)),F=(t(217),t(62)),B=t(8),G=(t(711),F.a.RangePicker),L=_.a.CheckableTag,W=R.a.Option,U=["Exclude","Qinghuan","Gift"],z={},q=Object(B.map)([{type:"Ming",categories:["\u6708\u5de5\u8d44","\u5e74\u7ec8\u5956","\u533b\u4fdd\u5b58\u6298","\u4f4f\u623f\u516c\u79ef\u91d1","\u5176\u4ed6\u85aa\u8d44"]},{type:"Hehe",categories:["\u6708\u5de5\u8d44","\u5e74\u7ec8\u5956","\u5e74\u4e2d\u5956","\u5b63\u5ea6\u5956","\u5e74\u5047\u5956\u91d1","\u533b\u4fdd\u5b58\u6298","\u4f4f\u623f\u516c\u79ef\u91d1","\u589e\u53d1\u7ee9\u6548\u5956","\u62a5\u9500\u4ea4\u901a\u8d39","\u9632\u6691\u964d\u6e29\u8d39","\u62a5\u9500\u7269\u4e1a\u8d39","\u62a5\u9500\u53d6\u6696\u8d39","\u8282\u5047\u65e5\u8865\u52a9","\u751f\u80b2\u6d25\u8d34","\u5176\u4ed6\u85aa\u8d44"]},{type:"Invest",categories:["\u8d27\u5e01\u57fa\u91d1","\u6307\u6570\u57fa\u91d1","\u51fa\u501f\u5229\u606f","\u6570\u5b57\u8d27\u5e01","\u80a1\u7968","P2P"]},{type:"Others",categories:["\u8f6c\u5356\u4e8c\u624b","ME\u7238\u5988","HJ\u7238\u5988","ME\u4eb2\u621a","HJ\u4eb2\u621a","ME\u53cb\u4eba","HJ\u53cb\u4eba"]}],(function(e){return z[e.type]=e.categories,e.type})),V=m()().subtract(30,"days").startOf("day"),J=m()().endOf("day"),K=function(e){return Boolean(e&&e>m()().endOf("day"))},H=function(e){var a=Object(n.useState)({type:"Ming",start:V,end:J,selectedCategories:[],selectedTag:""}),t=Object(i.a)(a,2),s=t[0],r=t[1],o=Object(n.useState)({status:"START",list:[],categories:[],tags:[]}),u=Object(i.a)(o,2),d=u[0],g=u[1],p=Object(n.useState)({type:"Ming",timestamp:-1,creating:!1,updating:!1,deleting:!1,tagsSearch:"",tagsAdding:!1,data:{type:"",timestamp:0,amount:0,category:"",details:"",tags:[]}}),E=Object(i.a)(p,2),b=E[0],y=E[1],O=Object(n.useState)(m()().unix()),f=Object(i.a)(O,2),v=f[0],S=f[1],C=s.type,T=s.start,H=s.end,Q=s.selectedCategories,X=s.selectedTag;Object(n.useEffect)((function(){var e={ExpressionAttributeNames:{"#T":"type","#TS":"timestamp"},ExpressionAttributeValues:{":type":{S:C},":t1":{N:T.unix()+""},":t2":{N:H.unix()+""}},KeyConditionExpression:"#T = :type AND #TS BETWEEN :t1 AND :t2",TableName:"Incomes"};g(Object(N.a)({},d,{status:"LOADING"})),A().query(e,(function(e,a){if(e)console.log(e,e.stack),j.a.error({message:"Query Failed!",description:""+(e.message||e),duration:0}),g(Object(N.a)({},d,{status:"FAILED"}));else{var t=Object(B.map)(a.Items,(function(e){return{timestamp:parseInt(e.timestamp.N,10),type:e.type.S,amount:parseFloat(e.amount.N),category:e.category.S,details:e.details?e.details.S:"",tags:Object(B.filter)(e.tags?e.tags.SS:[],(function(e){return""!==e&&" "!==e}))}})),n={},c={};Object(B.each)(t,(function(e){n[e.category]=n[e.category]?n[e.category]+1:1,e.tags&&Object(B.each)(e.tags,(function(e){return c[e]=c[e]?c[e]+1:1}))}));var l=Object(B.sortBy)(Object(B.map)(n,(function(e,a){return{category:a,count:e}})),"count").reverse(),i=Object(B.sortBy)(Object(B.map)(c,(function(e,a){return{tag:a,count:e}})),"count").reverse();g({status:"SUCCESS",list:t,categories:l,tags:i}),r(Object(N.a)({},s,{selectedCategories:Object(B.map)(l,(function(e){return e.category})),selectedTag:""}))}}))}),[C,T,H,v]);var Z=Object(B.filter)(d.list,(function(e){return Q.includes(e.category)&&(""===X||e.tags&&e.tags.includes(X))})),$=Z.length,ee=0,ae=0,te=0;Object(B.each)(Z,(function(e){ee+=e.amount,e.tags.includes("Exclude")&&(ae+=1,te+=e.amount)}));var ne;return Object(n.useEffect)((function(){b.tagsAdding&&ne.focus()}),[b.tagsAdding]),c.a.createElement("div",{className:"incomes-container"},c.a.createElement(P.a,{onBack:function(){e.goBack()},title:"Incomes"}),c.a.createElement(Y.a.Group,{onChange:function(e){r(Object(N.a)({},s,{type:e.target.value}))},defaultValue:"Ming",buttonStyle:"solid",size:"large",className:"type-selector"},Object(B.map)(q,(function(e){return c.a.createElement(Y.a.Button,{key:e,value:e},e)}))),c.a.createElement(G,{ranges:{"This Fiscal Year":[m()("".concat(m()().year()-(m()().month()<4?1:0),"0501"),"YYYYMMDD"),m()("".concat(m()().year()+(m()().month()<4?0:1),"0401"),"YYYYMMDD").endOf("month")],"Last Fiscal Year":[m()("".concat(m()().year()-(m()().month()<4?2:1),"0501"),"YYYYMMDD"),m()("".concat(m()().year()-(m()().month()<4?1:0),"0401"),"YYYYMMDD").endOf("month")],"Last 365 Days":[m()().subtract(365,"days").startOf("day"),m()().endOf("day")],"This Year":[m()().startOf("year"),m()().endOf("year")],"Last Year":[m()().subtract(1,"year").startOf("year"),m()().subtract(1,"year").endOf("year")]},defaultValue:[V,J],disabledDate:K,onChange:function(e){r(Object(N.a)({},s,{start:Object(B.get)(e,"0"),end:Object(B.get)(e,"1")}))},allowClear:!1,size:"large"}),c.a.createElement("div",{className:"categories-selector"},Object(B.map)(d.categories,(function(e){return c.a.createElement(L,{key:e.category,checked:Object(B.includes)(Q,e.category),onChange:function(a){r(a?Object(N.a)({},s,{selectedCategories:[].concat(Object(M.a)(Q),[e.category])}):Object(N.a)({},s,{selectedCategories:Object(B.filter)(Q,(function(a){return a!==e.category}))}))}},e.category," (",e.count,")")}))),c.a.createElement("div",{className:"tags-selector"},Object(B.map)(d.tags,(function(e){return c.a.createElement(L,{key:e.tag,checked:X===e.tag,onChange:function(a){r(a?Object(N.a)({},s,{selectedTag:e.tag}):Object(N.a)({},s,{selectedTag:""}))}},e.tag," (",e.count,")")}))),c.a.createElement(w.a,{className:"income-list",header:c.a.createElement("div",{className:"item header"},c.a.createElement("span",{className:"date"},"Date"),c.a.createElement("span",{className:"type"},"Type"),c.a.createElement("span",{className:"amount"},"Amount"),c.a.createElement("span",{className:"category"},"Category"),c.a.createElement("span",{className:"details"},"Details"),c.a.createElement("span",{className:"tags"},"Tags")),footer:c.a.createElement("div",{className:"income-list-footer"},c.a.createElement(k.a,{className:"add-new",type:"plus",onClick:function(){y(Object(N.a)({},b,{timestamp:-1/0,data:{type:"Ming",timestamp:m()().startOf("day").unix(),amount:0,category:"\u6708\u5de5\u8d44",details:"",tags:[]}}))}}),c.a.createElement("div",null,$>0&&c.a.createElement("div",null,"Count: ",c.a.createElement("span",{className:"number"},$),ae>0&&c.a.createElement("span",{className:"minus"},"\xa0(-",ae,")"),ae>0&&c.a.createElement("span",{className:"equals"},$-ae)),$>0&&c.a.createElement("div",null,"Average: ",c.a.createElement("span",{className:"number"},"\uffe5",(ee/$).toFixed(2)),ae>0&&c.a.createElement("span",{className:"minus"}),ae>0&&c.a.createElement("span",{className:"equals"},"\uffe5",((ee-te)/($-ae)).toFixed(2))),c.a.createElement("div",null,"Total: ",c.a.createElement("span",{className:"number"},"\uffe5",ee.toFixed(2)),ae>0&&c.a.createElement("span",{className:"minus"},"\xa0(-",te.toFixed(0),")"),ae>0&&c.a.createElement("span",{className:"equals"},"\uffe5",(ee-te).toFixed(2)))),c.a.createElement(D.a,{title:"Create Income Item",placement:"right",closable:!0,destroyOnClose:!0,width:300,className:"income-create-drawer",onClose:function(){return y(Object(N.a)({},b,{timestamp:-1}))},visible:b.timestamp===-1/0},c.a.createElement("div",{className:"DateTime column"},c.a.createElement("span",null,"DateTime"),c.a.createElement("div",null,c.a.createElement(F.a,{allowClear:!1,showTime:!0,value:m.a.unix(b.data.timestamp),onChange:function(e){return y(Object(N.a)({},b,{data:Object(N.a)({},b.data,{timestamp:e?e.unix():m()().startOf("day").unix()})}))},style:{width:"100%"}}))),c.a.createElement("div",{className:"Type column"},c.a.createElement("span",null,"Type"),c.a.createElement("div",null,c.a.createElement(Y.a.Group,{value:b.data.type,onChange:function(e){return y(Object(N.a)({},b,{data:Object(N.a)({},b.data,{type:e.target.value,category:z[e.target.value][0]})}))},buttonStyle:"solid",className:"type-selector"},Object(B.map)(q,(function(e){return c.a.createElement(Y.a.Button,{key:e,value:e},e)}))))),c.a.createElement("div",{className:"Amount column"},c.a.createElement("span",null,"Amount"),c.a.createElement("div",null,c.a.createElement(x.a,{value:b.data.amount,onChange:function(e){return y(Object(N.a)({},b,{data:Object(N.a)({},b.data,{amount:e||0})}))},min:0,step:1e3,precision:2,style:{width:"100%"}}))),c.a.createElement("div",{className:"Category column"},c.a.createElement("span",null,"Category"),c.a.createElement("div",null,c.a.createElement(R.a,{value:b.data.category,onChange:function(e){return y(Object(N.a)({},b,{data:Object(N.a)({},b.data,{category:e})}))},style:{width:"100%"}},Object(B.map)(z[b.data.type],(function(e){return c.a.createElement(W,{key:e,value:e},e)}))))),c.a.createElement("div",{className:"Details column"},c.a.createElement("span",null,"Details"),c.a.createElement("div",null,c.a.createElement(h.a,{value:b.data.details,onChange:function(e){return y(Object(N.a)({},b,{data:Object(N.a)({},b.data,{details:e.target.value})}))},style:{width:"100%"}}))),c.a.createElement("div",{className:"Tags column"},c.a.createElement("span",null,"Tags"),c.a.createElement("div",null,Object(B.map)(b.data.tags,(function(e){return c.a.createElement(_.a,{key:e,closable:!0,onClose:function(){return y(Object(N.a)({},b,{data:Object(N.a)({},b.data,{tags:Object(B.filter)(b.data.tags,(function(a){return a!==e}))})}))},visible:!0}," ",e," ")})),b.tagsAdding||c.a.createElement(_.a,{onClick:function(){return y(Object(N.a)({},b,{tagsSearch:"",tagsAdding:!0}))},style:{background:"#fff",borderStyle:"dashed"}},c.a.createElement(k.a,{type:"plus"}),"NEW_TAG"),b.tagsAdding&&c.a.createElement(I.a,{size:"small",ref:function(e){ne=e},dataSource:[].concat(Object(M.a)(""===b.tagsSearch?[]:[b.tagsSearch]),U),style:{width:250},onSelect:function(e){return y(Object(N.a)({},b,{data:Object(N.a)({},b.data,{tags:[].concat(Object(M.a)(b.data.tags),Object(M.a)(""!==e&&-1===b.data.tags.indexOf(e)?[e]:[]))}),tagsAdding:!1}))},onSearch:function(e){return y(Object(N.a)({},b,{tagsSearch:e}))},onBlur:function(){return y(Object(N.a)({},b,{tagsSearch:"",tagsAdding:!1}))},defaultOpen:!0}))),c.a.createElement("div",{className:"buttons"},c.a.createElement(l.a,{type:"primary",style:{width:"100%"},loading:b.creating,onClick:function(){y(Object(N.a)({},b,{creating:!0}));var e={ExpressionAttributeNames:{"#TS":"timestamp"},Item:{type:{S:b.data.type},timestamp:{N:b.data.timestamp+""},amount:{N:b.data.amount+""},category:{S:b.data.category},details:{S:""===b.data.details?" ":b.data.details},":tags":{S:b.data.tags.join(" ")+" "}},ReturnConsumedCapacity:"TOTAL",TableName:"Incomes",ConditionExpression:"attribute_not_exists(#TS)"};A().putItem(e,(function(e){e?(console.log(e,e.stack),j.a.error({message:"Creation Failed!",description:(e.message||e)+("The conditional request failed"===e.message?"! We should not override exising items. Try a new timestamp.":"!"),duration:0}),y(Object(N.a)({},b,{creating:!1}))):(j.a.success({message:"Item Created!"}),y(Object(N.a)({},b,{timestamp:-1,creating:!1})),S(m()().unix()))}))}},"Create Item")))),bordered:!0,dataSource:Z,renderItem:function(e){return c.a.createElement(w.a.Item,{key:e.timestamp},c.a.createElement("div",{className:"item",onClick:function(){return y({type:e.type,timestamp:e.timestamp,creating:!1,updating:!1,deleting:!1,tagsSearch:"",tagsAdding:!1,data:Object(N.a)({},e,{details:" "===e.details?"":e.details})})}},c.a.createElement("span",{className:"date"},m.a.unix(e.timestamp).format("YYYY-MM-DD")),c.a.createElement("span",{className:"type"},e.type),c.a.createElement("span",{className:"amount"},"\uffe5".concat(e.amount.toFixed(2))),c.a.createElement("span",{className:"category"},e.category),c.a.createElement("span",{className:"details"}," "===e.details?"":e.details),c.a.createElement("span",{className:"tags"},Object(B.map)(e.tags,(function(e){return c.a.createElement(_.a,{key:e,closable:!1,visible:!0}," ",e," ")})))),c.a.createElement(D.a,{title:"Edit Income Item",placement:"right",closable:!0,destroyOnClose:!0,width:300,className:"income-edit-drawer",onClose:function(){return y(Object(N.a)({},b,{timestamp:-1}))},visible:b.timestamp===e.timestamp},c.a.createElement("div",{className:"DateTime column"},c.a.createElement("span",null,"DateTime"),c.a.createElement("div",null,c.a.createElement(F.a,{showTime:!0,value:m.a.unix(b.data.timestamp),disabled:!0,style:{width:"100%"}}))),c.a.createElement("div",{className:"Type column"},c.a.createElement("span",null,"Type"),c.a.createElement("div",null,c.a.createElement(Y.a.Group,{value:b.data.type,buttonStyle:"solid",className:"type-selector"},c.a.createElement(Y.a.Button,{value:b.data.type},b.data.type)))),c.a.createElement("div",{className:"Amount column"},c.a.createElement("span",null,"Amount"),c.a.createElement("div",null,c.a.createElement(x.a,{value:b.data.amount,onChange:function(e){return y(Object(N.a)({},b,{data:Object(N.a)({},b.data,{amount:e||0})}))},min:0,step:1e3,precision:2,style:{width:"100%"}}))),c.a.createElement("div",{className:"Category column"},c.a.createElement("span",null,"Category"),c.a.createElement("div",null,c.a.createElement(R.a,{value:b.data.category,onChange:function(e){return y(Object(N.a)({},b,{data:Object(N.a)({},b.data,{category:e})}))},style:{width:"100%"}},Object(B.map)(z[C],(function(e){return c.a.createElement(W,{key:e,value:e},e)}))))),c.a.createElement("div",{className:"Details column"},c.a.createElement("span",null,"Details"),c.a.createElement("div",null,c.a.createElement(h.a,{value:b.data.details,onChange:function(e){return y(Object(N.a)({},b,{data:Object(N.a)({},b.data,{details:e.target.value})}))},style:{width:"100%"}}))),c.a.createElement("div",{className:"Tags column"},c.a.createElement("span",null,"Tags"),c.a.createElement("div",null,Object(B.map)(b.data.tags,(function(e){return c.a.createElement(_.a,{key:e,closable:!0,onClose:function(){return y(Object(N.a)({},b,{data:Object(N.a)({},b.data,{tags:Object(B.filter)(b.data.tags,(function(a){return a!==e}))})}))},visible:!0}," ",e," ")})),b.tagsAdding||c.a.createElement(_.a,{onClick:function(){return y(Object(N.a)({},b,{tagsSearch:"",tagsAdding:!0}))},style:{background:"#fff",borderStyle:"dashed"}},c.a.createElement(k.a,{type:"plus"}),"NEW_TAG"),b.tagsAdding&&c.a.createElement(I.a,{size:"small",ref:function(e){ne=e},dataSource:[].concat(Object(M.a)(""===b.tagsSearch?[]:[b.tagsSearch]),U),style:{width:250},onSelect:function(e){return y(Object(N.a)({},b,{data:Object(N.a)({},b.data,{tags:[].concat(Object(M.a)(b.data.tags),Object(M.a)(""!==e&&-1===b.data.tags.indexOf(e)?[e]:[]))}),tagsAdding:!1}))},onSearch:function(e){return y(Object(N.a)({},b,{tagsSearch:e}))},onBlur:function(){return y(Object(N.a)({},b,{tagsSearch:"",tagsAdding:!1}))},defaultOpen:!0}))),c.a.createElement("div",{className:"buttons"},c.a.createElement(l.a,{type:"primary",style:{width:"100%"},disabled:b.deleting,loading:b.updating,onClick:function(){y(Object(N.a)({},b,{updating:!0}));var e={ExpressionAttributeNames:{"#AM":"amount","#CA":"category","#DE":"details","#TG":"tags"},ExpressionAttributeValues:{":amount":{N:b.data.amount+""},":category":{S:b.data.category},":details":{S:""===b.data.details?" ":b.data.details},":tags":{S:b.data.tags.join(" ")+" "}},Key:{type:{S:b.type},timestamp:{N:b.timestamp+""}},ReturnValues:"ALL_NEW",TableName:"Incomes",UpdateExpression:"SET #AM = :amount, #CA = :category, #DE = :details, #TG = :tags"};A().updateItem(e,(function(e){e?(console.log(e,e.stack),j.a.error({message:"Update Failed!",description:""+(e.message||e),duration:0}),y(Object(N.a)({},b,{updating:!1}))):(j.a.success({message:"Item Updated!"}),y(Object(N.a)({},b,{timestamp:-1,updating:!1})),S(m()().unix()))}))}},"Update Item"),c.a.createElement(l.a,{type:"danger",style:{width:"100%"},disabled:b.updating,loading:b.deleting,onClick:function(){y(Object(N.a)({},b,{deleting:!0}));var e={Key:{type:{S:b.type},timestamp:{N:b.timestamp+""}},TableName:"Incomes"};A().deleteItem(e,(function(e){e?(console.log(e,e.stack),j.a.error({message:"Delete Failed!",description:""+(e.message||e),duration:0}),y(Object(N.a)({},b,{deleting:!1}))):(j.a.success({message:"Item Deleted!"}),y(Object(N.a)({},b,{timestamp:-1,deleting:!1})),S(m()().unix()))}))}},"Delete Item"))))}}))},Q=(t(738),F.a.RangePicker),X=_.a.CheckableTag,Z=R.a.Option,$=["Exclude","ME\u7238\u5988","ME\u4eb2\u621a","ME\u53cb\u4eba","HJ\u7238\u5988","HJ\u4eb2\u621a","HJ\u53cb\u4eba","LJY","LSY","VPS","DNS"],ee={},ae=Object(B.map)([{type:"\u9910\u996e",categories:["\u5916\u51fa\u996e\u98df","\u95e8\u5e97\u5feb\u9910","\u5de5\u4f5c\u9910","\u70df\u9152\u8336","\u96f6\u98df\u996e\u6599","\u679c\u852c\u98df\u6750","\u9910\u996e\u5176\u4ed6"]},{type:"\u4ea4\u901a",categories:["\u6253\u8f66","\u516c\u5171\u4ea4\u901a","\u8f66\u65c5\u8d39\u7528","\u81ea\u9a7e\u52a0\u6cb9","\u81ea\u9a7e\u9ad8\u901f\u8d39","\u81ea\u9a7e\u505c\u8f66","\u81ea\u9a7e\u6d17\u8f66","\u8fdd\u7ae0\u7f5a\u6b3e","\u6c7d\u8f66\u4fdd\u517b","\u6c7d\u8f66\u4fdd\u9669","\u6c7d\u8f66\u7ef4\u4fee","\u6c7d\u8f66\u914d\u4ef6","\u4ea4\u901a\u5176\u4ed6"]},{type:"\u6e05\u6b22",categories:["\u5a03\u513f\u996e\u98df","\u5a03\u513f\u73a9\u5177","\u5a03\u513f\u56fe\u4e66","\u5a03\u513f\u978b\u670d","\u5a03\u513f\u6e38\u4e50\u573a","\u5a03\u513f\u7528\u54c1","\u5a03\u513f\u5b55\u671f","\u5a03\u513f\u5b66\u6742\u8d39","\u5a03\u513f\u5174\u8da3\u73ed","\u5a03\u513f\u8f85\u5bfc\u73ed","\u5a03\u513f\u533b\u836f","\u5a03\u513f\u5176\u4ed6"]},{type:"\u4eb2\u53cb",categories:["\u5bb6\u4eba\u652f\u51fa","\u53cb\u4eba\u652f\u51fa","\u53cb\u4eba\u57ab\u4ed8","\u4eb2\u53cb\u793c\u94b1"]},{type:"\u65e5\u5e38",categories:["\u533b\u7597\u836f\u7269","\u4fdd\u5065\u6309\u6469","\u624b\u673a\u8bdd\u8d39","\u8fd0\u52a8\u5065\u8eab","\u7f8e\u5bb9\u7f8e\u53d1","\u6625\u8282\u5f00\u9500","\u515a\u8d39","\u57ab\u4ed8\u62a5\u9500","\u5de5\u4f5c\u6742\u8d39","\u4fe1\u7528\u5361\u76f8\u5173","\u65e5\u5e38\u5176\u4ed6"]},{type:"\u4f4f\u5bbf",categories:["\u6c34\u8d39","\u7535\u8d39","\u71c3\u6c14\u8d39","\u7269\u4e1a\u8d39","\u5bb6\u7535\u5bb6\u5177","\u7f51\u8d39","\u6709\u7ebf\u7535\u89c6\u8d39","\u5bb6\u5c45\u7528\u54c1","\u5bb6\u653f\u670d\u52a1","\u623f\u79df","\u4f4f\u5bbf\u5176\u4ed6"]},{type:"\u501f\u8d37",categories:["\u6d66\u53d1\u94f6\u884c\u623f\u8d37","\u6d66\u53d1\u94f6\u884c\u6d88\u8d39\u8d37","\u5357\u4eac\u94f6\u884c\u8d37\u6b3e","\u62db\u5546\u94f6\u884c\u95ea\u7535\u8d37","\u5de5\u5546\u94f6\u884c\u8f66\u8d37","\u7406\u8d22\u5e08\u8ba1\u5212"]},{type:"\u8d2d\u7269",categories:["\u4e66\u7c4d\u8d44\u6599","\u7535\u5b503C","\u6e38\u620f\u5145\u503c","\u5e94\u7528\u670d\u52a1","\u5316\u5986\u62a4\u80a4","\u670d\u88c5\u8863\u9970","\u914d\u4ef6\u9970\u54c1","\u5305\u5305\u624b\u8868","\u6536\u85cf","\u8d2d\u5165C200L","\u8d2d\u5165\u534e\u8d38\u57ce\u623f\u5b50","\u8d2d\u7269\u5176\u4ed6"]},{type:"\u5a31\u4e50",categories:["\u6f14\u5531\u4f1a","\u8bdd\u5267","\u7535\u5f71","\u5531\u6b4c","\u6e38\u620f\u5145\u503c","\u5468\u8fb9\u5916\u51fa","\u65c5\u884c\u5f00\u9500","\u5a31\u4e50\u5176\u4ed6"]}],(function(e){return ee[e.type]=e.categories,e.type})),te=m()().subtract(30,"days").startOf("day"),ne=m()().endOf("day"),ce=function(e){return Boolean(e&&e>m()().endOf("day"))},se=function(e){var a=Object(n.useState)({type:"Ming",start:te,end:ne,selectedCategories:[],selectedTag:""}),t=Object(i.a)(a,2),s=t[0],r=t[1],o=Object(n.useState)({status:"START",list:[],categories:[],tags:[]}),u=Object(i.a)(o,2),d=u[0],g=u[1],p=Object(n.useState)({type:"Ming",timestamp:-1,creating:!1,updating:!1,deleting:!1,tagsSearch:"",tagsAdding:!1,data:{type:"",timestamp:0,amount:0,category:"",merchant:"",merchandise:"",tags:[]}}),E=Object(i.a)(p,2),b=E[0],y=E[1],O=Object(n.useState)(m()().unix()),f=Object(i.a)(O,2),v=f[0],S=f[1],C=s.type,T=s.start,G=s.end,L=s.selectedCategories,W=s.selectedTag;Object(n.useEffect)((function(){var e={ExpressionAttributeNames:{"#T":"type","#TS":"timestamp"},ExpressionAttributeValues:{":type":{S:C},":t1":{N:T.unix()+""},":t2":{N:G.unix()+""}},KeyConditionExpression:"#T = :type AND #TS BETWEEN :t1 AND :t2",TableName:"Expenses"};g(Object(N.a)({},d,{status:"LOADING"})),A().query(e,(function(e,a){if(e)console.log(e,e.stack),j.a.error({message:"Query Failed!",description:""+(e.message||e),duration:0}),g(Object(N.a)({},d,{status:"FAILED"}));else{var t=Object(B.map)(a.Items,(function(e){return{timestamp:parseInt(e.timestamp.N,10),type:e.type.S,amount:parseFloat(e.amount.N),category:e.category.S,merchant:e.merchant.S,merchandise:e.merchandise.S,tags:Object(B.filter)(e.tags?e.tags.SS:[],(function(e){return""!==e&&" "!==e}))}})),n={},c={};Object(B.each)(t,(function(e){n[e.category]=n[e.category]?n[e.category]+1:1,e.tags&&Object(B.each)(e.tags,(function(e){return c[e]=c[e]?c[e]+1:1}))}));var l=Object(B.sortBy)(Object(B.map)(n,(function(e,a){return{category:a,count:e}})),"count").reverse(),i=Object(B.sortBy)(Object(B.map)(c,(function(e,a){return{tag:a,count:e}})),"count").reverse();g({status:"SUCCESS",list:t,categories:l,tags:i}),r(Object(N.a)({},s,{selectedCategories:Object(B.map)(l,(function(e){return e.category})),selectedTag:""}))}}))}),[C,T,G,v]);var U=Object(B.filter)(d.list,(function(e){return L.includes(e.category)&&(""===W||e.tags&&e.tags.includes(W))})),z=U.length,q=0,V=0,J=0;Object(B.each)(U,(function(e){q+=e.amount,e.tags.includes("Exclude")&&(V+=1,J+=e.amount)}));var K;return Object(n.useEffect)((function(){b.tagsAdding&&K.focus()}),[b.tagsAdding]),c.a.createElement("div",{className:"expenses-container"},c.a.createElement(P.a,{onBack:function(){e.goBack()},title:"Expenses"}),c.a.createElement(Y.a.Group,{onChange:function(e){r(Object(N.a)({},s,{type:e.target.value}))},defaultValue:"Ming",buttonStyle:"solid",size:"large",className:"type-selector"},Object(B.map)(ae,(function(e){return c.a.createElement(Y.a.Button,{key:e,value:e},e)}))),c.a.createElement(Q,{ranges:{"This Fiscal Year":[m()("".concat(m()().year()-(m()().month()<4?1:0),"0501"),"YYYYMMDD"),m()("".concat(m()().year()+(m()().month()<4?0:1),"0401"),"YYYYMMDD").endOf("month")],"Last Fiscal Year":[m()("".concat(m()().year()-(m()().month()<4?2:1),"0501"),"YYYYMMDD"),m()("".concat(m()().year()-(m()().month()<4?1:0),"0401"),"YYYYMMDD").endOf("month")],"Last 365 Days":[m()().subtract(365,"days").startOf("day"),m()().endOf("day")],"This Year":[m()().startOf("year"),m()().endOf("year")],"Last Year":[m()().subtract(1,"year").startOf("year"),m()().subtract(1,"year").endOf("year")]},defaultValue:[te,ne],disabledDate:ce,onChange:function(e){r(Object(N.a)({},s,{start:Object(B.get)(e,"0"),end:Object(B.get)(e,"1")}))},allowClear:!1,size:"large"}),c.a.createElement("div",{className:"categories-selector"},Object(B.map)(d.categories,(function(e){return c.a.createElement(X,{key:e.category,checked:Object(B.includes)(L,e.category),onChange:function(a){r(a?Object(N.a)({},s,{selectedCategories:[].concat(Object(M.a)(L),[e.category])}):Object(N.a)({},s,{selectedCategories:Object(B.filter)(L,(function(a){return a!==e.category}))}))}},e.category," (",e.count,")")}))),c.a.createElement("div",{className:"tags-selector"},Object(B.map)(d.tags,(function(e){return c.a.createElement(X,{key:e.tag,checked:W===e.tag,onChange:function(a){r(a?Object(N.a)({},s,{selectedTag:e.tag}):Object(N.a)({},s,{selectedTag:""}))}},e.tag," (",e.count,")")}))),c.a.createElement(w.a,{className:"expense-list",header:c.a.createElement("div",{className:"item header"},c.a.createElement("span",{className:"date"},"Date"),c.a.createElement("span",{className:"type"},"Type"),c.a.createElement("span",{className:"amount"},"Amount"),c.a.createElement("span",{className:"category"},"Category"),c.a.createElement("span",{className:"merchant"},"Merchant"),c.a.createElement("span",{className:"merchandise"},"Merchandise"),c.a.createElement("span",{className:"tags"},"Tags")),footer:c.a.createElement("div",{className:"expense-list-footer"},c.a.createElement(k.a,{className:"add-new",type:"plus",onClick:function(){y(Object(N.a)({},b,{timestamp:-1/0,data:{type:"Ming",timestamp:m()().startOf("day").unix(),amount:0,category:"\u9910\u996e",merchant:"",merchandise:"",tags:[]}}))}}),c.a.createElement("div",null,z>0&&c.a.createElement("div",null,"Count: ",c.a.createElement("span",{className:"number"},z),V>0&&c.a.createElement("span",{className:"minus"},"\xa0(-",V,")"),V>0&&c.a.createElement("span",{className:"equals"},z-V)),z>0&&c.a.createElement("div",null,"Average: ",c.a.createElement("span",{className:"number"},"\uffe5",(q/z).toFixed(2)),V>0&&c.a.createElement("span",{className:"minus"}),V>0&&c.a.createElement("span",{className:"equals"},"\uffe5",((q-J)/(z-V)).toFixed(2))),c.a.createElement("div",null,"Total: ",c.a.createElement("span",{className:"number"},"\uffe5",q.toFixed(2)),V>0&&c.a.createElement("span",{className:"minus"},"\xa0(-",J.toFixed(0),")"),V>0&&c.a.createElement("span",{className:"equals"},"\uffe5",(q-J).toFixed(2)))),c.a.createElement(D.a,{title:"Create Expense Item",placement:"right",closable:!0,destroyOnClose:!0,width:300,className:"expense-create-drawer",onClose:function(){return y(Object(N.a)({},b,{timestamp:-1}))},visible:b.timestamp===-1/0},c.a.createElement("div",{className:"DateTime column"},c.a.createElement("span",null,"DateTime"),c.a.createElement("div",null,c.a.createElement(F.a,{allowClear:!1,showTime:!0,value:m.a.unix(b.data.timestamp),onChange:function(e){return y(Object(N.a)({},b,{data:Object(N.a)({},b.data,{timestamp:e?e.unix():m()().startOf("day").unix()})}))},style:{width:"100%"}}))),c.a.createElement("div",{className:"Type column"},c.a.createElement("span",null,"Type"),c.a.createElement("div",null,c.a.createElement(Y.a.Group,{value:b.data.type,onChange:function(e){return y(Object(N.a)({},b,{data:Object(N.a)({},b.data,{type:e.target.value,category:ee[e.target.value][0]})}))},buttonStyle:"solid",className:"type-selector"},Object(B.map)(ae,(function(e){return c.a.createElement(Y.a.Button,{key:e,value:e},e)}))))),c.a.createElement("div",{className:"Amount column"},c.a.createElement("span",null,"Amount"),c.a.createElement("div",null,c.a.createElement(x.a,{value:b.data.amount,onChange:function(e){return y(Object(N.a)({},b,{data:Object(N.a)({},b.data,{amount:e||0})}))},min:0,step:1e3,precision:2,style:{width:"100%"}}))),c.a.createElement("div",{className:"Category column"},c.a.createElement("span",null,"Category"),c.a.createElement("div",null,c.a.createElement(R.a,{value:b.data.category,onChange:function(e){return y(Object(N.a)({},b,{data:Object(N.a)({},b.data,{category:e})}))},style:{width:"100%"}},Object(B.map)(ee[b.data.type],(function(e){return c.a.createElement(Z,{key:e,value:e},e)}))))),c.a.createElement("div",{className:"Merchant column"},c.a.createElement("span",null,"Merchant"),c.a.createElement("div",null,c.a.createElement(h.a,{value:b.data.merchant,onChange:function(e){return y(Object(N.a)({},b,{data:Object(N.a)({},b.data,{merchant:e.target.value})}))},style:{width:"100%"}}))),c.a.createElement("div",{className:"Merchandise column"},c.a.createElement("span",null,"Merchandise"),c.a.createElement("div",null,c.a.createElement(h.a,{value:b.data.merchandise,onChange:function(e){return y(Object(N.a)({},b,{data:Object(N.a)({},b.data,{merchandise:e.target.value})}))},style:{width:"100%"}}))),c.a.createElement("div",{className:"Tags column"},c.a.createElement("span",null,"Tags"),c.a.createElement("div",null,Object(B.map)(b.data.tags,(function(e){return c.a.createElement(_.a,{key:e,closable:!0,onClose:function(){return y(Object(N.a)({},b,{data:Object(N.a)({},b.data,{tags:Object(B.filter)(b.data.tags,(function(a){return a!==e}))})}))},visible:!0}," ",e," ")})),b.tagsAdding||c.a.createElement(_.a,{onClick:function(){return y(Object(N.a)({},b,{tagsSearch:"",tagsAdding:!0}))},style:{background:"#fff",borderStyle:"dashed"}},c.a.createElement(k.a,{type:"plus"}),"NEW_TAG"),b.tagsAdding&&c.a.createElement(I.a,{size:"small",ref:function(e){K=e},dataSource:[].concat(Object(M.a)(""===b.tagsSearch?[]:[b.tagsSearch]),$),style:{width:250},onSelect:function(e){return y(Object(N.a)({},b,{data:Object(N.a)({},b.data,{tags:[].concat(Object(M.a)(b.data.tags),Object(M.a)(""!==e&&-1===b.data.tags.indexOf(e)?[e]:[]))}),tagsAdding:!1}))},onSearch:function(e){return y(Object(N.a)({},b,{tagsSearch:e}))},onBlur:function(){return y(Object(N.a)({},b,{tagsSearch:"",tagsAdding:!1}))},defaultOpen:!0}))),c.a.createElement("div",{className:"buttons"},c.a.createElement(l.a,{type:"primary",style:{width:"100%"},loading:b.creating,onClick:function(){y(Object(N.a)({},b,{creating:!0}));var e={ExpressionAttributeNames:{"#TS":"timestamp"},Item:{type:{S:b.data.type},timestamp:{N:b.data.timestamp+""},amount:{N:b.data.amount+""},category:{S:b.data.category},merchant:{S:""===b.data.merchant?" ":b.data.merchant},merchandise:{S:""===b.data.merchandise?" ":b.data.merchandise},":tags":{S:b.data.tags.join(" ")+" "}},ReturnConsumedCapacity:"TOTAL",TableName:"Expenses",ConditionExpression:"attribute_not_exists(#TS)"};A().putItem(e,(function(e){e?(console.log(e,e.stack),j.a.error({message:"Creation Failed!",description:(e.message||e)+("The conditional request failed"===e.message?"! We should not override exising items. Try a new timestamp.":"!"),duration:0}),y(Object(N.a)({},b,{creating:!1}))):(j.a.success({message:"Item Created!"}),y(Object(N.a)({},b,{timestamp:-1,creating:!1})),S(m()().unix()))}))}},"Create Item")))),bordered:!0,dataSource:U,renderItem:function(e){return c.a.createElement(w.a.Item,{key:e.timestamp},c.a.createElement("div",{className:"item",onClick:function(){return y({type:e.type,timestamp:e.timestamp,creating:!1,updating:!1,deleting:!1,tagsSearch:"",tagsAdding:!1,data:Object(N.a)({},e,{merchant:" "===e.merchant?"":e.merchant,merchandise:" "===e.merchandise?"":e.merchandise})})}},c.a.createElement("span",{className:"date"},m.a.unix(e.timestamp).format("YYYY-MM-DD")),c.a.createElement("span",{className:"type"},e.type),c.a.createElement("span",{className:"amount"},"\uffe5".concat(e.amount.toFixed(2))),c.a.createElement("span",{className:"category"},e.category),c.a.createElement("span",{className:"merchant"}," "===e.merchant?"":e.merchant),c.a.createElement("span",{className:"merchandise"}," "===e.merchandise?"":e.merchandise),c.a.createElement("span",{className:"tags"},Object(B.map)(e.tags,(function(e){return c.a.createElement(_.a,{key:e,closable:!1,visible:!0}," ",e," ")})))),c.a.createElement(D.a,{title:"Edit Expense Item",placement:"right",closable:!0,destroyOnClose:!0,width:300,className:"expense-edit-drawer",onClose:function(){return y(Object(N.a)({},b,{timestamp:-1}))},visible:b.timestamp===e.timestamp},c.a.createElement("div",{className:"DateTime column"},c.a.createElement("span",null,"DateTime"),c.a.createElement("div",null,c.a.createElement(F.a,{showTime:!0,value:m.a.unix(b.data.timestamp),disabled:!0,style:{width:"100%"}}))),c.a.createElement("div",{className:"Type column"},c.a.createElement("span",null,"Type"),c.a.createElement("div",null,c.a.createElement(Y.a.Group,{value:b.data.type,buttonStyle:"solid",className:"type-selector"},c.a.createElement(Y.a.Button,{value:b.data.type},b.data.type)))),c.a.createElement("div",{className:"Amount column"},c.a.createElement("span",null,"Amount"),c.a.createElement("div",null,c.a.createElement(x.a,{value:b.data.amount,onChange:function(e){return y(Object(N.a)({},b,{data:Object(N.a)({},b.data,{amount:e||0})}))},min:0,step:1e3,precision:2,style:{width:"100%"}}))),c.a.createElement("div",{className:"Category column"},c.a.createElement("span",null,"Category"),c.a.createElement("div",null,c.a.createElement(R.a,{value:b.data.category,onChange:function(e){return y(Object(N.a)({},b,{data:Object(N.a)({},b.data,{category:e})}))},style:{width:"100%"}},Object(B.map)(ee[C],(function(e){return c.a.createElement(Z,{key:e,value:e},e)}))))),c.a.createElement("div",{className:"Merchant column"},c.a.createElement("span",null,"Merchant"),c.a.createElement("div",null,c.a.createElement(h.a,{value:b.data.merchant,onChange:function(e){return y(Object(N.a)({},b,{data:Object(N.a)({},b.data,{merchant:e.target.value})}))},style:{width:"100%"}}))),c.a.createElement("div",{className:"Merchandise column"},c.a.createElement("span",null,"Merchandise"),c.a.createElement("div",null,c.a.createElement(h.a,{value:b.data.merchandise,onChange:function(e){return y(Object(N.a)({},b,{data:Object(N.a)({},b.data,{merchandise:e.target.value})}))},style:{width:"100%"}}))),c.a.createElement("div",{className:"Tags column"},c.a.createElement("span",null,"Tags"),c.a.createElement("div",null,Object(B.map)(b.data.tags,(function(e){return c.a.createElement(_.a,{key:e,closable:!0,onClose:function(){return y(Object(N.a)({},b,{data:Object(N.a)({},b.data,{tags:Object(B.filter)(b.data.tags,(function(a){return a!==e}))})}))},visible:!0}," ",e," ")})),b.tagsAdding||c.a.createElement(_.a,{onClick:function(){return y(Object(N.a)({},b,{tagsSearch:"",tagsAdding:!0}))},style:{background:"#fff",borderStyle:"dashed"}},c.a.createElement(k.a,{type:"plus"}),"NEW_TAG"),b.tagsAdding&&c.a.createElement(I.a,{size:"small",ref:function(e){K=e},dataSource:[].concat(Object(M.a)(""===b.tagsSearch?[]:[b.tagsSearch]),$),style:{width:250},onSelect:function(e){return y(Object(N.a)({},b,{data:Object(N.a)({},b.data,{tags:[].concat(Object(M.a)(b.data.tags),Object(M.a)(""!==e&&-1===b.data.tags.indexOf(e)?[e]:[]))}),tagsAdding:!1}))},onSearch:function(e){return y(Object(N.a)({},b,{tagsSearch:e}))},onBlur:function(){return y(Object(N.a)({},b,{tagsSearch:"",tagsAdding:!1}))},defaultOpen:!0}))),c.a.createElement("div",{className:"buttons"},c.a.createElement(l.a,{type:"primary",style:{width:"100%"},disabled:b.deleting,loading:b.updating,onClick:function(){y(Object(N.a)({},b,{updating:!0}));var e={ExpressionAttributeNames:{"#AM":"amount","#CA":"category","#MCT":"merchant","#MCD":"merchandise","#TG":"tags"},ExpressionAttributeValues:{":amount":{N:b.data.amount+""},":category":{S:b.data.category},":merchant":{S:""===b.data.merchant?" ":b.data.merchant},":merchandise":{S:""===b.data.merchandise?" ":b.data.merchandise},":tags":{S:b.data.tags.join(" ")+" "}},Key:{type:{S:b.type},timestamp:{N:b.timestamp+""}},ReturnValues:"ALL_NEW",TableName:"Expenses",UpdateExpression:"SET #AM = :amount, #CA = :category, #MCT = :merchant, #MCD = :merchandise, #TG = :tags"};A().updateItem(e,(function(e){e?(console.log(e,e.stack),j.a.error({message:"Update Failed!",description:""+(e.message||e),duration:0}),y(Object(N.a)({},b,{updating:!1}))):(j.a.success({message:"Item Updated!"}),y(Object(N.a)({},b,{timestamp:-1,updating:!1})),S(m()().unix()))}))}},"Update Item"),c.a.createElement(l.a,{type:"danger",style:{width:"100%"},disabled:b.updating,loading:b.deleting,onClick:function(){y(Object(N.a)({},b,{deleting:!0}));var e={Key:{type:{S:b.type},timestamp:{N:b.timestamp+""}},TableName:"Expenses"};A().deleteItem(e,(function(e){e?(console.log(e,e.stack),j.a.error({message:"Delete Failed!",description:""+(e.message||e),duration:0}),y(Object(N.a)({},b,{deleting:!1}))):(j.a.success({message:"Item Deleted!"}),y(Object(N.a)({},b,{timestamp:-1,deleting:!1})),S(m()().unix()))}))}},"Delete Item"))))}}))},re=t(108),le=(t(739),h.a.TextArea),ie="NOT_STARTED",oe="RUNNING",me="COMPLETED",ue="FAILED",de=function(e){var a=Object(n.useState)({table:"Incomes",data:""}),t=Object(i.a)(a,2),s=t[0],r=t[1],o=Object(n.useState)({status:ie,total:0,processed:0}),m=Object(i.a)(o,2),u=m[0],d=m[1],g=s.table,p=s.data,E=u.status,b=u.total,y=u.processed;return c.a.createElement("div",{className:"data-import-container"},c.a.createElement(P.a,{onBack:function(){e.goBack()},title:"Data Import"}),c.a.createElement(Y.a.Group,{onChange:function(e){r(Object(N.a)({},s,{table:e.target.value}))},value:g,buttonStyle:"solid",size:"large",className:"table-selector"},c.a.createElement(Y.a.Button,{value:"Incomes"},"Incomes"),c.a.createElement(Y.a.Button,{value:"Expenses"},"Expenses")),c.a.createElement("div",{className:"input-message"},"Incomes"===g&&"type \\t timestamp \\t amount \\t category \\t details \\t tag1 tag2...","Expenses"===g&&"type \\t timestamp \\t amount \\t category \\t merchant \\t merchandise \\t tag1 tag2..."),c.a.createElement(le,{autoSize:{minRows:5,maxRows:12},value:s.data,className:"data-input",onChange:function(e){r(Object(N.a)({},s,{data:e.target.value}))}}),c.a.createElement("div",{className:"buttons"},c.a.createElement(l.a,{type:"primary",style:{width:"100%"},loading:E===oe,size:"large",onClick:function(){var e=Object(B.filter)(p.split("\n"),(function(e){return""!==e})),a=e.length;d({status:oe,total:e.length,processed:0});var t=0,n=setInterval((function(){var c=t+25>a?a:t+25,s={RequestItems:Object(re.a)({},g,"Incomes"===g?Object(B.map)(Object(B.slice)(e,t,c),(function(e){var a=Object(B.map)(e.split("\t"),(function(e){return e.trim()})),t=Object(i.a)(a,6),n=t[0],c=t[1],s=t[2],r=t[3],l=t[4],o=t[5],m=Object(B.filter)(o.split(" "),(function(e){return""!==e}));return{PutRequest:{Item:{type:{S:n},timestamp:{N:c},amount:{N:s},category:{S:r},details:{S:""===l?" ":l},tags:{SS:[].concat(Object(M.a)(m),[" "])}}}}})):Object(B.map)(Object(B.slice)(e,t,c),(function(e){var a=Object(B.map)(e.split("\t"),(function(e){return e.trim()})),t=Object(i.a)(a,7),n=t[0],c=t[1],s=t[2],r=t[3],l=t[4],o=t[5],m=t[6],u=Object(B.filter)(m.split(" "),(function(e){return""!==e}));return{PutRequest:{Item:{type:{S:n},timestamp:{N:c},amount:{N:s},category:{S:r},merchant:{S:""===l?" ":l},merchandise:{S:""===o?" ":o},tags:{SS:[].concat(Object(M.a)(u),[" "])}}}}}))),ReturnConsumedCapacity:"TOTAL"};A().batchWriteItem(s,(function(s){if(s)console.log(s,s.stack),j.a.error({message:"Import Failed (".concat(t," -> ").concat(c,")!"),description:""+(s.message||s),duration:0}),clearInterval(n),d({status:ue,total:e.length,processed:c});else{if(c===a)return d({status:me,total:e.length,processed:c}),void clearInterval(n);d({status:oe,total:e.length,processed:c}),t=c}}))}),1e3)}},"Import Items"),c.a.createElement("div",{className:"status-message"},E===oe&&"Processing: ".concat(y," of ").concat(b,"..."),E===me&&"Completed!",E===ue&&"Failed!")))},ge=(t(740),function(){return c.a.createElement(g,null,c.a.createElement(y,null))});r.a.render(c.a.createElement(ge,null),document.getElementById("root"))}},[[232,1,2]]]);
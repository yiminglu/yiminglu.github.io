(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1013:function(e,t,a){},1062:function(e,t,a){},1408:function(e,t,a){},1409:function(e,t,a){},1410:function(e,t,a){},1411:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),s=a(48),r=a.n(s),o=(a(497),a(127),a(39)),i=a(55),l=(a(499),a(14)),u=a.n(l),m=a(465),d="yiming";var p=Object(m.a)(function(){var e=Object(n.useState)({success:!1,isAdmin:!1}),t=Object(i.a)(e,2),a=t[0],c=t[1];return{loginState:a,loginSuccess:function(e){return c({success:!0,userName:e,isAdmin:e===d})}}}),g=p.Provider,b=p.useContainer,O=a(10),E="Normal",f=[{type:"Ming",categories:["\u6708\u5de5\u8d44","\u5e74\u7ec8\u5956","\u80a1\u6743\u6fc0\u52b1","\u533b\u4fdd\u5b58\u6298","\u4f4f\u623f\u516c\u79ef\u91d1","\u52a0\u73ed\u8865\u52a9","\u5176\u4ed6\u85aa\u8d44"]},{type:"Hehe",categories:["\u6708\u5de5\u8d44","\u5e74\u7ec8\u5956","\u5e74\u4e2d\u5956","\u5b63\u5ea6\u5956","\u5e74\u5047\u5956\u91d1","\u533b\u4fdd\u5b58\u6298","\u4f4f\u623f\u516c\u79ef\u91d1","\u589e\u53d1\u7ee9\u6548\u5956","\u62a5\u9500\u4ea4\u901a\u8d39","\u62a5\u9500\u798f\u5229\u8d39","\u62a5\u9500\u901a\u4fe1\u8d39","\u7ffc\u652f\u4ed8\u9910\u8d39","\u9632\u6691\u964d\u6e29\u8d39","\u62a5\u9500\u7269\u4e1a\u8d39","\u62a5\u9500\u53d6\u6696\u8d39","\u8282\u5047\u65e5\u8865\u52a9","\u751f\u80b2\u6d25\u8d34","\u52a0\u73ed\u8865\u52a9","\u5176\u4ed6\u85aa\u8d44"]},{type:"Invest",categories:["\u8d27\u5e01\u57fa\u91d1","\u6307\u6570\u57fa\u91d1","\u51fa\u501f\u5229\u606f","\u6570\u5b57\u8d27\u5e01","\u80a1\u7968","P2P"]},{type:"Others",categories:["\u8f6c\u5356\u4e8c\u624b","ME\u7238\u5988","HJ\u7238\u5988","ME\u4eb2\u621a","HJ\u4eb2\u621a","ME\u53cb\u4eba","HJ\u53cb\u4eba","\u4eba\u60c5\u5f80\u6765","\u6d3b\u52a8\u8fd4\u73b0","\u5176\u4ed6\u6536\u5165"]}],j=["Exclude","Special","Qinghuan","Gift"],h={},y=Object(O.map)(f,function(e){return h[e.type]=e.categories,e.type}),N=y[0],S=[{type:"\u9910\u996e",categories:["\u5916\u51fa\u996e\u98df","\u95e8\u5e97\u5feb\u9910","\u96f6\u98df\u996e\u6599","\u679c\u852c\u98df\u6750","\u70df\u9152\u8336","\u9910\u996e\u5176\u4ed6"]},{type:"\u4ea4\u901a",categories:["\u6253\u8f66","\u516c\u5171\u4ea4\u901a","\u8f66\u65c5\u8d39\u7528","\u81ea\u9a7e\u52a0\u6cb9","\u81ea\u9a7e\u9ad8\u901f\u8d39","\u81ea\u9a7e\u505c\u8f66","\u81ea\u9a7e\u6d17\u8f66","\u8fdd\u7ae0\u7f5a\u6b3e","\u6c7d\u8f66\u4fdd\u517b","\u6c7d\u8f66\u4fdd\u9669","\u6c7d\u8f66\u7ef4\u4fee","\u6c7d\u8f66\u914d\u4ef6","\u4ea4\u901a\u5176\u4ed6"]},{type:"\u6e05\u6b22",categories:["\u5a03\u513f\u996e\u98df","\u5a03\u513f\u73a9\u5177","\u5a03\u513f\u56fe\u4e66","\u5a03\u513f\u6587\u5177","\u5a03\u513f\u978b\u670d","\u5a03\u513f\u914d\u9970","\u5a03\u513f\u6e38\u4e50\u573a","\u5a03\u513f\u7528\u54c1","\u5a03\u513f\u5b55\u671f","\u5a03\u513f\u5b66\u6742\u8d39","\u5a03\u513f\u5174\u8da3\u73ed","\u5a03\u513f\u8f85\u5bfc\u73ed","\u5a03\u513f\u533b\u836f","\u5a03\u513f\u4fdd\u9669","\u5a03\u513f\u7167\u770b","\u5a03\u513f\u5176\u4ed6"]},{type:"\u4eb2\u53cb",categories:["\u5bb6\u4eba\u652f\u51fa","\u53cb\u4eba\u652f\u51fa","\u4eb2\u53cb\u793c\u94b1"]},{type:"\u65e5\u5e38",categories:["\u533b\u7597\u836f\u7269","\u4fdd\u5065\u6309\u6469","\u624b\u673a\u8bdd\u8d39","\u8fd0\u52a8\u5065\u8eab","\u7f8e\u5bb9\u7f8e\u53d1","\u6625\u8282\u5f00\u9500","\u515a\u8d39","\u57ab\u4ed8\u62a5\u9500","\u5de5\u4f5c\u6742\u8d39","\u4fe1\u7528\u5361\u76f8\u5173","\u4fdd\u9669\u8d39\u7528","\u65e5\u5e38\u5176\u4ed6"]},{type:"\u4f4f\u5bbf",categories:["\u6c34\u8d39","\u7535\u8d39","\u71c3\u6c14\u8d39","\u7269\u4e1a\u8d39","\u5bb6\u7535\u5bb6\u5177","\u7f51\u8d39","\u6709\u7ebf\u7535\u89c6\u8d39","\u5bb6\u5c45\u7528\u54c1","\u5bb6\u653f\u670d\u52a1","\u623f\u79df","\u4f4f\u5bbf\u5176\u4ed6"]},{type:"\u501f\u8d37",categories:["\u6d66\u53d1\u94f6\u884c\u623f\u8d37","\u519c\u4e1a\u94f6\u884c\u623f\u8d37","\u6d66\u53d1\u94f6\u884c\u6d88\u8d39\u8d37","\u5357\u4eac\u94f6\u884c\u8d37\u6b3e","\u62db\u5546\u94f6\u884c\u95ea\u7535\u8d37","\u5de5\u5546\u94f6\u884c\u8f66\u8d37","\u7406\u8d22\u5e08\u8ba1\u5212"]},{type:"\u8d2d\u7269",categories:["\u4e66\u7c4d\u8d44\u6599","\u7535\u5b503C","\u6e38\u620f\u5145\u503c","\u5e94\u7528\u670d\u52a1","\u5316\u5986\u62a4\u80a4","\u670d\u88c5\u8863\u9970","\u914d\u4ef6\u9970\u54c1","\u5305\u5305\u624b\u8868","\u6536\u85cf","\u8d2d\u7269\u5176\u4ed6"]},{type:"\u5a31\u4e50",categories:["\u6f14\u5531\u4f1a","\u8bdd\u5267","\u7535\u5f71","\u5531\u6b4c","\u6e38\u620f\u5145\u503c","\u5468\u8fb9\u5916\u51fa","\u65c5\u884c\u5f00\u9500","\u5a31\u4e50\u5176\u4ed6"]}],v=["Exclude","Special","ME\u7238\u5988","ME\u4eb2\u621a","ME\u53cb\u4eba","HJ\u7238\u5988","HJ\u4eb2\u621a","HJ\u53cb\u4eba","LJY","LSY","VPS","DNS","APP","MUSIC","JD","TB88","DRIVE","100x"],Y={},T=Object(O.map)(S,function(e){return Y[e.type]=e.categories,e.type}),A=T[0];a(502);u.a.tz.setDefault("Asia/Shanghai");var D,C,M=function(){var e=Object(n.useState)("MAIN_PAGE"),t=Object(i.a)(e,2),a=t[0],s=t[1],r=b().loginState,l=r.success,u=r.userName;return c.a.createElement("div",{className:"App"},c.a.createElement(I,{goBack:l&&"MAIN_PAGE"!==a?function(){s("MAIN_PAGE")}:void 0,userName:u}),c.a.createElement("div",{className:"content-wrapper"},!l&&c.a.createElement(B,null),l&&"MAIN_PAGE"===a&&c.a.createElement("div",{className:"page-select-area"},c.a.createElement("div",{className:"main-title"},"Welcome!"),c.a.createElement(o.a,{className:"button incomes",type:"primary",onClick:function(){s("INCOMES_PAGE")}},"Incomes"),c.a.createElement(o.a,{className:"button expenses",type:"primary",onClick:function(){s("EXPENSES_PAGE")}},"Expenses"),c.a.createElement(o.a,{className:"button report",type:"primary",onClick:function(){s("REPORT_PAGE")}},"Reports"),c.a.createElement(o.a,{className:"button data-import",type:"primary",onClick:function(){s("DATA_IMPORT_PAGE")}},"Data Import"),c.a.createElement(o.a,{className:"button logout",onClick:function(){document.location.reload()}},"Log Out")),l&&"INCOMES_PAGE"===a&&c.a.createElement(me,{billingType:"BILLING_TYPE_INCOMES",goBack:function(){s("MAIN_PAGE")}}),l&&"EXPENSES_PAGE"===a&&c.a.createElement(me,{billingType:"BILLING_TYPE_EXPENSES",goBack:function(){s("MAIN_PAGE")}}),l&&"REPORT_PAGE"===a&&c.a.createElement(fe,{goBack:function(){s("MAIN_PAGE")}}),l&&"DATA_IMPORT_PAGE"===a&&c.a.createElement(ve,{goBack:function(){s("MAIN_PAGE")}})),c.a.createElement(L,null))},I=(a(519),function(e){var t=e.userName,a=e.goBack;return c.a.createElement("header",{id:"header"},c.a.createElement("a",{className:"site-logo",onClick:function(){return a?a():document.location.replace("/")}},c.a.createElement("img",{src:"/images/logo/SR-oneline.png",alt:"SeasonsRoad"})),t&&c.a.createElement("span",{className:"site-user"},t))}),L=(a(520),function(){return c.a.createElement("footer",{id:"footer"},c.a.createElement("div",{className:"wrapper"},c.a.createElement("div",{className:"left"},c.a.createElement("span",{className:"item"},c.a.createElement("a",{href:"https://github.com/yiminglu"},c.a.createElement("span",{className:"icon icon--github","aria-hidden":"true"},c.a.createElement("svg",{viewBox:"0 0 16 16"},c.a.createElement("path",{fill:"#828282",d:"M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"}))),c.a.createElement("span",{className:"username"},"yiminglu")))),c.a.createElement("div",{className:"right"},c.a.createElement("span",{className:"item"},"\xa9 SeasonsRoad"))))}),w=(a(236),a(79)),R=(a(188),a(52)),_=a(4),x=a(161),k=a(184),P=a.n(k),H=(a(1013),function(){return C});x.b.configure({Auth:{identityPoolId:"us-west-2:70fc8736-5e86-47f3-ab1b-f05b0d93fa2e",region:"us-west-2",userPoolId:"us-west-2_ErwhI1bKS",userPoolWebClientId:"sq9tv2htpaluv4buido7l9eiu",mandatorySignIn:!1,authenticationFlowType:"USER_PASSWORD_AUTH"}});var B=function(){var e=Object(n.useState)({username:"",password:"",status:"NOT_READY"}),t=Object(i.a)(e,2),a=t[0],s=t[1],r=Object(n.useState)({newPassword:"",newPasswordConfirm:"",rstatus:"NOT_READY"}),l=Object(i.a)(r,2),u=l[0],m=l[1],d=a.username,p=a.password,g=a.status,O=u.newPassword,E=u.newPasswordConfirm,f=u.rstatus,j=b().loginSuccess,h=function(){x.a.currentCredentials().then(function(e){P.a.config.update({region:"us-west-2"}),C=new P.a.DynamoDB({apiVersion:"2012-08-10",credentials:x.a.essentialCredentials(e)}),j(d)})},y=function(){"READY"===g&&(s(Object(_.a)(Object(_.a)({},a),{},{status:"LOADING"})),x.a.signIn({username:d,password:p}).then(function(e){D=e,"NEW_PASSWORD_REQUIRED"===e.challengeName?(R.a.warning({message:"New Password Required!",description:"Welcome, ".concat(e.username,"! You need to set up your new password so that we could begin.")}),s(Object(_.a)(Object(_.a)({},a),{},{status:"RESET"}))):"SMS_MFA"!==e.challengeName&&"SOFTWARE_TOKEN_MFA"!==e.challengeName&&"MFA_SETUP"!==e.challengeName?(R.a.success({message:"Login Success!",description:"Welcome back, ".concat(e.username,"!"),duration:3}),h(),s(Object(_.a)(Object(_.a)({},a),{},{status:"READY"}))):R.a.warning({message:"Unhandled User status!",description:"Please contact your admin."})}).catch(function(e){R.a.error({message:"Login Failed!",description:"".concat(e.message||e)}),s(Object(_.a)(Object(_.a)({},a),{},{status:"FAILED"}))}))},N=function(){D&&"NEW_PASSWORD_REQUIRED"===D.challengeName&&x.a.completeNewPassword(D,O,{}).then(function(e){D=e,"SMS_MFA"!==e.challengeName&&"SOFTWARE_TOKEN_MFA"!==e.challengeName&&"MFA_SETUP"!==e.challengeName?(R.a.success({message:"Login Success!",description:"Welcome back, ".concat(e.username,"!"),duration:3}),h(),s(Object(_.a)(Object(_.a)({},a),{},{status:"READY"}))):R.a.warning({message:"Unhandled User status!",description:"Please contact your admin."})}).catch(function(e){R.a.error({message:"Reset Failed!",description:"".concat(e.message||e)}),m(Object(_.a)(Object(_.a)({},u),{},{rstatus:"FAILED"}))})};return c.a.createElement("div",{className:"login-container"},c.a.createElement("div",{className:"login-title"},"RESET"!==g?"Billing System":"Reset Password"),"RESET"!==g&&c.a.createElement(w.a,{className:"username-input".concat("FAILED"===g?" error":""),size:"large",onChange:function(e){var t=e.target.value;s(""!==t&&""!==p?Object(_.a)(Object(_.a)({},a),{},{username:t,status:"READY"}):Object(_.a)(Object(_.a)({},a),{},{username:t,status:"NOT_READY"}))},onPressEnter:y,placeholder:"Input User Name"}),"RESET"!==g&&c.a.createElement(w.a.Password,{className:"password-input".concat("FAILED"===g?" error":""),size:"large",onChange:function(e){var t=e.target.value;s(""!==d&&""!==t?Object(_.a)(Object(_.a)({},a),{},{password:t,status:"READY"}):Object(_.a)(Object(_.a)({},a),{},{password:t,status:"NOT_READY"}))},onPressEnter:y,placeholder:"Input Password"}),"RESET"!==g&&c.a.createElement(o.a,{className:"login-button",size:"large",type:"primary",disabled:"NOT_READY"===g,loading:"LOADING"===g,onClick:y},"Login"),"RESET"===g&&c.a.createElement(w.a.Password,{className:"password-reset-input",size:"large",onChange:function(e){var t=e.target.value;m(t===E?Object(_.a)(Object(_.a)({},u),{},{newPassword:t,rstatus:"READY"}):Object(_.a)(Object(_.a)({},u),{},{newPassword:t,rstatus:"NOT_READY"}))},onPressEnter:N,placeholder:"Input New Password"}),"RESET"===g&&c.a.createElement(w.a.Password,{className:"password-reset-confirm-input",size:"large",onChange:function(e){var t=e.target.value;m(O===t?Object(_.a)(Object(_.a)({},u),{},{newPasswordConfirm:t,rstatus:"READY"}):Object(_.a)(Object(_.a)({},u),{},{newPasswordConfirm:t,rstatus:"NOT_READY"}))},onPressEnter:N,placeholder:"Confirm New Password"}),"RESET"===g&&c.a.createElement(o.a,{className:"reset-button",size:"large",type:"primary",disabled:"NOT_READY"===f,loading:"LOADING"===f,onClick:N},"Reset"))},F=(a(1412),a(233)),U=(a(1041),a(306)),G=(a(1043),a(304)),z=a(80),V=(a(1045),a(234)),W=(a(374),a(100)),J=(a(1048),a(488)),Q=(a(1050),a(307)),q=(a(289),a(157)),K=a(89),X=(a(253),a(88)),Z=(a(254),a(99)),$=(a(1060),a(232)),ee=a(1416),te=a(1417),ae=a(1418),ne=a(1419),ce=(a(1062),$.a.RangePicker),se=Z.a.CheckableTag,re=X.a.Option,oe=u()().subtract(1,"months").startOf("month"),ie=u()().endOf("month"),le=["Special","Fixed","Exclude"],ue=function(e){return Boolean(e&&e>u()().endOf("month"))},me=function(e){var t=e.billingType,a=e.goBack,s=b().loginState.isAdmin,r="BILLING_TYPE_INCOMES"===t,l=r?"Incomes":"Expenses",m=r?N:A,d=r?"Incomes":"Expenses",p=r?y:T,g=r?j:v,D=r?h:Y,C=r?[1/0,0,1e3,1e4]:[1/0,0,100,300,1e3],M=Object(n.useState)(!1),I=Object(i.a)(M,2),L=I[0],x=I[1],k=Object(n.useState)({start:oe,end:ie,types:{},selectedTypes:p,categories:[],selectedCategories:[],selectedTags:[],selectMultipleTags:!1,specialTags:[],selectedSpecialTags:[E].concat(le),thresholdType:"THRESHOLD_DISABLED",thresholdValue:1/0,sortByAmount:!1,showNumbers:!0,search:""}),P=Object(i.a)(k,2),B=P[0],me=P[1],de=Object(n.useState)({status:"START",list:[]}),pe=Object(i.a)(de,2),ge=pe[0],be=pe[1],Oe=Object(n.useState)({type:m,timestamp:-1,creating:!1,updating:!1,deleting:!1,tagsSearch:"",tagsAdding:!1,data:{type:"",timestamp:0,amount:0,category:"",details:"",tags:[]}}),Ee=Object(i.a)(Oe,2),fe=Ee[0],je=Ee[1],he=Object(n.useState)(u()().unix()),ye=Object(i.a)(he,2),Ne=ye[0],Se=ye[1],ve=B.start,Ye=B.end,Te=B.types,Ae=B.selectedTypes,De=B.categories,Ce=B.selectedCategories,Me=B.selectedTags,Ie=B.selectMultipleTags,Le=B.specialTags,we=B.selectedSpecialTags,Re=B.thresholdType,_e=B.thresholdValue,xe=B.sortByAmount,ke=B.showNumbers,Pe=B.search;Object(n.useEffect)(function(){be(Object(_.a)(Object(_.a)({},ge),{},{status:"LOADING"}));var e=ve.unix(),t=Ye.unix(),a=(t-e)/3456e4+1,n=Object(O.times)(a,function(n){return 1===a?[e,t]:0===n?[e,e+3456e4]:n===a-1?[e+3456e4*n+1,t]:[e+3456e4*n+1,e+3456e4*(n+1)]});Promise.all(Object(O.map)(n,function(e){return new Promise(function(t,a){var n={ExpressionAttributeNames:{"#P":"partition","#TS":"timestamp"},ExpressionAttributeValues:{":partition":{S:d},":t1":{N:"".concat(e[0])},":t2":{N:"".concat(e[1])}},KeyConditionExpression:"#P = :partition AND #TS BETWEEN :t1 AND :t2",TableName:"BillingV2"};H().query(n,function(e,n){if(e)a(e);else{var c=Object(O.map)(n.Items,function(e){return r?{timestamp:parseInt(e.timestamp.N,10),type:e.type.S,amount:parseFloat(e.amount.N),category:e.category.S,details:e.details?e.details.S:"",tags:Object(O.filter)(e.tags?e.tags.SS:[],function(e){return""!==e&&" "!==e})}:{timestamp:parseInt(e.timestamp.N,10),type:e.type.S,amount:parseFloat(e.amount.N),category:e.category.S,merchant:e.merchant.S,merchandise:e.merchandise.S,tags:Object(O.filter)(e.tags?e.tags.SS:[],function(e){return""!==e&&" "!==e})}});t(c)}})})})).then(function(e){var t,a=Object(O.reduce)(e,function(e,t){return Object(O.concat)(e,t)},[]);Object(O.each)(a,function(e){e.tags.includes("100x")&&(s?e.amount*=100:Object(O.remove)(e.tags,function(e){return"100x"===e}))});var n=Object(O.filter)(a,function(e){return Ae.includes(e.type)}),c=Object(O.filter)(n,function(e){return"THRESHOLD_DISABLED"===Re||"THRESHOLD_LARGER_THAN"===Re&&e.amount>=_e||"THRESHOLD_SMALLER_THAN"===Re&&e.amount<=_e||"THRESHOLD_EQUALS_TO"===Re&&e.amount===_e}),r=Object(O.filter)(c,function(e){return""===Pe||Boolean(e.type.toUpperCase().includes(Pe.toUpperCase()))||Boolean(e.category.toUpperCase().includes(Pe.toUpperCase()))||Boolean(e.merchant&&e.merchant.toUpperCase().includes(Pe.toUpperCase()))||Boolean(e.merchandise&&e.merchandise.toUpperCase().includes(Pe.toUpperCase()))||Boolean(e.details&&e.details.toUpperCase().includes(Pe.toUpperCase()))||Boolean(e.tags.length>0&&Object(O.find)(e.tags,function(e){return e.toUpperCase().includes(Pe.toUpperCase())}))}),o={};Object(O.each)(p,function(e){o[e]=0});var i=(t={},Object(K.a)(t,E,0),Object(K.a)(t,"Special",0),Object(K.a)(t,"Fixed",0),Object(K.a)(t,"Exclude",0),t);Object(O.each)(r,function(e){var t=Object(O.intersection)(e.tags,le)[0]||E;i[t]++,o[e.type]++});var l=Object(O.filter)(r,function(e){return Object(O.intersection)(e.tags,le,we).length>0||0===Object(O.intersection)(e.tags,le).length&&we.includes(E)}),u={},m=["! NO TAGs"];Object(O.each)(l,function(e){u[e.category]||(u[e.category]={count:0,amount:0}),u[e.category].count++,u[e.category].amount+=e.amount,m=Object(O.union)(m,Object(O.difference)(e.tags,le))});var d=Object(O.sortBy)(Object(O.map)(u,function(e,t){return{category:t,count:e.count,amount:e.amount}}),xe?"amount":"count").reverse();be({status:"SUCCESS",list:a}),me(Object(_.a)(Object(_.a)({},B),{},{types:o,categories:d,selectedCategories:Object(O.map)(d,function(e){return e.category}),selectedTags:Ie?m:[],specialTags:Object(O.map)(i,function(e,t){return{tag:t,count:e}})})),x(!1)}).catch(function(e){console.log(e,e.stack),R.a.error({message:"Query Failed!",description:"".concat(e.message||e),duration:0}),be(Object(_.a)(Object(_.a)({},ge),{},{status:"FAILED"}))})},[ve,Ye,Ne]),Object(n.useEffect)(function(){var e,t=Object(O.filter)(ge.list,function(e){return Ae.includes(e.type)}),a=Object(O.filter)(t,function(e){return"THRESHOLD_DISABLED"===Re||"THRESHOLD_LARGER_THAN"===Re&&e.amount>=_e||"THRESHOLD_SMALLER_THAN"===Re&&e.amount<=_e||"THRESHOLD_EQUALS_TO"===Re&&e.amount===_e}),n=Object(O.filter)(a,function(e){return""===Pe||Boolean(e.type.toUpperCase().includes(Pe.toUpperCase()))||Boolean(e.category.toUpperCase().includes(Pe.toUpperCase()))||Boolean(e.merchant&&e.merchant.toUpperCase().includes(Pe.toUpperCase()))||Boolean(e.merchandise&&e.merchandise.toUpperCase().includes(Pe.toUpperCase()))||Boolean(e.details&&e.details.toUpperCase().includes(Pe.toUpperCase()))||Boolean(e.tags.length>0&&Object(O.find)(e.tags,function(e){return e.toUpperCase().includes(Pe.toUpperCase())}))}),c=(e={},Object(K.a)(e,E,0),Object(K.a)(e,"Special",0),Object(K.a)(e,"Fixed",0),Object(K.a)(e,"Exclude",0),e);Object(O.each)(n,function(e){var t=Object(O.intersection)(e.tags,le)[0]||E;c[t]++});var s=Object(O.filter)(n,function(e){return Object(O.intersection)(e.tags,le,we).length>0||0===Object(O.intersection)(e.tags,le).length&&we.includes(E)}),r={},o=["! NO TAGs"];Object(O.each)(s,function(e){r[e.category]||(r[e.category]={count:0,amount:0}),r[e.category].count++,r[e.category].amount+=e.amount,o=Object(O.union)(o,Object(O.difference)(e.tags,le))});var i=Object(O.sortBy)(Object(O.map)(r,function(e,t){return{category:t,count:e.count,amount:e.amount}}),xe?"amount":"count").reverse();me(Object(_.a)(Object(_.a)({},B),{},{categories:i,selectedCategories:Object(O.map)(i,function(e){return e.category}),selectedTags:Ie?o:[],specialTags:Object(O.map)(c,function(e,t){return{tag:t,count:e}})})),x(!1)},[Ae.join(","),Re,_e,xe,Pe,we.join(",")]);var He=Object(O.filter)(ge.list,function(e){return Ae.includes(e.type)}),Be=Object(O.filter)(He,function(e){return"THRESHOLD_DISABLED"===Re||"THRESHOLD_LARGER_THAN"===Re&&e.amount>=_e||"THRESHOLD_SMALLER_THAN"===Re&&e.amount<=_e||"THRESHOLD_EQUALS_TO"===Re&&e.amount===_e}),Fe=Object(O.filter)(Be,function(e){return""===Pe||Boolean(e.type.toUpperCase().includes(Pe.toUpperCase()))||Boolean(e.category.toUpperCase().includes(Pe.toUpperCase()))||Boolean(e.merchant&&e.merchant.toUpperCase().includes(Pe.toUpperCase()))||Boolean(e.merchandise&&e.merchandise.toUpperCase().includes(Pe.toUpperCase()))||Boolean(e.details&&e.details.toUpperCase().includes(Pe.toUpperCase()))||Boolean(Object(O.difference)(e.tags,le).length>0&&Object(O.find)(Object(O.difference)(e.tags,le),function(e){return e.toUpperCase().includes(Pe.toUpperCase())}))}),Ue=Object(O.filter)(Fe,function(e){return Object(O.intersection)(e.tags,le,we).length>0||0===Object(O.intersection)(e.tags,le).length&&we.includes(E)}),Ge=Object(O.filter)(Ue,function(e){return Ce.includes(e.category)}),ze=["! NO TAGs"],Ve=Me.includes("! NO TAGs"),We=Object(O.filter)(Ge,function(e){return ze=Object(O.union)(ze,Object(O.difference)(e.tags,le)),!Ie&&0===Me.length||Ve&&Boolean(!e.tags||!Object(O.difference)(e.tags,le).length)||Object(O.intersection)(e.tags,Me).length>0}),Je=We.length,Qe=0;Object(O.each)(We,function(e){Qe+=e.amount});var qe={},Ke=0,Xe=0;Object(O.each)(Ge,function(e){e.tags&&Object(O.difference)(e.tags,le).length>0?Object(O.each)(Object(O.difference)(e.tags,le),function(t){qe[t]||(qe[t]={count:0,amount:0}),qe[t].count++,qe[t].amount+=e.amount}):(Ke++,Xe+=e.amount)});var Ze,$e=Object(O.sortBy)(Object(O.map)(qe,function(e,t){return{tag:t,count:e.count,amount:e.amount}}),xe?"amount":"count").reverse(),et=Object(O.filter)($e,function(e){return"Fixed"!==e.tag&&"Special"!==e.tag&&"Exclude"!==e.tag});return Object(n.useEffect)(function(){fe.tagsAdding&&Ze.focus()},[fe.tagsAdding]),c.a.createElement("div",{className:"billing-container ".concat(r?"incomes":"expenses").concat("LOADING"===ge.status?" loading":"")},c.a.createElement(q.a,{onBack:function(){return a&&a()},title:l}),c.a.createElement("div",{className:"touch-breaker"}),c.a.createElement(Q.a,{checkedChildren:"\u603b\u91cf\u6392\u5e8f",unCheckedChildren:"\u6b21\u6570\u6392\u5e8f",checked:xe,onChange:function(e){return me(Object(_.a)(Object(_.a)({},B),{},{sortByAmount:e}))},className:"sort-by-selector"}),c.a.createElement(J.a,{checked:ke,onChange:function(e){return me(Object(_.a)(Object(_.a)({},B),{},{showNumbers:e.target.checked}))},className:"show-number-checkbox"}),c.a.createElement("div",{className:"types-selector multiple-selector-primary"},c.a.createElement("span",null,Object(O.map)(p,function(e){return c.a.createElement(se,{className:"near-by",key:e,checked:Ae.includes(e),onChange:function(){me(Object(_.a)(Object(_.a)({},B),{},{selectedTypes:Object(O.xor)(Ae,[e])}))}},e,c.a.createElement("span",{className:"sp-tag-count"},ke&&Boolean(Te[e])&&" ".concat(Te[e])))})),c.a.createElement(o.a,{type:"primary",size:"small",onClick:function(){me(Object(_.a)(Object(_.a)({},B),{},{selectedTypes:0===Ae.length?p:[]}))}},0===Ae.length?c.a.createElement(ee.a,null):c.a.createElement(te.a,null))),c.a.createElement("div",{className:"date-range-picker"},c.a.createElement(ce,{ranges:{ALL:[u()("20150501","YYYYMMDD"),u()("".concat(u()().year()+(u()().month()<4?0:1)).concat(u()().month()<4?"12":"04","01"),"YYYYMMDD").endOf("month")],FY22:[u()("20210501","YYYYMMDD"),u()("20220401","YYYYMMDD").endOf("month")],FY21:[u()("20200501","YYYYMMDD"),u()("20210401","YYYYMMDD").endOf("month")],FY20:[u()("20190501","YYYYMMDD"),u()("20200401","YYYYMMDD").endOf("month")],FY19:[u()("20180501","YYYYMMDD"),u()("20190401","YYYYMMDD").endOf("month")],FY18:[u()("20170501","YYYYMMDD"),u()("20180401","YYYYMMDD").endOf("month")],FY17:[u()("20160501","YYYYMMDD"),u()("20170401","YYYYMMDD").endOf("month")],FY16:[u()("20150501","YYYYMMDD"),u()("20160401","YYYYMMDD").endOf("month")],Y22:[u()("20220101","YYYYMMDD"),u()("20220101","YYYYMMDD").endOf("year")],Y21:[u()("20210101","YYYYMMDD"),u()("20210101","YYYYMMDD").endOf("year")],Y20:[u()("20200101","YYYYMMDD"),u()("20200101","YYYYMMDD").endOf("year")],Y19:[u()("20190101","YYYYMMDD"),u()("20190101","YYYYMMDD").endOf("year")],Y18:[u()("20180101","YYYYMMDD"),u()("20180101","YYYYMMDD").endOf("year")],Y17:[u()("20170101","YYYYMMDD"),u()("20170101","YYYYMMDD").endOf("year")],Y16:[u()("20160101","YYYYMMDD"),u()("20160101","YYYYMMDD").endOf("year")],Y15:[u()("20150101","YYYYMMDD"),u()("20150101","YYYYMMDD").endOf("year")],"-12M":[u()().subtract(1,"years").startOf("month"),u()().subtract(1,"month").endOf("month")],"-24M":[u()().subtract(2,"years").startOf("month"),u()().subtract(1,"month").endOf("month")],"-24M ~ -12M":[u()().subtract(2,"years").startOf("month"),u()().subtract(1,"years").subtract(1,"month").endOf("month")]},defaultValue:[oe,ie],disabledDate:ue,onChange:function(e){me(Object(_.a)(Object(_.a)({},B),{},{start:Object(O.get)(e,"0")||u()(),end:Object(O.get)(e,"1")||u()()}))},allowClear:!1,size:"large"})),c.a.createElement("div",{className:"special-tags-selector multiple-selector-primary"},c.a.createElement("span",null,Object(O.map)(Le,function(e){return c.a.createElement(se,{className:"near-by",key:e.tag,checked:we.includes(e.tag),onChange:function(){me(Object(_.a)(Object(_.a)({},B),{},{selectedSpecialTags:Object(O.xor)(we,[e.tag])}))}},e.tag,c.a.createElement("span",{className:"sp-tag-count"},ke&&" ".concat(e.count)))})),c.a.createElement(o.a,{type:"primary",size:"small",onClick:function(){me(Object(_.a)(Object(_.a)({},B),{},{selectedSpecialTags:0===we.length?[E].concat(le):[]}))}},0===we.length?c.a.createElement(ee.a,null):c.a.createElement(te.a,null))),c.a.createElement("div",{className:"search-container"},c.a.createElement(w.a,{value:Pe,onChange:function(e){return me(Object(_.a)(Object(_.a)({},B),{},{search:e.target.value}))},placeholder:"\u641c\u7d22"})),c.a.createElement("div",{className:"threshold-selector"},c.a.createElement(W.a.Group,{onChange:function(e){return me(Object(_.a)(Object(_.a)({},B),{},{thresholdType:e.target.value===1/0?"THRESHOLD_DISABLED":"THRESHOLD_DISABLED"===Re?"THRESHOLD_LARGER_THAN":Re,thresholdValue:e.target.value}))},value:_e,className:"threshold-quick-selector"},Object(O.map)(C,function(e){return c.a.createElement(W.a.Button,{key:e,value:e},e===1/0?c.a.createElement(te.a,null):e)})),c.a.createElement("span",{className:"threshold-type-value-container"},"THRESHOLD_DISABLED"!==Re&&c.a.createElement(o.a,{className:"threshold-type",onClick:function(){me(Object(_.a)(Object(_.a)({},B),{},{thresholdType:"THRESHOLD_LARGER_THAN"===Re?"THRESHOLD_SMALLER_THAN":"THRESHOLD_SMALLER_THAN"===Re?"THRESHOLD_EQUALS_TO":"THRESHOLD_LARGER_THAN"}))}},"THRESHOLD_LARGER_THAN"===Re&&"\u2265","THRESHOLD_SMALLER_THAN"===Re&&"\u2264","THRESHOLD_EQUALS_TO"===Re&&"="),"THRESHOLD_DISABLED"!==Re&&c.a.createElement(V.a,{className:"threshold-value",value:_e,onChange:function(e){var t=0;"number"===typeof e?t=e:"string"===typeof e&&(t=parseInt(e,10)),me(Object(_.a)(Object(_.a)({},B),{},{thresholdValue:t}))},step:r?1e3:100,precision:0,style:{width:80}}))),c.a.createElement("div",{className:"categories-selector"},Object(O.map)(De,function(e){return c.a.createElement(se,{key:e.category,checked:Object(O.includes)(Ce,e.category),onChange:function(t){me(t?Object(_.a)(Object(_.a)({},B),{},{selectedCategories:[].concat(Object(z.a)(Ce),[e.category])}):Object(_.a)(Object(_.a)({},B),{},{selectedCategories:Object(O.filter)(Ce,function(t){return t!==e.category})}))}},e.category,c.a.createElement("span",{className:"count"},ke&&"".concat(xe?e.amount.toFixed(2):e.count)))}),De.length>0&&0===Ce.length&&c.a.createElement(o.a,{type:"primary",size:"small",onClick:function(){me(Object(_.a)(Object(_.a)({},B),{},{selectedCategories:Object(O.map)(De,function(e){return e.category})}))}},c.a.createElement(ee.a,null)),De.length>0&&0!==Ce.length&&c.a.createElement(o.a,{type:"primary",size:"small",onClick:function(){me(Object(_.a)(Object(_.a)({},B),{},{selectedCategories:[]}))}},c.a.createElement(te.a,null))),c.a.createElement("div",{className:"tags-selector"},Object(O.map)(et,function(e){return c.a.createElement(se,{key:e.tag,checked:Me.includes(e.tag),onChange:function(t){me(t?Object(_.a)(Object(_.a)({},B),{},{selectedTags:Ie?Object(O.union)(Me,[e.tag]):[e.tag]}):Object(_.a)(Object(_.a)({},B),{},{selectedTags:Ie?Object(O.xor)(Me,[e.tag]):[]}))}},e.tag,c.a.createElement("span",{className:"count"},ke&&"".concat(xe?e.amount.toFixed(2):e.count)))}),Ke>0&&c.a.createElement(se,{className:"no-tags-tag",checked:Me.includes("! NO TAGs"),onChange:function(e){me(e?Object(_.a)(Object(_.a)({},B),{},{selectedTags:Ie?Object(O.union)(Me,["! NO TAGs"]):["! NO TAGs"]}):Object(_.a)(Object(_.a)({},B),{},{selectedTags:Ie?Object(O.xor)(Me,["! NO TAGs"]):[]}))}},"! NO TAGs",c.a.createElement("span",{className:"count"},ke&&"".concat(xe?Xe.toFixed(2):Ke))),Ie&&et.length>0&&c.a.createElement(o.a,{type:"primary",size:"small",onClick:function(){me(Object(_.a)(Object(_.a)({},B),{},{selectedTags:0===Me.length?ze:[]}))}},0===Me.length?c.a.createElement(ee.a,null):c.a.createElement(te.a,null)),(et.length>0||Ke>0)&&c.a.createElement(Q.a,{checkedChildren:"\u591a\u9009",unCheckedChildren:"\u5355\u9009",checked:Ie,onChange:function(e){return me(Object(_.a)(Object(_.a)({},B),{},{selectedTags:e?ze:[],selectMultipleTags:e}))},className:"multiple-selector-selector"})),c.a.createElement(F.b,{className:"billing-list",header:c.a.createElement("div",{className:"item header"},c.a.createElement("span",{className:"date"},"Date"),c.a.createElement("span",{className:"type"},"Type"),c.a.createElement("span",{className:"category"},"Category"),c.a.createElement("span",{className:"amount"},"Amount"),r&&c.a.createElement("span",{className:"details"},"Details"),r||c.a.createElement("span",{className:"merchant"},"Merchant"),r||c.a.createElement("span",{className:"merchandise"},"Merchandise"),c.a.createElement("span",{className:"tags"},"Tags")),footer:c.a.createElement("div",{className:"billing-list-footer"},c.a.createElement(ae.a,{className:"add-new",onClick:function(){je(Object(_.a)(Object(_.a)({},fe),{},{timestamp:-1/0,data:r?{type:f[0].type,timestamp:u()().startOf("day").unix(),amount:0,category:f[0].categories[0],details:"",tags:[]}:{type:S[0].type,timestamp:u()().startOf("day").unix(),amount:0,category:S[0].categories[0],merchant:"",merchandise:"",tags:[]}}))}}),c.a.createElement("div",null,Je>0&&c.a.createElement("div",null,"Count:"," ",c.a.createElement("span",{className:"number"},Je)),Je>0&&c.a.createElement("div",null,"Average:"," ",c.a.createElement("span",{className:"number"},"\uffe5",(Qe/Je).toFixed(2))),c.a.createElement("div",null,"Total:"," ",c.a.createElement("span",{className:"number"},"\uffe5",Qe.toFixed(2)))),c.a.createElement(U.a,{title:"Create ".concat(l," Item"),placement:"right",closable:!0,destroyOnClose:!0,width:300,className:"billing-create-drawer",onClose:function(){return je(Object(_.a)(Object(_.a)({},fe),{},{timestamp:-1}))},visible:fe.timestamp===-1/0},c.a.createElement("div",{className:"DateTime column"},c.a.createElement("span",null,"DateTime"),c.a.createElement("div",null,c.a.createElement($.a,{allowClear:!1,showTime:!0,value:u.a.unix(fe.data.timestamp),onChange:function(e){return je(Object(_.a)(Object(_.a)({},fe),{},{data:Object(_.a)(Object(_.a)({},fe.data),{},{timestamp:e?e.unix():u()().startOf("day").unix()})}))},style:{width:"100%"}}))),c.a.createElement("div",{className:"Type column"},c.a.createElement("span",null,"Type"),c.a.createElement("div",null,c.a.createElement(W.a.Group,{value:fe.data.type,onChange:function(e){return je(Object(_.a)(Object(_.a)({},fe),{},{data:Object(_.a)(Object(_.a)({},fe.data),{},{type:e.target.value,category:D[e.target.value][0]})}))},buttonStyle:"solid",className:"type-selector"},Object(O.map)(p,function(e){return c.a.createElement(W.a.Button,{key:e,value:e},e)})))),c.a.createElement("div",{className:"Category column"},c.a.createElement("span",null,"Category"),c.a.createElement("div",null,c.a.createElement(X.a,{value:fe.data.category,onChange:function(e){return je(Object(_.a)(Object(_.a)({},fe),{},{data:Object(_.a)(Object(_.a)({},fe.data),{},{category:e})}))},style:{width:"100%"}},Object(O.map)(D[fe.data.type],function(e){return c.a.createElement(re,{key:e,value:e},e)})))),c.a.createElement("div",{className:"Amount column"},c.a.createElement("span",null,"Amount"),c.a.createElement("div",null,c.a.createElement(V.a,{value:fe.data.amount,onChange:function(e){var t=0;"number"===typeof e?t=e:"string"===typeof e&&(t=parseInt(e,10)),je(Object(_.a)(Object(_.a)({},fe),{},{data:Object(_.a)(Object(_.a)({},fe.data),{},{amount:t})}))},step:r?1e3:100,precision:2,style:{width:"100%"}}))),r&&c.a.createElement("div",{className:"Details column"},c.a.createElement("span",null,"Details"),c.a.createElement("div",null,c.a.createElement(w.a,{value:fe.data.details,onChange:function(e){return je(Object(_.a)(Object(_.a)({},fe),{},{data:Object(_.a)(Object(_.a)({},fe.data),{},{details:e.target.value})}))},style:{width:"100%"}}))),r||c.a.createElement("div",{className:"Merchant column"},c.a.createElement("span",null,"Merchant"),c.a.createElement("div",null,c.a.createElement(w.a,{value:fe.data.merchant,onChange:function(e){return je(Object(_.a)(Object(_.a)({},fe),{},{data:Object(_.a)(Object(_.a)({},fe.data),{},{merchant:e.target.value})}))},style:{width:"100%"}}))),r||c.a.createElement("div",{className:"Merchandise column"},c.a.createElement("span",null,"Merchandise"),c.a.createElement("div",null,c.a.createElement(w.a,{value:fe.data.merchandise,onChange:function(e){return je(Object(_.a)(Object(_.a)({},fe),{},{data:Object(_.a)(Object(_.a)({},fe.data),{},{merchandise:e.target.value})}))},style:{width:"100%"}}))),c.a.createElement("div",{className:"Tags column"},c.a.createElement("span",null,"Tags"),c.a.createElement("div",null,Object(O.map)(fe.data.tags,function(e){return c.a.createElement(Z.a,{key:e,closable:!0,onClose:function(){return je(Object(_.a)(Object(_.a)({},fe),{},{data:Object(_.a)(Object(_.a)({},fe.data),{},{tags:Object(O.filter)(fe.data.tags,function(t){return t!==e})})}))},visible:!0}," ",e," ")}),fe.tagsAdding||c.a.createElement(Z.a,{onClick:function(){return je(Object(_.a)(Object(_.a)({},fe),{},{tagsSearch:"",tagsAdding:!0}))},style:{background:"#fff",borderStyle:"dashed"}},c.a.createElement(ne.a,null)),fe.tagsAdding&&c.a.createElement(G.a,{size:"small",ref:function(e){Ze=e},dataSource:[].concat(Object(z.a)(""===fe.tagsSearch?[]:[fe.tagsSearch]),Object(z.a)(g)),style:{width:250},onSelect:function(e){return je(Object(_.a)(Object(_.a)({},fe),{},{data:Object(_.a)(Object(_.a)({},fe.data),{},{tags:[].concat(Object(z.a)(fe.data.tags),Object(z.a)(""!==e&&-1===fe.data.tags.indexOf(e)?[e]:[]))}),tagsAdding:!1}))},onSearch:function(e){return je(Object(_.a)(Object(_.a)({},fe),{},{tagsSearch:e}))},onBlur:function(){return je(Object(_.a)(Object(_.a)({},fe),{},{tagsSearch:"",tagsAdding:!1}))},defaultOpen:!0}))),c.a.createElement("div",{className:"buttons"},c.a.createElement(o.a,{type:"primary",style:{width:"100%"},loading:fe.creating,onClick:function(){je(Object(_.a)(Object(_.a)({},fe),{},{creating:!0}));var e={ExpressionAttributeNames:{"#TS":"timestamp"},Item:{partition:{S:d},timestamp:{N:"".concat(fe.data.timestamp)},type:{S:fe.data.type},category:{S:fe.data.category},amount:{N:"".concat(fe.data.amount)},tags:{S:"".concat(fe.data.tags.join(" ")," ")}},ReturnConsumedCapacity:"TOTAL",TableName:"BillingV2",ConditionExpression:"attribute_not_exists(#TS)"};r?e.Item.details={S:""===fe.data.details?" ":fe.data.details}:(e.Item.merchant={S:""===fe.data.merchant?" ":fe.data.merchant},e.Item.merchandise={S:""===fe.data.merchandise?" ":fe.data.merchandise}),H().putItem(e,function(e){e?(console.log(e,e.stack),R.a.error({message:"Creation Failed!",description:"".concat(e.message||e).concat("The conditional request failed"===e.message?"! We should not override exising items. Try a new timestamp.":"!"),duration:0}),je(Object(_.a)(Object(_.a)({},fe),{},{creating:!1}))):(R.a.success({message:"Item Created!"}),je(Object(_.a)(Object(_.a)({},fe),{},{timestamp:-1,creating:!1})),Se(u()().unix()))})}},"Create Item")))),bordered:!0,dataSource:L||Je<=50?We:[].concat(Object(z.a)(Object(O.slice)(We,0,50)),[{timestamp:0,type:"BILLING_ITEMS_TOGGLE_ALL_TYPE",category:"",amount:0,tags:[]}]),renderItem:function(e){return"BILLING_ITEMS_TOGGLE_ALL_TYPE"===e.type?c.a.createElement(F.b.Item,{key:"BILLING_ITEMS_TOGGLE_ALL_TYPE"},c.a.createElement(o.a,{type:"link",style:{width:"100%"},onClick:function(){return x(!0)}},"Toggle All")):c.a.createElement(F.b.Item,{key:e.timestamp},c.a.createElement("div",{className:"item",onClick:function(){return je({type:e.type,timestamp:e.timestamp,creating:!1,updating:!1,deleting:!1,tagsSearch:"",tagsAdding:!1,data:Object(_.a)(Object(_.a)({},e),{},{details:" "===e.details?"":e.details})})}},c.a.createElement("span",{className:"date"},u.a.unix(e.timestamp).format("YYYY-MM-DD")),c.a.createElement("span",{className:"type"},e.type),c.a.createElement("span",{className:"category"},e.category),c.a.createElement("span",{className:"amount"},"\uffe5".concat(e.amount.toFixed(2))),r&&c.a.createElement("span",{className:"details"}," "===e.details?"":e.details),r||c.a.createElement("span",{className:"merchant"}," "===e.merchant?"":e.merchant),r||c.a.createElement("span",{className:"merchandise"}," "===e.merchandise?"":e.merchandise),c.a.createElement("span",{className:"tags"},Object(O.map)(e.tags,function(e){return c.a.createElement(Z.a,{key:e,closable:!1,visible:!0}," ",e," ")}))),c.a.createElement(U.a,{title:"Edit ".concat(l," Item"),placement:"right",closable:!0,destroyOnClose:!0,width:300,className:"billing-edit-drawer",onClose:function(){return je(Object(_.a)(Object(_.a)({},fe),{},{timestamp:-1}))},visible:fe.timestamp===e.timestamp},c.a.createElement("div",{className:"DateTime column"},c.a.createElement("span",null,"DateTime"),c.a.createElement("div",null,c.a.createElement($.a,{showTime:!0,value:u.a.unix(fe.data.timestamp),disabled:!0,style:{width:"100%"}}))),c.a.createElement("div",{className:"Type column"},c.a.createElement("span",null,"Type"),c.a.createElement("div",null,c.a.createElement(W.a.Group,{value:fe.data.type,onChange:function(e){return je(Object(_.a)(Object(_.a)({},fe),{},{data:Object(_.a)(Object(_.a)({},fe.data),{},{type:e.target.value,category:p[e.target.value][0]})}))},buttonStyle:"solid",className:"type-selector"},Object(O.map)(p,function(e){return c.a.createElement(W.a.Button,{key:e,value:e},e)})))),c.a.createElement("div",{className:"Category column"},c.a.createElement("span",null,"Category"),c.a.createElement("div",null,c.a.createElement(X.a,{value:fe.data.category,onChange:function(e){return je(Object(_.a)(Object(_.a)({},fe),{},{data:Object(_.a)(Object(_.a)({},fe.data),{},{category:e})}))},style:{width:"100%"}},Object(O.map)(D[fe.data.type],function(e){return c.a.createElement(re,{key:e,value:e},e)})))),c.a.createElement("div",{className:"Amount column"},c.a.createElement("span",null,"Amount"),c.a.createElement("div",null,c.a.createElement(V.a,{value:fe.data.amount,onChange:function(e){var t=0;"number"===typeof e?t=e:"string"===typeof e&&(t=parseInt(e,10)),je(Object(_.a)(Object(_.a)({},fe),{},{data:Object(_.a)(Object(_.a)({},fe.data),{},{amount:t})}))},step:1e3,precision:2,style:{width:"100%"}}))),r&&c.a.createElement("div",{className:"Details column"},c.a.createElement("span",null,"Details"),c.a.createElement("div",null,c.a.createElement(w.a,{value:fe.data.details,onChange:function(e){return je(Object(_.a)(Object(_.a)({},fe),{},{data:Object(_.a)(Object(_.a)({},fe.data),{},{details:e.target.value})}))},style:{width:"100%"}}))),r||c.a.createElement("div",{className:"Merchant column"},c.a.createElement("span",null,"Merchant"),c.a.createElement("div",null,c.a.createElement(w.a,{value:fe.data.merchant,onChange:function(e){return je(Object(_.a)(Object(_.a)({},fe),{},{data:Object(_.a)(Object(_.a)({},fe.data),{},{merchant:e.target.value})}))},style:{width:"100%"}}))),r||c.a.createElement("div",{className:"Merchandise column"},c.a.createElement("span",null,"Merchandise"),c.a.createElement("div",null,c.a.createElement(w.a,{value:fe.data.merchandise,onChange:function(e){return je(Object(_.a)(Object(_.a)({},fe),{},{data:Object(_.a)(Object(_.a)({},fe.data),{},{merchandise:e.target.value})}))},style:{width:"100%"}}))),c.a.createElement("div",{className:"Tags column"},c.a.createElement("span",null,"Tags"),c.a.createElement("div",null,Object(O.map)(fe.data.tags,function(e){return c.a.createElement(Z.a,{key:e,closable:!0,onClose:function(){return je(Object(_.a)(Object(_.a)({},fe),{},{data:Object(_.a)(Object(_.a)({},fe.data),{},{tags:Object(O.filter)(fe.data.tags,function(t){return t!==e})})}))},visible:!0}," ",e," ")}),fe.tagsAdding||c.a.createElement(Z.a,{onClick:function(){return je(Object(_.a)(Object(_.a)({},fe),{},{tagsSearch:"",tagsAdding:!0}))},style:{background:"#fff",borderStyle:"dashed"}},c.a.createElement(ne.a,null)),fe.tagsAdding&&c.a.createElement(G.a,{size:"small",ref:function(e){Ze=e},dataSource:[].concat(Object(z.a)(""===fe.tagsSearch?[]:[fe.tagsSearch]),Object(z.a)(g)),style:{width:250},onSelect:function(e){return je(Object(_.a)(Object(_.a)({},fe),{},{data:Object(_.a)(Object(_.a)({},fe.data),{},{tags:[].concat(Object(z.a)(fe.data.tags),Object(z.a)(""!==e&&-1===fe.data.tags.indexOf(e)?[e]:[]))}),tagsAdding:!1}))},onSearch:function(e){return je(Object(_.a)(Object(_.a)({},fe),{},{tagsSearch:e}))},onBlur:function(){return je(Object(_.a)(Object(_.a)({},fe),{},{tagsSearch:"",tagsAdding:!1}))},defaultOpen:!0}))),c.a.createElement("div",{className:"buttons"},c.a.createElement(o.a,{type:"primary",style:{width:"100%"},disabled:fe.deleting,loading:fe.updating,onClick:function(){je(Object(_.a)(Object(_.a)({},fe),{},{updating:!0}));var e={ExpressionAttributeNames:{"#TP":"type","#CA":"category","#AM":"amount","#TG":"tags"},ExpressionAttributeValues:{":type":{S:fe.data.type},":category":{S:fe.data.category},":amount":{N:"".concat(fe.data.amount)},":tags":{SS:[].concat(Object(z.a)(fe.data.tags),[" "])}},Key:{partition:{S:d},timestamp:{N:"".concat(fe.timestamp)}},ReturnValues:"ALL_NEW",TableName:"BillingV2",UpdateExpression:"SET #TP = :type, #CA = :category, #AM = :amount, #DE = :details, #TG = :tags"};r?(e.ExpressionAttributeNames["#DE"]="details",e.ExpressionAttributeValues[":details"]={S:""===fe.data.details?" ":fe.data.details}):(e.ExpressionAttributeNames["#MCT"]="merchant",e.ExpressionAttributeNames["#MCD"]="merchandise",e.ExpressionAttributeValues[":merchant"]={S:""===fe.data.merchant?" ":fe.data.merchant},e.ExpressionAttributeValues[":merchandise"]={S:""===fe.data.merchandise?" ":fe.data.merchandise},e.UpdateExpression="SET #TP = :type, #CA = :category, #AM = :amount, #MCT = :merchant, #MCD = :merchandise, #TG = :tags"),H().updateItem(e,function(e){e?(console.log(e,e.stack),R.a.error({message:"Update Failed!",description:"".concat(e.message||e),duration:0}),je(Object(_.a)(Object(_.a)({},fe),{},{updating:!1}))):(R.a.success({message:"Item Updated!"}),je(Object(_.a)(Object(_.a)({},fe),{},{timestamp:-1,updating:!1})),Se(u()().unix()))})}},"Update Item"),c.a.createElement(o.a,{danger:!0,style:{width:"100%"},disabled:fe.updating,loading:fe.deleting,onClick:function(){je(Object(_.a)(Object(_.a)({},fe),{},{deleting:!0}));var e={Key:{partition:{S:d},timestamp:{N:"".concat(fe.timestamp)}},TableName:"BillingV2"};H().deleteItem(e,function(e){e?(console.log(e,e.stack),R.a.error({message:"Delete Failed!",description:"".concat(e.message||e),duration:0}),je(Object(_.a)(Object(_.a)({},fe),{},{deleting:!1}))):(R.a.success({message:"Item Deleted!"}),je(Object(_.a)(Object(_.a)({},fe),{},{timestamp:-1,deleting:!1})),Se(u()().unix()))})}},"Delete Item"))))}}))},de=a(305),pe=a.n(de),ge=(a(1408),Z.a.CheckableTag),be=u()("20150501","YYYYMMDD"),Oe=["Special","Fixed","Exclude"],Ee=[E].concat(Oe),fe=function(e){var t,a=Object(n.useState)(window.innerWidth),s=Object(i.a)(a,2),r=s[0],o=s[1],l=Object(n.useState)({status:"START",list:[]}),m=Object(i.a)(l,2),d=m[0],p=m[1],g=Object(n.useState)({status:"START",list:[]}),f=Object(i.a)(g,2),j=f[0],h=f[1],N=Object(n.useState)(Ee),S=Object(i.a)(N,2),v=S[0],Y=S[1],A=b().loginState.isAdmin,D=e.goBack,C=be,M=u()(),I=[],L=[];for(t=u()(1e3*C.unix());t<M.endOf("month");t=t.add(1,"month"))I.push(u()(1e3*t.unix())),L.push(t.format("YYYY-MM"));Object(n.useEffect)(function(){Object(O.each)([!0,!1],function(e){var t=e?"Incomes":"Expenses",a=e?p:h,n=e?d:j;a(Object(_.a)(Object(_.a)({},n),{},{status:"LOADING"}));var c=C.unix(),s=M.unix(),r=(s-c)/3456e4+1,o=Object(O.times)(r,function(e){return 1===r?[c,s]:0===e?[c,c+3456e4]:e===r-1?[c+3456e4*e+1,s]:[c+3456e4*e+1,c+3456e4*(e+1)]});Promise.all(Object(O.map)(o,function(a){return new Promise(function(n,c){var s={ExpressionAttributeNames:{"#P":"partition","#TS":"timestamp"},ExpressionAttributeValues:{":partition":{S:t},":t1":{N:"".concat(a[0])},":t2":{N:"".concat(a[1])}},KeyConditionExpression:"#P = :partition AND #TS BETWEEN :t1 AND :t2",TableName:"BillingV2"};H().query(s,function(t,a){if(t)c(t);else{var s=Object(O.map)(a.Items,function(t){return e?{timestamp:parseInt(t.timestamp.N,10),type:t.type.S,amount:parseFloat(t.amount.N),category:t.category.S,details:t.details?t.details.S:"",tags:Object(O.filter)(t.tags?t.tags.SS:[],function(e){return""!==e&&" "!==e})}:{timestamp:parseInt(t.timestamp.N,10),type:t.type.S,amount:parseFloat(t.amount.N),category:t.category.S,merchant:t.merchant.S,merchandise:t.merchandise.S,tags:Object(O.filter)(t.tags?t.tags.SS:[],function(e){return""!==e&&" "!==e})}});Object(O.each)(s,function(e){e.tags.includes("100x")&&A&&(e.amount*=100)}),n(s)}})})})).then(function(e){var t=Object(O.reduce)(e,function(e,t){return Object(O.concat)(e,t)},[]);a({status:"SUCCESS",list:t})}).catch(function(e){console.log(e,e.stack),R.a.error({message:"Query Failed!",description:"".concat(e.message||e),duration:0}),a(Object(_.a)(Object(_.a)({},n),{},{status:"FAILED"}))})})},[]);var w=[];if(d.list.length>0){var x={};Object(O.each)(y,function(e){x[e]={}}),Object(O.each)(d.list,function(e){var t=u()(1e3*e.timestamp).format("YYYY-MM");x[e.type][t]=x[e.type][t]?x[e.type][t]+e.amount:e.amount}),Object(O.each)(y,function(e){w[e]=Object(O.map)(I,function(t){return x[e][t.format("YYYY-MM")]||0})})}var k=[];if(j.list.length>0){var P={};Object(O.each)(T,function(e){P[e]={}}),Object(O.each)(j.list,function(e){var t=u()(1e3*e.timestamp).format("YYYY-MM");(Object(O.intersection)(v,Oe,e.tags).length>0||0===Object(O.intersection)(Oe,e.tags).length&&v.includes(E))&&(P[e.type][t]=P[e.type][t]?P[e.type][t]+e.amount:e.amount)}),Object(O.each)(T,function(e){k[e]=Object(O.map)(I,function(t){return P[e][t.format("YYYY-MM")]||0})})}var B=Object(O.throttle)(function(){o(window.innerWidth)},500,{leading:!1});Object(n.useEffect)(function(){return window.addEventListener("resize",B),function(){window.removeEventListener("resize",B)}},[]);var F=function(e,t){return'<span style="width:150px;display:inline-block;"> <span>'.concat(e,':</span><span style="float:right;">').concat(t.toFixed(2),"</span></span>")},U=r<768,G=function(e,t,a){return{title:{text:e?"Incomes":"Expenses",textStyle:{fontFamily:'"Open Sans", Helvetica, Arial, sans-serif',fontSize:20,color:"#FFF"}},textStyle:{color:"#FFF"},color:["#ef5350","#ec407a","#ab47bc","#5c6bc0","#03a9f4","#26a69a","#8bc34a","#ffca28","#ff5722","#6e7074"],tooltip:{trigger:"axis",formatter:function(e){var t=0,a=Object(O.join)(Object(O.map)(e,function(e){return t+=e.data,F(e.seriesName,e.data)}),"<br />");return"".concat(!!e[0]&&e[0].axisValueLabel,"<br />").concat(a,"<br />").concat(F("\u5171\u8ba1",t))},axisPointer:{type:"shadow"},position:function(e,t,a,n,c){var s={top:120};return s[["left","right"][+(e[0]<c.viewSize[0]/2)]]=5,s},padding:[10,15],backgroundColor:"rgba(50,50,50,0.9)",textStyle:{fontFamily:'Menlo, Monaco, "Courier New", monospace, "Open Sans", Helvetica, Arial, sans-serif'}},legend:{bottom:0,itemGap:20,itemWidth:30,itemHeight:16,textStyle:{color:"#FFF",fontSize:16},selected:{"\u501f\u8d37":!1,"\u5a31\u4e50":!1,Invest:!1,Others:!1},data:t},grid:{top:50,left:10,right:10,bottom:U?e?50:110:50,containLabel:!0},dataZoom:[{type:"inside",start:U?100-r/30/I.length*100:0,end:100}],xAxis:[{type:"category",axisLine:{lineStyle:{color:"#ccc"}},data:L}],yAxis:[{type:"value",minInterval:1e3,axisLabel:{formatter:function(e){return"".concat(e/1e3,"k")}},axisLine:{lineStyle:{color:"#ccc"}},splitLine:{lineStyle:{color:"#444"}}}],series:Object(O.map)(t,function(e){return{name:e,type:"bar",barMaxWidth:50,data:a[e],stack:"ALL"}})}};return c.a.createElement("div",{className:"reports-container"},c.a.createElement(q.a,{onBack:function(){return D&&D()},title:"Reports"}),c.a.createElement(pe.a,{className:"reports incomes",option:G(!0,y,w),style:{height:400}}),c.a.createElement(pe.a,{className:"reports expenses",option:G(!1,T,k),style:{height:400}}),c.a.createElement("div",{className:"special-tags-selector multiple-selector-primary"},c.a.createElement("span",null,Object(O.map)(Ee,function(e){return c.a.createElement(ge,{key:e,checked:v.includes(e),onChange:function(){Y(Object(O.xor)(v,[e]))}},e)}))))},je=(a(1409),w.a.TextArea),he="NOT_STARTED",ye="RUNNING",Ne="COMPLETED",Se="FAILED",ve=function(e){var t=Object(n.useState)({partition:"Incomes",data:""}),a=Object(i.a)(t,2),s=a[0],r=a[1],l=Object(n.useState)({status:he,total:0,processed:0}),u=Object(i.a)(l,2),m=u[0],d=u[1],p=e.goBack,g=s.partition,b=s.data,E=m.status,f=m.total,j=m.processed;return c.a.createElement("div",{className:"data-import-container"},c.a.createElement(q.a,{onBack:function(){return p&&p()},title:"Data Import"}),c.a.createElement(W.a.Group,{onChange:function(e){r(Object(_.a)(Object(_.a)({},s),{},{partition:e.target.value}))},value:g,buttonStyle:"solid",size:"large",className:"partition-selector"},c.a.createElement(W.a.Button,{value:"Incomes"},"Incomes"),c.a.createElement(W.a.Button,{value:"Expenses"},"Expenses")),c.a.createElement("div",{className:"input-message"},"Incomes"===g&&"timestamp \\t type \\t category \\t amount \\t details \\t tag1 tag2...","Expenses"===g&&"timestamp \\t type \\t category \\t amount \\t merchant \\t merchandise \\t tag1 tag2..."),c.a.createElement(je,{autoSize:{minRows:5,maxRows:12},value:s.data,className:"data-input",onChange:function(e){r(Object(_.a)(Object(_.a)({},s),{},{data:e.target.value}))}}),c.a.createElement("div",{className:"buttons"},c.a.createElement(o.a,{type:"primary",style:{width:"100%"},loading:E===ye,size:"large",onClick:function(){var e=Object(O.filter)(b.split("\n"),function(e){return""!==e}),t=!1,a=0,n=Object(O.filter)(Object(O.map)(e,function(e){if(!t){var n=Object(O.map)(e.split("\t"),function(e){return e.trim()}),c=Object(i.a)(n,8),s=c[0],r=c[1],o=c[2],l=c[3],u=c[4],m=c[5],d=c[6],p=c[7],b=u,E=u,f=m,j=m,y=d,N=h;"Expenses"===g&&(j=d,y=p,N=Y);var S=!!y||""===y;if(S||!j&&""!==j)return R.a.error({message:"Import Failed (".concat(S?"more":"less"," fields in the input)!"),description:"It seems there are ".concat(S?"more":"less"," fields in the input. Please select corect partition to import data."),duration:0}),void(t=!0);if(""!==s||""!==r||""!==o||""!==l){var v=parseFloat(l);if(0!==v){if(isNaN(v))return R.a.error({message:"Import Failed (0 or NaN of amount in the input)!",description:"It seems there is NaN of amount in the input(timestamp: ".concat(s,", amount: ").concat(l,"). Please fix that before doing another import."),duration:0}),void(t=!0);if(!N[r]||!N[r].includes(o))return R.a.error({message:"Import Failed (Wrong type/category in the input)!",description:"It seems there is wrong type(".concat(r,")/category(").concat(o,") in the input. Please fix that before doing another import."),duration:0}),void(t=!0);var T=Object(O.filter)(j.split(" "),function(e){return""!==e});return"Incomes"===g?[s,r,o,l,b,T]:[s,r,o,l,E,f,T]}a++}else a++}}),function(e){return!!e});if(t)d({status:Se,total:e.length,processed:0});else{a>0&&R.a.info({message:"Item(s) removed!",description:"There are ".concat(a," item(s) of total(").concat(e.length,") removed from the input due to 0.00 of amount or empty line."),duration:0});var c=[],s={};if(Object(O.each)(n,function(e){s[e[0]]?c.push(e[0]):s[e[0]]=!0}),c.length>0&&(R.a.error({message:"Import Failed (Duplicated Timestamps in the input)!",description:"It seems there are duplicated timestamps in the input: ".concat(c.join(", "),"). Please fix that before doing another import."),duration:0}),t=!0),t)d({status:Se,total:n.length,processed:0});else{var r=n.length;if(0!==r){d({status:ye,total:n.length,processed:0});var o=0;!function e(){var a=o+25>r?r:o+25,c={RequestItems:Object(K.a)({},"BillingV2","Incomes"===g?Object(O.map)(Object(O.slice)(n,o,a),function(e){var t=Object(i.a)(e,6),a=t[0],n=t[1],c=t[2],s=t[3],r=t[4],o=t[5];return{PutRequest:{Item:{partition:{S:"Incomes"},timestamp:{N:a},type:{S:n},category:{S:c},amount:{N:s},details:{S:""===r?" ":r},tags:{SS:[].concat(Object(z.a)(o),[" "])}}}}}):Object(O.map)(Object(O.slice)(n,o,a),function(e){var t=Object(i.a)(e,7),a=t[0],n=t[1],c=t[2],s=t[3],r=t[4],o=t[5],l=t[6];return{PutRequest:{Item:{partition:{S:"Expenses"},timestamp:{N:a},type:{S:n},category:{S:c},amount:{N:s},merchant:{S:""===r?" ":r},merchandise:{S:""===o?" ":o},tags:{SS:[].concat(Object(z.a)(l),[" "])}}}}})),ReturnConsumedCapacity:"TOTAL"};t?d({status:Se,total:n.length,processed:a}):H().batchWriteItem(c,function(t){if(t)console.log(t,t.stack),R.a.error({message:"Import Failed (".concat(o," -> ").concat(a,")!"),description:"".concat(t.message||t),duration:0}),d({status:Se,total:n.length,processed:a});else{if(a===r)return void d({status:Ne,total:n.length,processed:a});d({status:ye,total:n.length,processed:a}),o=a,e()}})}()}else d({status:Ne,total:n.length,processed:0})}}}},"Import Items"),c.a.createElement("div",{className:"status-message"},E===ye&&"Processing: ".concat(j," of ").concat(f,"..."),E===Ne&&"Completed!",E===Se&&"Failed!")))},Ye=(a(1410),function(){return c.a.createElement(g,null,c.a.createElement(M,null))});r.a.render(c.a.createElement(Ye,null),document.getElementById("root"))},243:function(e,t){},251:function(e,t){},492:function(e,t,a){e.exports=a(1411)},497:function(e,t,a){},502:function(e,t,a){},519:function(e,t,a){},520:function(e,t,a){}},[[492,1,2]]]);
<!DOCTYPE html>
<html lang="en-us">
  <head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-129076927-1"></script>
    <script src="/js/ga.js"></script>

    <meta charset="utf-8">
    <link rel="icon" href="/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Some Git Best Practices - SeasonsRoad</title>
    <meta name="description" content="If we use git more, and get more familiar with it, it really helps a lot. Let&#39;s note some best practices down here.">

    
    <link rel="stylesheet" href="/css/main.min.css">

    <link rel="manifest" href="/manifest.json">
    <link rel="canonical" href="https://seasonsroad.com/post/2015/git-best-practices.html">

    <meta name="theme-color" content="#FFAA00">

    <link rel="dns-prefetch" href="https://www.google-analytics.com">
    <link rel="dns-prefetch" href="https://www.googleadservices.com">

    <link rel="alternate" href="https://seasonsroad.com/feed.xml" type="application/rss+xml" title="SeasonsRoad Blog Feed">
    

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="SeasonsRoad">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">

    <link rel="apple-touch-icon" href="/images/logo/opaque-128.png">
    <link rel="apple-touch-icon" href="/images/logo/opaque-152.png" sizes="152x152">
    <link rel="apple-touch-icon" href="/images/logo/opaque-167.png" sizes="167x167">
    <link rel="apple-touch-icon" href="/images/logo/opaque-180.png" sizes="180x180">
    <link rel="apple-touch-icon" href="/images/logo/opaque-256.png" sizes="256x256">
    <link rel="apple-touch-icon" href="/images/logo/opaque-512.png" sizes="512x512">

    <link rel="apple-touch-startup-image" href="/images/splashscreens/iphone6_splash.png" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2)">
    <link rel="apple-touch-startup-image" href="/images/splashscreens/iphoneplus_splash.png" media="(device-width: 621px) and (device-height: 1104px) and (-webkit-device-pixel-ratio: 3)">
    <link rel="apple-touch-startup-image" href="/images/splashscreens/iphonex_splash.png" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3)">
    <link rel="apple-touch-startup-image" href="/images/splashscreens/iphonexr_splash.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2)">
    <link rel="apple-touch-startup-image" href="/images/splashscreens/iphonexsmax_splash.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3)">
    <link rel="apple-touch-startup-image" href="/images/splashscreens/ipad_splash.png" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2)">
    <link rel="apple-touch-startup-image" href="/images/splashscreens/ipadpro1_splash.png" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2)">
    <link rel="apple-touch-startup-image" href="/images/splashscreens/ipadpro2_splash.png" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2)">
    <link rel="apple-touch-startup-image" href="/images/splashscreens/ipadpro3_splash.png" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2)">
</head>

  <body>
    <header id="header">
  <a id="skiplink" href="#main-content">Skip Navigation Links</a>
  <div class="wrapper">
    <div id="site-nav">
      <span id="menu-toggler">
        <span class="top-bar"></span>
        <span class="middle-bar"></span>
        <span class="bottom-bar"></span>
      </span>
      <div id="menu">
        <ul class="menu-list">
          
          <li class="menu-item">
            <a href="/links.html" class="menu-link">
              Links
              
            </a>
            
          </li>
          
          <li class="menu-item">
            <a href="/billing/" class="menu-link">
              Billing
              
            </a>
            
          </li>
          
          <li class="menu-item">
            <a href="/imggps/" class="menu-link">
              ImgGPS
              
            </a>
            
          </li>
          
          <li class="menu-item">
            <a href="/about.html" class="menu-link">
              About
              
            </a>
            
          </li>
          
        </ul>
      </div>
    </div>
    <a class="site-logo" href="/"><img src="/images/logo/SR-oneline.png" alt="SeasonsRoad"></a>
  </div>
</header>
<div id="main-content"></div>

    
    <div class="page-content">
      <div class="wrapper">
        
<div class="post">
  <header class="post-header">
    <h1 class="post-title">Some Git Best Practices</h1>
    <p class="post-meta">Jun 1, 2015 â€¢ Yiming</p>
  </header>
  <article class="post-content">
    <blockquote>
<p><a href="https://github.com/git/git">Git</a> is a distributed revision control system with an emphasis on speed, data integrity, and support for distributed, non-linear workflows. Git was initially designed and developed by Linus Torvalds for Linux kernel development in 2005, and has since become the most widely adopted version control system for software development.</p>
</blockquote>
<h1 id="know-more-do-better">Know more, do better</h1>
<p>If we use git more, and get more familiar with it, it really helps a lot. Let&rsquo;s note some best practices down here.</p>
<h2 id="set-useful-git-alias">Set useful git alias</h2>
<p>Check <a href="/2015/05/SomeGitAlias/">this post</a> to set useful git alias, making your life easier and happier when using git.</p>
<h2 id="about-a-remote-host-crud">About a remote host (CRUD)</h2>
<p>List all your remote hosts. <code>-v</code> shows the url for remote host.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git remote <span style="color:#f92672">[</span>-v<span style="color:#f92672">]</span>
</span></span></code></pre></div><p>Show the detailed information for remote host(such as origin). Add, Remove and Rename a host.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git remote show &lt;host&gt;                  <span style="color:#75715e"># [R]</span>
</span></span><span style="display:flex;"><span>$ git remote add &lt;host&gt; &lt;url&gt;             <span style="color:#75715e"># [C]</span>
</span></span><span style="display:flex;"><span>$ git remote rm &lt;host&gt;                    <span style="color:#75715e"># [D]</span>
</span></span><span style="display:flex;"><span>$ git remote rename &lt;host&gt; &lt;new-host&gt;     <span style="color:#75715e"># [U]</span>
</span></span></code></pre></div><h2 id="fetch-from-remote-host">Fetch from remote host</h2>
<p>Once there&rsquo;re commits from remote host, we can fetch them in <em>all branches</em> from remote host.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git fetch &lt;host&gt;
</span></span></code></pre></div><p>We can also fetch <em>a specific branch</em> from remote host. With <code>git branch</code> you can get all the local branches, and with <code>git branch -r</code> you can get all the remote branches.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git fetch &lt;host&gt; &lt;branch&gt;
</span></span></code></pre></div><p>We can also fetch some branch which has no corresponding local branch created. We do this to create a local branch based this remote branch.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git checkout -b &lt;local-branch&gt; origin/&lt;remote-local&gt;
</span></span></code></pre></div><p>Also, if you don&rsquo;t want to merge a remote branch without creating a local branch for it, do this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git merge origin/master
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Or</span>
</span></span><span style="display:flex;"><span>$ git rebase origin/master
</span></span></code></pre></div><p>This two commands do the same to merge a remote branch(<code>origin/master</code>) into current branch.</p>
<h2 id="pull-from-remote-host">Pull from remote host</h2>
<p>The default <code>git pull</code> command pulls all the remote branches corresponding to local ones. The full command can pull a remote branch and merge it to a local branch.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git pull <span style="color:#f92672">[</span>--rebase<span style="color:#f92672">]</span> &lt;host&gt; &lt;remote-branch&gt;:&lt;local-branch&gt;
</span></span></code></pre></div><p>This command pulls <code>&lt;remote-branch&gt;</code> from <code>&lt;host&gt;</code>, and merges it to <code>&lt;local-branch&gt;</code>. With <code>--rebase</code> option, we can rebase the local commits to top of this branch.</p>
<h2 id="push-to-remote-host">Push to remote host</h2>
<p>We should know that there&rsquo;re 2 push mode: <code>simple</code> &amp; <code>matching</code>. Before git 2.0, we use &lsquo;matching&rsquo; as default which pushes all the matching local branches to remote. Now we use &lsquo;simple&rsquo; as default to push only current branch to remote. But we can config it:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git config --global push.default matching
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Or</span>
</span></span><span style="display:flex;"><span>$ git config --global push.default simple
</span></span></code></pre></div><p>The full comand pushes a local branch to remote branch of a remote host.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git push &lt;host&gt; &lt;local-branch&gt;:&lt;remote-branch&gt;
</span></span></code></pre></div><p>If we don&rsquo;t specify the <code>&lt;local-branch&gt;</code>, we just push an empty branch to remote, just like removing remote branch commits, which means <code>git push &lt;host&gt; :&lt;remote-branch&gt;</code> equals to <code>git push &lt;host&gt; --delete &lt;remote-branch&gt;</code>.</p>
<p>If we don&rsquo;t specify the <code>&lt;remote-branch&gt;</code>, we will push <code>&lt;local-branch&gt;</code> to the matching branch of it.</p>
<p>If we don&rsquo;t specify any branch, we will push all the branches to the matching branches of them on <code>&lt;host&gt;</code>. Just like this command without &ndash;all.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git push <span style="color:#f92672">[</span>--all<span style="color:#f92672">]</span> &lt;host&gt;
</span></span></code></pre></div><p>If we use <code>--all</code>, we could push all the branches. If some of them don&rsquo;t have the matching branches on <code>&lt;host&gt;</code> will create them.</p>
<p>If we want to force push the local changes, usually when we update some commits already pushed, check this <a href="#force-push">best practice</a>.</p>
<h2 id="do-with-your-submodules">Do with your submodules</h2>
<p>Process all your submodules with this command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git submodule <span style="color:#f92672">[</span>...<span style="color:#f92672">]</span>
</span></span></code></pre></div><p>You can do <code>init</code>/<code>deinit</code>, <code>add</code>, <code>status</code>, <code>update</code>, etc.</p>
<p>If you want to run git commands within each submodule, do this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git submodule foreach <span style="color:#f92672">[</span>git command<span style="color:#f92672">]</span>
</span></span></code></pre></div><h1 id="best-practices">Best practices!!</h1>
<h2 id="who-has-touched-the-file">Who has touched the file?</h2>
<p>If the file is a code file, we can use <code>git blame</code> to check the file change.</p>
<p>If the file is a binary file, or we just want to find all the commits related to this file, use this command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git log <span style="color:#f92672">[</span>-p<span style="color:#f92672">]</span> file
</span></span></code></pre></div><p>And, if this file is renamed or even deleted, we should use <code>--follow</code> on <code>git log</code> to continue listing the history of a file beyond renames:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git log <span style="color:#f92672">[</span>-p<span style="color:#f92672">]</span> --follow -- file
</span></span></code></pre></div><p><code>--</code> is used to separate paths from revisions, like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git &lt;command&gt; <span style="color:#f92672">[</span>&lt;revision&gt;...<span style="color:#f92672">]</span> -- <span style="color:#f92672">[</span>&lt;file&gt;...<span style="color:#f92672">]</span>
</span></span></code></pre></div><h2 id="a-namerebaserebase-to-an-old-commit"><a name="rebase"/>Rebase to an old commit</h2>
<p>Rebase to an old commit:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git rebase -i HEAD~n
</span></span></code></pre></div><p>Edit the <code>pick</code> before any commit your want to base to <code>reword</code> or <code>r</code>.</p>
<p>If you want to continue to HEAD, use this command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git rebase --continue
</span></span></code></pre></div><h2 id="amend-commits-locally">Amend commits locally</h2>
<p>If this commit is HEAD commit, use this to amend it:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git commit --amend
</span></span></code></pre></div><p>Then amend your commit message!</p>
<p>If this commit is not HEAD, <a href="#rebase">rebase</a> it and amend.</p>
<h2 id="reset-commits-locally">Reset commits locally</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git reset HEAD~n <span style="color:#f92672">[</span>--hard<span style="color:#f92672">]</span>
</span></span></code></pre></div><p>With the <code>--hard</code> option, you can reset all the commit with all its changes. Or you can save all your changes.</p>
<h2 id="move-one-older-commit-to-head">Move one older commit to HEAD</h2>
<p>This is maybe a little tricky. We have to use a test branch to backup the git stack, then rebase to remove the very change:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git branch test
</span></span><span style="display:flex;"><span>$ git rebase --onto HEAD~n HEAD~<span style="color:#f92672">(</span>n-1<span style="color:#f92672">)</span> HEAD
</span></span></code></pre></div><p>This way comes from the git <a href="http://git-scm.com/docs/git-rebase#_description">help man page</a>.</p>
<blockquote>
<p>A range of commits could also be removed with rebase. If we have the following situation:</p>
<p>E&mdash;F&mdash;G&mdash;H&mdash;I&mdash;J  topicA</p>
<p>then the command</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"></code></pre></div></blockquote>
<p>$ git rebase &ndash;onto topicA~5 topicA~3 topicA</p>
<pre tabindex="0"><code>&gt; would result in the removal of commits F and G:
&gt;
&gt; E&#39;---H&#39;---I&#39;---J&#39;  topicA

After you stash this commit, you can cherry-pick it from the test branch to master branch:

````bash
$ git cherry-pick XXXXXX

$ git branch -D test
</code></pre><p>Get the <code>XXXXXX</code> with <code>git log</code> in test branch.</p>
<h2 id="check-inpush-an-old-commit">Check in(push) an old commit</h2>
<p>Use <a href="#rebase">rebase</a> to go to this very old commit, use <code>git push</code>, you&rsquo;ll get this message:</p>
<pre tabindex="0"><code>fatal: You are not currently on a branch.
To push the history leading to the current (detached HEAD)
state now, use

    git push origin HEAD:&lt;name-of-remote-branch&gt;
</code></pre><p>So you can do this very command to push commits before this base. After that, you go back to continue.</p>
<h2 id="a-nameforce-pushforce-push-to-update-remote-origincritical"><a name="force-push"/>Force push to update remote origin(CRITICAL!)</h2>
<p>This may not be a good practice. But in some critical circumstances, this may be the savior.</p>
<p>Amend the commits you&rsquo;ve all ready pushed, and force to push them to replace the repo.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git push -f
</span></span></code></pre></div>
  </article>
  <div class="post-comments">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "ymlu" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</div>

      </div>
    </div>
    <footer id="footer">
  <div class="wrapper">
    <div class="left">
      
      <span class="item">
        <a href="https://github.com/yiminglu">
          <span class="icon icon--github" aria-hidden="true">
            <svg viewBox="0 0 16 16">
              <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
            </svg>
          </span>

          <span class="username">yiminglu</span>
        </a>
      </span>
      
    </div>

    <div class="right">
      <span class="item">
        &copy; SeasonsRoad
      </span>
    </div>
  </div>

  
  
  <script src="/js/main.min.js"></script>
  
</footer>

  </body>
</html>

"use strict";(self.webpackChunkimg_gps=self.webpackChunkimg_gps||[]).push([[267],{40267:function(n,e,i){i.r(e),i.d(e,{IMGGPSPage:function(){return z}});var t,o,r,l,a,s,d,c,p,u,x=i(1413),h=i(30168),f=i(29439),g=i(47313),m=i(25974),b=i(65964),v=i(49292),w=i(89320),Z=i(16031),j=i(610),k=i(36519),P=i(46417),y=360;function z(){var n=(0,g.useState)([]),e=(0,f.Z)(n,2),i=e[0],z=e[1],S=(0,g.useState)(!1),G=(0,f.Z)(S,2),N=G[0],C=G[1],F=(0,g.useState)(void 0),E=(0,f.Z)(F,2),M=E[0],D=E[1],W=(0,g.useState)(10),O=(0,f.Z)(W,2),R=O[0],T=O[1],B=(0,g.useState)({height:window.innerHeight,width:window.innerWidth}),I=(0,f.Z)(B,2),L=I[0],U=I[1],J=i.length>0;(0,g.useEffect)((function(){var n=(0,Z.debounce)((function(){U({height:window.innerHeight,width:window.innerWidth})}),50);return window.addEventListener("resize",n),function(){window.removeEventListener("resize",n)}})),(0,g.useEffect)((function(){D(void 0),T(10)}),[i]);var H=m.ZP.div(t||(t=(0,h.Z)(["\n    position: absolute;\n    top: 20px;\n    left: 20px;\n    background: #fffb;\n  "]))),_=m.ZP.div(o||(o=(0,h.Z)(["\n    position: absolute;\n    top: 13px;\n    right: 170px;\n    cursor: pointer;\n    background: #fff;\n    padding: 5px;\n    border: 2px dashed #da2;\n    border-radius: 5px;\n    height: 60px;\n    width: 60px;\n    ","\n\n    > img {\n      ","\n    }\n  "])),N?"":"filter: saturate(0%);",N?"filter: brightness(0.9);":""),q=m.ZP.div(r||(r=(0,h.Z)(["\n    position: absolute;\n    top: 13px;\n    right: 90px;\n    background: #fff;\n\n    > label {\n      height: 60px;\n      width: 60px;\n      min-width: 60px;\n      padding: 8px 12px;\n\n      > input {\n        width: 10px;\n      }\n\n      > div {\n        display: none;\n      }\n    }\n  "]))),A=m.ZP.div(l||(l=(0,h.Z)(["\n    width: ","px;\n    height: ","px;\n    transition: width 1s linear;\n    display: inline-block;\n  "])),J?L.width-y:L.width,L.height),K=m.ZP.div(a||(a=(0,h.Z)(["\n    width: ","px;\n    height: ","px;\n    transition: width 1s linear;\n    display: inline-block;\n    overflow-y: scroll;\n  "])),J?y:0,L.height),V=m.ZP.div(s||(s=(0,h.Z)(["\n    width: ","px;\n    border: 1px solid #eee;\n    border-left: 2px solid #ccc;\n  "])),y),X=m.ZP.div(d||(d=(0,h.Z)(["\n    display: inline-block;\n    margin: 0 5px;\n    vertical-align: top;\n    width: calc(100% - 110px);\n    height: 100px;\n    position: relative;\n\n    div.image-name {\n      font-size: 13px;\n      font-weight: 500;\n      margin-top: 4px;\n    }\n\n    div.image-size-type {\n      display: inline-block;\n      width: 100%;\n\n      div.image-size {\n        font-size: 12px;\n        float: left;\n      }\n\n      div.image-type {\n        font-size: 12px;\n        float: right;\n      }\n    }\n\n    div.image-gps-area {\n      position: absolute;\n      left: 0;\n      right: 0;\n      bottom: 4px;\n\n      div.image-gps {\n        font-size: 12px;\n        cursor: pointer;\n        float: left;\n\n        &:hover {\n          text-decoration: underline;\n        }\n      }\n\n      div.gps-goto {\n        font-size: 20px;\n        line-height: 20px;\n        margin-top: -2px;\n        padding: 0 5px 5px;\n        cursor: pointer;\n        float: right;\n\n        &:hover {\n          background-color: #eee;\n        }\n      }\n    }\n  "]))),Q=m.ZP.img(c||(c=(0,h.Z)(["\n    width: 100px;\n    height: 100px;\n    object-fit: contain;\n    border-right: 1px solid #eee;\n    vertical-align: top;\n  "]))),Y=m.ZP.div(p||(p=(0,h.Z)(["\n    width: 20px;\n    height: 35px;\n    display: inline-block;\n    position: relative;\n\n    img.marker-img {\n      width: 60px;\n      height: 60px;\n      object-fit: cover;\n      border: 2px solid #05f;\n      position: absolute;\n      top: -40px;\n      left: -20px;\n    }\n\n    div.marker-arrow {\n      width: 20px;\n      height: 20px;\n      background-color: #05f;\n      border-top: 5px solid #05f;\n      border-left: 5px solid #05f;\n      transform: rotate(225deg);\n      position: absolute;\n      bottom: 5px;\n      left: 0px;\n    }\n\n    &:hover {\n      img.marker-img {\n        border: 2px solid #9bf;\n      }\n\n      div.marker-arrow {\n        background-color: #9bf;\n        border-top: 5px solid #9bf;\n        border-left: 5px solid #9bf;\n      }\n    }\n  "]))),$=m.ZP.div(u||(u=(0,h.Z)(["\n    position: absolute;\n    bottom: 20px;\n    right: 20px;\n    padding: 14px 21px;\n    background-color: #eee;\n    border-radius: 30px;\n    cursor: pointer;\n    filter: drop-shadow(0 0 4px #777);\n\n    &:hover {\n      background-color: #ccc;\n    }\n  "]))),nn=function(){return(0,P.jsx)(H,{children:(0,P.jsx)("img",{src:"/images/logo/SR-oneline.png",alt:"SeasonsRoad",width:"250px"})})},en=function(){return(0,P.jsx)(_,{onClick:function(){return C(!N)},children:(0,P.jsx)("img",{src:"https://webapi.amap.com/theme/v1.3/m2.png",alt:"Toggle Cluster",width:"47px"})})},tn=function(n){var e=n/1024,i=n/1024/1024,t=n/1024/1024/1024;return t>1?t.toFixed(3)+"GB":i>1?i.toFixed(3)+"MB":e.toFixed(3)+"KB"},on=function(n){(0,Z.filter)(n,(function(n){return n.type.startsWith("image")})),Promise.all((0,Z.map)(n,(function(n){return new Promise((function(e,i){j.ZP.thumbnailUrl(n).then((function(t){j.ZP.parse(n).then((function(i){var o=!!i.longitude&&!!i.latitude,r="WGS-84"===i.GPSMapDatum,l=o?r?k.Z.transform([i.longitude,i.latitude],k.Z.WGS84,k.Z.GCJ02):[i.longitude,i.latitude]:[null,null],a=(0,f.Z)(l,2),s=a[0],d=a[1];e({file:n,url:t,exif:(0,x.Z)((0,x.Z)({},i),{},{longitude:s,latitude:d})})})).catch((function(n){return i(n)}))})).catch((function(n){return i(n)}))}))}))).then((function(n){return z(n)}))},rn=function(){return(0,P.jsx)(q,{children:(0,P.jsx)(v.b,{className:"image-drop",handleChange:on,name:"file",types:["JPG","JPEG","PNG","GIF"],multiple:!0})})};return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(b.ql,{children:(0,P.jsx)("title",{children:"IMG GPS"})}),(0,P.jsx)(A,{children:(0,P.jsxs)(w.D5,{amapkey:"47fdb61ac8fd64ab46910152af623c17",version:"1.4.15",zoomEnable:!0,rotateEnable:!1,scrollWheel:!0,touchZoom:!0,viewMode:"3D",useAMapUI:!0,plugins:["Scale","MapType","ToolBar"],zoom:R,center:M,children:[(0,P.jsx)(nn,{}),(0,P.jsx)(en,{}),(0,P.jsx)(rn,{}),J&&(0,P.jsx)(w.sR,{events:{click:function(n,e){console.log(n),console.log(e),console.log("TODO - FullScreen View",e.w.extData)}},markers:(0,Z.map)((0,Z.filter)(i,(function(n){return!!n.exif.longitude&&!!n.exif.latitude})),(function(n){return{position:{longitude:n.exif.longitude,latitude:n.exif.latitude},name:n.file.name,url:n.url}})),useCluster:N,render:function(n){return(0,P.jsxs)(Y,{children:[(0,P.jsx)("div",{className:"marker-arrow"}),(0,P.jsx)("img",{className:"marker-img",src:n.url,alt:n.name})]})}})]})}),(0,P.jsxs)(K,{children:[(0,Z.map)(i,(function(n){var e=n.exif.longitude&&n.exif.latitude;return(0,P.jsxs)(V,{children:[(0,P.jsx)(Q,{src:n.url,alt:n.file.name}),(0,P.jsxs)(X,{children:[(0,P.jsx)("div",{className:"image-name",children:n.file.name}),(0,P.jsxs)("div",{className:"image-size-type",children:[(0,P.jsx)("div",{className:"image-size",children:tn(n.file.size)}),(0,P.jsx)("div",{className:"image-type",children:n.file.type})]}),(0,P.jsxs)("div",{className:"image-gps-area",children:[(0,P.jsx)("div",{className:"image-gps",onClick:function(){console.log("TODO, click to copy:",e?"".concat(n.exif.longitude,",").concat(n.exif.latitude):"null")},children:e?"".concat(n.exif.longitude.toFixed(6),",").concat(n.exif.latitude.toFixed(6)):"null"}),e&&(0,P.jsx)("div",{className:"gps-goto",onClick:function(){D([n.exif.longitude,n.exif.latitude]),T(18)},children:"\u2316"})]})]})]})})),(0,P.jsx)($,{onClick:function(){z([]),(0,Z.each)(i,(function(n){n.url&&URL.revokeObjectURL(n.url)}))},children:"X"})]})]})}}}]);